/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);

// src/main.ts
var main_exports = {};
__export(main_exports, {
  default: () => AdvancedCanvasPlugin
});
module.exports = __toCommonJS(main_exports);
var import_obsidian9 = require("obsidian");

// src/settings.ts
var import_obsidian = require("obsidian");
var NODE_TYPES_ON_DOUBLE_CLICK = {
  "text": "Text",
  "file": "File"
};
var DEFAULT_SETTINGS = {
  nodeTypeOnDoubleClick: Object.keys(NODE_TYPES_ON_DOUBLE_CLICK).first(),
  defaultTextNodeWidth: 260,
  defaultTextNodeHeight: 60,
  defaultFileNodeWidth: 400,
  defaultFileNodeHeight: 400,
  shapesFeatureEnabled: true,
  edgesStylingFeatureEnabled: true,
  edgeStylePathfinderGridResolution: 10,
  edgeStylePathfinderPathLiveUpdate: true,
  edgeStylePathfinderPathRounded: true,
  commandsFeatureEnabled: true,
  zoomToClonedNode: true,
  cloneNodeMargin: 20,
  expandNodeStepSize: 20,
  betterReadonlyEnabled: true,
  disableNodePopup: false,
  disableZoom: false,
  disablePan: false,
  collapsibleGroupsFeatureEnabled: true,
  collapsedGroupPreviewOnDrag: true,
  stickersFeatureEnabled: true,
  presentationFeatureEnabled: true,
  defaultSlideSize: "1200x675",
  wrapInSlidePadding: 20,
  useArrowKeysToChangeSlides: true,
  zoomToSlideWithoutPadding: true,
  slideTransitionAnimationDuration: 0.5,
  slideTransitionAnimationIntensity: 1.25,
  canvasEncapsulationEnabled: true,
  portalsFeatureEnabled: true,
  maintainClosedPortalSize: true,
  showEdgesIntoDisabledPortals: true
};
var _SettingsManager = class _SettingsManager {
  constructor(plugin) {
    this.plugin = plugin;
  }
  async loadSettings() {
    this.settings = Object.assign({}, DEFAULT_SETTINGS, await this.plugin.loadData());
    this.plugin.app.workspace.trigger(_SettingsManager.SETTINGS_CHANGED_EVENT);
  }
  async saveSettings() {
    await this.plugin.saveData(this.settings);
  }
  getSetting(key) {
    return this.settings[key];
  }
  async setSetting(data) {
    this.settings = Object.assign(this.settings, data);
    await this.saveSettings();
    this.plugin.app.workspace.trigger(_SettingsManager.SETTINGS_CHANGED_EVENT);
  }
  addSettingsTab() {
    this.settingsTab = new AdvancedCanvasPluginSettingTab(this.plugin, this);
    this.plugin.addSettingTab(this.settingsTab);
  }
};
_SettingsManager.SETTINGS_CHANGED_EVENT = "advanced-canvas:settings-changed";
var SettingsManager = _SettingsManager;
var AdvancedCanvasPluginSettingTab = class extends import_obsidian.PluginSettingTab {
  constructor(plugin, settingsManager) {
    super(plugin.app, plugin);
    this.settingsManager = settingsManager;
  }
  display() {
    let { containerEl } = this;
    containerEl.empty();
    new import_obsidian.Setting(containerEl).setHeading().setName("General");
    new import_obsidian.Setting(containerEl).setName("Node type on double click").setDesc("The type of node that will be created when double clicking on the canvas.").addDropdown(
      (dropdown) => dropdown.addOptions(NODE_TYPES_ON_DOUBLE_CLICK).setValue(this.settingsManager.getSetting("nodeTypeOnDoubleClick")).onChange(async (value) => await this.settingsManager.setSetting({ nodeTypeOnDoubleClick: value }))
    );
    new import_obsidian.Setting(containerEl).setName("Default text node width").setDesc("The default width of a text node.").addText(
      (text) => text.setValue(this.settingsManager.getSetting("defaultTextNodeWidth").toString()).onChange(async (value) => await this.settingsManager.setSetting({ defaultTextNodeWidth: Math.max(1, parseInt(value)) }))
    );
    new import_obsidian.Setting(containerEl).setName("Default text node height").setDesc("The default height of a text node.").addText(
      (text) => text.setValue(this.settingsManager.getSetting("defaultTextNodeHeight").toString()).onChange(async (value) => await this.settingsManager.setSetting({ defaultTextNodeHeight: Math.max(1, parseInt(value)) }))
    );
    new import_obsidian.Setting(containerEl).setName("Default file node width").setDesc("The default width of a file node.").addText(
      (text) => text.setValue(this.settingsManager.getSetting("defaultFileNodeWidth").toString()).onChange(async (value) => await this.settingsManager.setSetting({ defaultFileNodeWidth: Math.max(1, parseInt(value)) }))
    );
    new import_obsidian.Setting(containerEl).setName("Default file node height").setDesc("The default height of a file node.").addText(
      (text) => text.setValue(this.settingsManager.getSetting("defaultFileNodeHeight").toString()).onChange(async (value) => await this.settingsManager.setSetting({ defaultFileNodeHeight: Math.max(1, parseInt(value)) }))
    );
    this.createFeatureHeading(
      containerEl,
      "Shapes",
      "Shape your nodes for creating e.g. mind maps or flow charts.",
      "shapesFeatureEnabled"
    );
    this.createFeatureHeading(
      containerEl,
      "Edges styling",
      "Style your edges with different path styles.",
      "edgesStylingFeatureEnabled"
    );
    new import_obsidian.Setting(containerEl).setName("A* grid resolution").setDesc("The resolution of the grid when using the A* path style. The lower the value, the more precise the path will be. But it will also take longer to calculate.").addText(
      (text) => text.setValue(this.settingsManager.getSetting("edgeStylePathfinderGridResolution").toString()).onChange(async (value) => await this.settingsManager.setSetting({ edgeStylePathfinderGridResolution: Math.max(5, parseInt(value)) }))
    );
    new import_obsidian.Setting(containerEl).setName("Live update A* path").setDesc("When enabled, the A* path style will be updated live while dragging the edge.").addToggle(
      (toggle) => toggle.setValue(this.settingsManager.getSetting("edgeStylePathfinderPathLiveUpdate")).onChange(async (value) => await this.settingsManager.setSetting({ edgeStylePathfinderPathLiveUpdate: value }))
    );
    new import_obsidian.Setting(containerEl).setName("A* rounded path").setDesc("When enabled, the A* path style will be rounded.").addToggle(
      (toggle) => toggle.setValue(this.settingsManager.getSetting("edgeStylePathfinderPathRounded")).onChange(async (value) => await this.settingsManager.setSetting({ edgeStylePathfinderPathRounded: value }))
    );
    this.createFeatureHeading(
      containerEl,
      "Extended commands",
      "Add more commands to the canvas.",
      "commandsFeatureEnabled"
    );
    new import_obsidian.Setting(containerEl).setName("Zoom to cloned node").setDesc("When enabled, the canvas will zoom to the cloned node.").addToggle(
      (toggle) => toggle.setValue(this.settingsManager.getSetting("zoomToClonedNode")).onChange(async (value) => await this.settingsManager.setSetting({ zoomToClonedNode: value }))
    );
    new import_obsidian.Setting(containerEl).setName("Clone node margin").setDesc("The margin between the cloned node and the source node.").addText(
      (text) => text.setValue(this.settingsManager.getSetting("cloneNodeMargin").toString()).onChange(async (value) => await this.settingsManager.setSetting({ cloneNodeMargin: parseInt(value) }))
    );
    new import_obsidian.Setting(containerEl).setName("Expand node step size").setDesc("The step size for expanding the node.").addText(
      (text) => text.setValue(this.settingsManager.getSetting("expandNodeStepSize").toString()).onChange(async (value) => await this.settingsManager.setSetting({ expandNodeStepSize: parseInt(value) }))
    );
    this.createFeatureHeading(
      containerEl,
      "Better readonly",
      "Improve the readonly mode.",
      "betterReadonlyEnabled"
    );
    this.createFeatureHeading(
      containerEl,
      "Collapsible groups",
      "Group nodes can be collapsed and expanded to keep the canvas organized.",
      "collapsibleGroupsFeatureEnabled"
    );
    new import_obsidian.Setting(containerEl).setName("Collapsed group preview on drag").setDesc("When enabled, a group that is collapsed show its border while dragging a node.").addToggle(
      (toggle) => toggle.setValue(this.settingsManager.getSetting("collapsedGroupPreviewOnDrag")).onChange(async (value) => await this.settingsManager.setSetting({ collapsedGroupPreviewOnDrag: value }))
    );
    this.createFeatureHeading(
      containerEl,
      "Stickers",
      "Convert an image node to a sticker by supporting transparency and removing the border.",
      "stickersFeatureEnabled"
    );
    this.createFeatureHeading(
      containerEl,
      "Presentations",
      "Create a presentation from your canvas.",
      "presentationFeatureEnabled"
    );
    new import_obsidian.Setting(containerEl).setName("Default slide ratio").setDesc("The default ratio of the slide. For example, 16:9 is 1200x675 and 3:2 is 1350x900.").addText(
      (text) => text.setValue(this.settingsManager.getSetting("defaultSlideSize")).onChange(async (value) => await this.settingsManager.setSetting({ defaultSlideSize: value.replace(" ", "") }))
    );
    new import_obsidian.Setting(containerEl).setName("Wrap in slide padding").setDesc("The padding of the slide when wrapping the canvas in a slide.").addText(
      (text) => text.setValue(this.settingsManager.getSetting("wrapInSlidePadding").toString()).onChange(async (value) => await this.settingsManager.setSetting({ wrapInSlidePadding: parseInt(value) }))
    );
    new import_obsidian.Setting(containerEl).setName("Use arrow keys to change slides").setDesc("When enabled, you can use the arrow keys to change slides in presentation mode.").addToggle(
      (toggle) => toggle.setValue(this.settingsManager.getSetting("useArrowKeysToChangeSlides")).onChange(async (value) => await this.settingsManager.setSetting({ useArrowKeysToChangeSlides: value }))
    );
    new import_obsidian.Setting(containerEl).setName("Zoom to slide without padding").setDesc("When enabled, the canvas will zoom to the slide without padding.").addToggle(
      (toggle) => toggle.setValue(this.settingsManager.getSetting("zoomToSlideWithoutPadding")).onChange(async (value) => await this.settingsManager.setSetting({ zoomToSlideWithoutPadding: value }))
    );
    new import_obsidian.Setting(containerEl).setName("Slide transition animation duration").setDesc("The duration of the slide transition animation in seconds. Set to 0 to disable the animation.").addText(
      (text) => text.setValue(this.settingsManager.getSetting("slideTransitionAnimationDuration").toString()).onChange(async (value) => await this.settingsManager.setSetting({ slideTransitionAnimationDuration: parseFloat(value) }))
    );
    new import_obsidian.Setting(containerEl).setName("Slide transition animation intensity").setDesc("The intensity of the slide transition animation. The higher the value, the more the canvas will zoom out before zooming in on the next slide.").addText(
      (text) => text.setValue(this.settingsManager.getSetting("slideTransitionAnimationIntensity").toString()).onChange(async (value) => await this.settingsManager.setSetting({ slideTransitionAnimationIntensity: parseFloat(value) }))
    );
    this.createFeatureHeading(
      containerEl,
      "Canvas encapsulation",
      "Encapsulate a selection of nodes and edges into a new canvas.",
      "canvasEncapsulationEnabled"
    );
    this.createFeatureHeading(
      containerEl,
      "Portals",
      "Create portals to other canvases.",
      "portalsFeatureEnabled"
    );
    new import_obsidian.Setting(containerEl).setName("Maintain closed portal size").setDesc("When enabled, closing a portal will change the size of the portal to the original, closed size.").addToggle(
      (toggle) => toggle.setValue(this.settingsManager.getSetting("maintainClosedPortalSize")).onChange(async (value) => await this.settingsManager.setSetting({ maintainClosedPortalSize: value }))
    );
    new import_obsidian.Setting(containerEl).setName("Show edges into disabled portals").setDesc("When enabled, edges into disabled portals will be shown by an edge to the portal node.").addToggle(
      (toggle) => toggle.setValue(this.settingsManager.getSetting("showEdgesIntoDisabledPortals")).onChange(async (value) => await this.settingsManager.setSetting({ showEdgesIntoDisabledPortals: value }))
    );
  }
  createFeatureHeading(containerEl, label, description, settingsKey) {
    return new import_obsidian.Setting(containerEl).setHeading().setName(label).setDesc(description).addToggle(
      (toggle) => toggle.setTooltip("Requires a reload to take effect.").setValue(this.settingsManager.getSetting(settingsKey)).onChange(async (value) => {
        await this.settingsManager.setSetting({ [settingsKey]: value });
        new import_obsidian.Notice("Reload obsidian to apply the changes.");
      })
    );
  }
};

// src/utils/canvas-helper.ts
var import_obsidian2 = require("obsidian");

// src/utils/bbox-helper.ts
function combineBBoxes(bboxes) {
  let minX = Infinity;
  let minY = Infinity;
  let maxX = -Infinity;
  let maxY = -Infinity;
  for (let bbox of bboxes) {
    minX = Math.min(minX, bbox.minX);
    minY = Math.min(minY, bbox.minY);
    maxX = Math.max(maxX, bbox.maxX);
    maxY = Math.max(maxY, bbox.maxY);
  }
  return { minX, minY, maxX, maxY };
}
function scaleBBox(bbox, scale) {
  let diffX = (scale - 1) * (bbox.maxX - bbox.minX);
  let diffY = (scale - 1) * (bbox.maxY - bbox.minY);
  return {
    minX: bbox.minX - diffX / 2,
    maxX: bbox.maxX + diffX / 2,
    minY: bbox.minY - diffY / 2,
    maxY: bbox.maxY + diffY / 2
  };
}
function insideBBox(position, bbox, canTouchEdge) {
  var _a, _b, _c, _d;
  const providedBBox = {
    minX: (_a = position.minX) != null ? _a : position.x,
    minY: (_b = position.minY) != null ? _b : position.y,
    maxX: (_c = position.maxX) != null ? _c : position.x,
    maxY: (_d = position.maxY) != null ? _d : position.y
  };
  return canTouchEdge ? providedBBox.minX >= bbox.minX && providedBBox.maxX <= bbox.maxX && providedBBox.minY >= bbox.minY && providedBBox.maxY <= bbox.maxY : providedBBox.minX > bbox.minX && providedBBox.maxX < bbox.maxX && providedBBox.minY > bbox.minY && providedBBox.maxY < bbox.maxY;
}
function enlargeBBox(bbox, padding) {
  return {
    minX: bbox.minX - padding,
    minY: bbox.minY - padding,
    maxX: bbox.maxX + padding,
    maxY: bbox.maxY + padding
  };
}
function getCenterOfBBoxSide(bbox, side) {
  switch (side) {
    case "top":
      return { x: (bbox.minX + bbox.maxX) / 2, y: bbox.minY };
    case "right":
      return { x: bbox.maxX, y: (bbox.minY + bbox.maxY) / 2 };
    case "bottom":
      return { x: (bbox.minX + bbox.maxX) / 2, y: bbox.maxY };
    case "left":
      return { x: bbox.minX, y: (bbox.minY + bbox.maxY) / 2 };
  }
}
function bboxFromNodeData(nodeData) {
  return {
    minX: nodeData.x,
    minY: nodeData.y,
    maxX: nodeData.x + nodeData.width,
    maxY: nodeData.y + nodeData.height
  };
}

// src/utils/canvas-helper.ts
function canvasCommand(plugin, check, run) {
  return (checking) => {
    const canvas = plugin.getCurrentCanvas();
    if (checking)
      return canvas !== null && check(canvas);
    if (canvas)
      run(canvas);
    return true;
  };
}
function createQuickSettingsButton(menuOption) {
  const quickSetting = document.createElement("div");
  if (menuOption.id)
    quickSetting.id = menuOption.id;
  quickSetting.classList.add("canvas-control-item");
  (0, import_obsidian2.setIcon)(quickSetting, menuOption.icon);
  (0, import_obsidian2.setTooltip)(quickSetting, menuOption.label, { placement: "left" });
  quickSetting.addEventListener("click", () => {
    var _a;
    return (_a = menuOption.callback) == null ? void 0 : _a.call(menuOption);
  });
  return quickSetting;
}
function addQuickSettingsButton(controlGroup, element) {
  var _a;
  if (element.id)
    (_a = controlGroup.querySelector(`#${element.id}`)) == null ? void 0 : _a.remove();
  controlGroup.appendChild(element);
}
function createCardMenuOption(canvas, menuOption, previewNodeSize, onPlaced) {
  const menuOptionElement = document.createElement("div");
  if (menuOption.id)
    menuOptionElement.id = menuOption.id;
  menuOptionElement.classList.add("canvas-card-menu-button");
  menuOptionElement.classList.add("mod-draggable");
  (0, import_obsidian2.setIcon)(menuOptionElement, menuOption.icon);
  (0, import_obsidian2.setTooltip)(menuOptionElement, menuOption.label, { placement: "top" });
  menuOptionElement.addEventListener("click", (_e) => {
    onPlaced(canvas, getCenterCoordinates(canvas, previewNodeSize()));
  });
  menuOptionElement.addEventListener("pointerdown", (e) => {
    canvas.dragTempNode(e, previewNodeSize(), (pos) => {
      canvas.deselectAll();
      onPlaced(canvas, pos);
    });
  });
  return menuOptionElement;
}
function addCardMenuOption(canvas, element) {
  var _a;
  if (element.id)
    (_a = canvas == null ? void 0 : canvas.cardMenuEl.querySelector(`#${element.id}`)) == null ? void 0 : _a.remove();
  canvas == null ? void 0 : canvas.cardMenuEl.appendChild(element);
}
function createPopupMenuOption(menuOption) {
  const menuOptionElement = document.createElement("button");
  if (menuOption.id)
    menuOptionElement.id = menuOption.id;
  menuOptionElement.classList.add("clickable-icon");
  (0, import_obsidian2.setIcon)(menuOptionElement, menuOption.icon);
  (0, import_obsidian2.setTooltip)(menuOptionElement, menuOption.label, { placement: "top" });
  menuOptionElement.addEventListener("click", () => {
    var _a;
    return (_a = menuOption.callback) == null ? void 0 : _a.call(menuOption);
  });
  return menuOptionElement;
}
function createExpandablePopupMenuOption(menuOption, subMenuOptions) {
  const menuOptionElement = createPopupMenuOption({
    ...menuOption,
    callback: () => {
      var _a, _b, _c;
      const submenuId = `${menuOption.id}-submenu`;
      if (menuOptionElement.classList.contains("is-active")) {
        menuOptionElement.classList.remove("is-active");
        (_b = (_a = menuOptionElement.parentElement) == null ? void 0 : _a.querySelector(`#${submenuId}`)) == null ? void 0 : _b.remove();
        return;
      }
      menuOptionElement.classList.add("is-active");
      const submenu = document.createElement("div");
      submenu.id = submenuId;
      submenu.classList.add("canvas-submenu");
      for (const subMenuOption of subMenuOptions) {
        const subMenuOptionElement = createPopupMenuOption(subMenuOption);
        submenu.appendChild(subMenuOptionElement);
      }
      (_c = menuOptionElement.parentElement) == null ? void 0 : _c.appendChild(submenu);
    }
  });
  return menuOptionElement;
}
function addPopupMenuOption(canvas, element, index = -1) {
  var _a, _b;
  const popupMenuEl = (_a = canvas == null ? void 0 : canvas.menu) == null ? void 0 : _a.menuEl;
  if (!popupMenuEl)
    return;
  if (element.id)
    (_b = popupMenuEl.querySelector(`#${element.id}`)) == null ? void 0 : _b.remove();
  const sisterElement = index >= 0 ? popupMenuEl.children[index] : popupMenuEl.children[popupMenuEl.children.length + index];
  popupMenuEl.insertAfter(element, sisterElement);
}
function getCenterCoordinates(canvas, nodeSize) {
  const viewBounds = canvas.getViewportBBox();
  return {
    x: (viewBounds.minX + viewBounds.maxX) / 2 - nodeSize.width / 2,
    y: (viewBounds.minY + viewBounds.maxY) / 2 - nodeSize.height / 2
  };
}
function getBBox(canvasNodes) {
  let minX = Infinity;
  let minY = Infinity;
  let maxX = -Infinity;
  let maxY = -Infinity;
  for (const node of canvasNodes) {
    const nodeData = node.getData ? node.getData() : node;
    minX = Math.min(minX, nodeData.x);
    minY = Math.min(minY, nodeData.y);
    maxX = Math.max(maxX, nodeData.x + nodeData.width);
    maxY = Math.max(maxY, nodeData.y + nodeData.height);
  }
  return { minX, minY, maxX, maxY };
}
function zoomToBBox(canvas, bbox) {
  const PADDING_CORRECTION_FACTOR = 1 / 1.1;
  const zoomedBBox = scaleBBox(bbox, PADDING_CORRECTION_FACTOR);
  canvas.zoomToBbox(zoomedBBox);
  const scaleFactor = Math.min(
    canvas.canvasRect.width / (bbox.maxX - bbox.minX),
    canvas.canvasRect.height / (bbox.maxY - bbox.minY)
  );
  canvas.tZoom = Math.log2(scaleFactor);
}

// src/core/events.ts
var PLUGIN_EVENT_PREFIX = "advanced-canvas";
var CanvasEvent = {
  CanvasChanged: `${PLUGIN_EVENT_PREFIX}:canvas-changed`,
  ViewportChanged: {
    Before: `${PLUGIN_EVENT_PREFIX}:viewport-changed:before`,
    After: `${PLUGIN_EVENT_PREFIX}:viewport-changed:after`
  },
  NodeMoved: `${PLUGIN_EVENT_PREFIX}:node-moved`,
  DoubleClick: `${PLUGIN_EVENT_PREFIX}:double-click`,
  DraggingStateChanged: `${PLUGIN_EVENT_PREFIX}:dragging-state-changed`,
  NodeAdded: `${PLUGIN_EVENT_PREFIX}:node-added`,
  EdgeAdded: `${PLUGIN_EVENT_PREFIX}:edge-added`,
  NodeRemoved: `${PLUGIN_EVENT_PREFIX}:node-removed`,
  EdgeRemoved: `${PLUGIN_EVENT_PREFIX}:edge-removed`,
  NodeChanged: `${PLUGIN_EVENT_PREFIX}:node-changed`,
  EdgeChanged: `${PLUGIN_EVENT_PREFIX}:edge-changed`,
  NodeBBoxRequested: `${PLUGIN_EVENT_PREFIX}:node-bbox-requested`,
  EdgeCenterRequested: `${PLUGIN_EVENT_PREFIX}:edge-center-requested`,
  ContainingNodesRequested: `${PLUGIN_EVENT_PREFIX}:containing-nodes-requested`,
  SelectionChanged: `${PLUGIN_EVENT_PREFIX}:selection-changed`,
  ZoomToBbox: {
    Before: `${PLUGIN_EVENT_PREFIX}:zoom-to-bbox:before`,
    After: `${PLUGIN_EVENT_PREFIX}:zoom-to-bbox:after`
  },
  PopupMenuCreated: `${PLUGIN_EVENT_PREFIX}:popup-menu-created`,
  NodeInteraction: `${PLUGIN_EVENT_PREFIX}:node-interaction`,
  Undo: `${PLUGIN_EVENT_PREFIX}:undo`,
  Redo: `${PLUGIN_EVENT_PREFIX}:redo`,
  ReadonlyChanged: `${PLUGIN_EVENT_PREFIX}:readonly-changed`,
  DataRequested: `${PLUGIN_EVENT_PREFIX}:data-requested`,
  LoadData: `${PLUGIN_EVENT_PREFIX}:load-data`,
  CanvasSaved: {
    Before: `${PLUGIN_EVENT_PREFIX}:canvas-saved:before`,
    After: `${PLUGIN_EVENT_PREFIX}:canvas-saved:after`
  }
};

// src/canvas-extensions/shapes-canvas-extension.ts
var SHAPES = [
  {
    menuName: "Default",
    icon: "circle-off"
  },
  {
    id: "oval",
    menuName: "Oval",
    icon: "oval"
  },
  {
    id: "centered-rectangle",
    menuName: "Rectangle",
    icon: "rectangle-horizontal"
  },
  {
    id: "diamond",
    menuName: "Diamond",
    icon: "diamond"
  },
  {
    id: "parallelogram",
    menuName: "Parallelogram",
    icon: "parallelogram"
  },
  {
    id: "circle",
    menuName: "Circle",
    icon: "circle"
  },
  {
    id: "predefined-process",
    menuName: "Predefined process",
    icon: "predefined-process"
  },
  {
    id: "document",
    menuName: "Document",
    icon: "document"
  },
  {
    id: "database",
    menuName: "Database",
    icon: "database-shape"
  }
];
var ShapesCanvasExtension = class {
  constructor(plugin) {
    this.plugin = plugin;
    if (!this.plugin.settings.getSetting("shapesFeatureEnabled"))
      return;
    this.plugin.registerEvent(this.plugin.app.workspace.on(
      CanvasEvent.PopupMenuCreated,
      (canvas) => this.onPopupMenuCreated(canvas)
    ));
  }
  onPopupMenuCreated(canvas) {
    if (canvas.readonly || !this.hasValidNodeInSelection(canvas))
      return;
    const nestedMenuOptions = SHAPES.map((shape) => ({
      label: shape.menuName,
      icon: shape.icon,
      callback: () => this.setShapeForSelection(canvas, shape)
    }));
    const menuOption = createExpandablePopupMenuOption({
      id: "node-shape-option",
      label: "Node shape",
      icon: "shapes"
    }, nestedMenuOptions);
    addPopupMenuOption(canvas, menuOption);
  }
  hasValidNodeInSelection(canvas) {
    const selectedNodesData = canvas.getSelectionData().nodes;
    for (const nodeData of selectedNodesData) {
      if (nodeData.type === "text")
        return true;
    }
    return false;
  }
  setShapeForSelection(canvas, shape) {
    const selectedNodesData = canvas.getSelectionData().nodes;
    for (const nodeData of selectedNodesData) {
      if (nodeData.type !== "text")
        continue;
      const node = canvas.nodes.get(nodeData.id);
      if (!node)
        continue;
      node.setData({ ...nodeData, shape: shape.id });
    }
  }
};

// node_modules/monkey-around/mjs/index.js
function around(obj, factories) {
  const removers = Object.keys(factories).map((key) => around1(obj, key, factories[key]));
  return removers.length === 1 ? removers[0] : function() {
    removers.forEach((r) => r());
  };
}
function around1(obj, method, createWrapper) {
  const original = obj[method], hadOwn = obj.hasOwnProperty(method);
  let current = createWrapper(original);
  if (original)
    Object.setPrototypeOf(current, original);
  Object.setPrototypeOf(wrapper, current);
  obj[method] = wrapper;
  return remove;
  function wrapper(...args) {
    if (current === original && obj[method] === wrapper)
      remove();
    return current.apply(this, args);
  }
  function remove() {
    if (obj[method] === wrapper) {
      if (hadOwn)
        obj[method] = original;
      else
        delete obj[method];
    }
    if (current === original)
      return;
    current = original;
    Object.setPrototypeOf(wrapper, original || Function);
  }
}

// src/utils/patch-helper.ts
function patchObjectPrototype(plugin, target, functions) {
  const uninstaller = around(target.constructor.prototype, functions);
  plugin.register(uninstaller);
}
function patchObjectInstance(plugin, target, functions) {
  const uninstaller = around(target, functions);
  plugin.register(uninstaller);
}

// src/core/canvas-patcher.ts
var CanvasPatcher = class {
  constructor(plugin) {
    this.plugin = plugin;
    this.applyPatches();
  }
  async applyPatches() {
    var _a, _b, _c;
    const that = this;
    const canvasView = (_c = (_b = (_a = this.plugin.app.workspace.getLeavesOfType("canvas")) == null ? void 0 : _a.first()) == null ? void 0 : _b.view) != null ? _c : await new Promise((resolve) => {
      const uninstall = around(this.plugin.app.internalPlugins.plugins.canvas.views, {
        canvas: (next) => function(...args) {
          const result = next.call(this, ...args);
          resolve(result);
          uninstall();
          return result;
        }
      });
      this.plugin.register(uninstall);
    });
    patchObjectPrototype(this.plugin, canvasView, {
      getViewData: (_next) => function(..._args) {
        var _a2;
        const canvasData = this.canvas.getData();
        canvasData.metadata = (_a2 = this.canvas.metadata) != null ? _a2 : {};
        return JSON.stringify(canvasData, null, 2);
      },
      setViewData: (next) => function(json, ...args) {
        const result = next.call(this, json, ...args);
        this.canvas.metadata = JSON.parse(json).metadata;
        that.triggerWorkspaceEvent(CanvasEvent.CanvasChanged, this.canvas);
        return result;
      }
    });
    patchObjectPrototype(this.plugin, canvasView.canvas, {
      markViewportChanged: (next) => function(...args) {
        that.triggerWorkspaceEvent(CanvasEvent.ViewportChanged.Before, this);
        const result = next.call(this, ...args);
        that.triggerWorkspaceEvent(CanvasEvent.ViewportChanged.After, this);
        return result;
      },
      markMoved: (next) => function(node) {
        const result = next.call(this, node);
        that.triggerWorkspaceEvent(CanvasEvent.NodeMoved, this, node);
        return result;
      },
      onDoubleClick: (next) => function(event) {
        const preventDefault = { value: false };
        that.triggerWorkspaceEvent(CanvasEvent.DoubleClick, this, event, preventDefault);
        if (!preventDefault.value)
          next.call(this, event);
      },
      setDragging: (next) => function(dragging) {
        const result = next.call(this, dragging);
        that.triggerWorkspaceEvent(CanvasEvent.DraggingStateChanged, this, dragging);
        return result;
      },
      getContainingNodes: (next) => function(bbox) {
        const result = next.call(this, bbox);
        that.triggerWorkspaceEvent(CanvasEvent.ContainingNodesRequested, this, bbox, result);
        return result;
      },
      updateSelection: (next) => function(update) {
        const oldSelection = new Set(this.selection);
        const result = next.call(this, update);
        that.triggerWorkspaceEvent(CanvasEvent.SelectionChanged, this, oldSelection, (update2) => next.call(this, update2));
        return result;
      },
      addNode: (next) => function(node) {
        that.patchNode(node);
        return next.call(this, node);
      },
      addEdge: (next) => function(edge) {
        that.patchEdge(edge);
        return next.call(this, edge);
      },
      removeNode: (next) => function(node) {
        const result = next.call(this, node);
        that.triggerWorkspaceEvent(CanvasEvent.NodeRemoved, this, node);
        return result;
      },
      removeEdge: (next) => function(edge) {
        const result = next.call(this, edge);
        that.triggerWorkspaceEvent(CanvasEvent.EdgeRemoved, this, edge);
        return result;
      },
      zoomToBbox: (next) => function(bbox) {
        that.triggerWorkspaceEvent(CanvasEvent.ZoomToBbox.Before, this, bbox);
        const result = next.call(this, bbox);
        that.triggerWorkspaceEvent(CanvasEvent.ZoomToBbox.After, this, bbox);
        return result;
      },
      setReadonly: (next) => function(readonly) {
        const result = next.call(this, readonly);
        that.triggerWorkspaceEvent(CanvasEvent.ReadonlyChanged, this, readonly);
        return result;
      },
      undo: (next) => function(...args) {
        const result = next.call(this, ...args);
        this.importData(this.getData(), true);
        that.triggerWorkspaceEvent(CanvasEvent.Undo, this);
        return result;
      },
      redo: (next) => function(...args) {
        const result = next.call(this, ...args);
        this.importData(this.getData(), true);
        that.triggerWorkspaceEvent(CanvasEvent.Redo, this);
        return result;
      },
      getData: (next) => function(...args) {
        const result = next.call(this, ...args);
        that.triggerWorkspaceEvent(CanvasEvent.DataRequested, this, result);
        return result;
      },
      importData: (next) => function(data, clearCanvas, silent) {
        const targetFilePath = this.view.file.path;
        const setData = (data2) => {
          if (!this.view.file || this.view.file.path !== targetFilePath)
            return;
          this.importData(data2, true, true);
          that.emitEventsForUnknownDataChanges(this);
        };
        if (!silent)
          that.triggerWorkspaceEvent(CanvasEvent.LoadData, this, data, setData);
        const result = next.call(this, data, clearCanvas);
        that.emitEventsForUnknownDataChanges(this);
        return result;
      },
      requestSave: (next) => function(...args) {
        that.triggerWorkspaceEvent(CanvasEvent.CanvasSaved.Before, this);
        const result = next.call(this, ...args);
        that.triggerWorkspaceEvent(CanvasEvent.CanvasSaved.After, this);
        return result;
      }
    });
    patchObjectPrototype(this.plugin, canvasView.canvas.menu, {
      render: (next) => function(...args) {
        const result = next.call(this, ...args);
        that.triggerWorkspaceEvent(CanvasEvent.PopupMenuCreated, this.canvas);
        next.call(this);
        return result;
      }
    });
    patchObjectPrototype(this.plugin, canvasView.canvas.nodeInteractionLayer, {
      setTarget: (next) => function(node) {
        const result = next.call(this, node);
        that.triggerWorkspaceEvent(CanvasEvent.NodeInteraction, this.canvas, node);
        return result;
      }
    });
    this.plugin.app.workspace.iterateAllLeaves((leaf) => {
      if (leaf.view.getViewType() !== "canvas")
        return;
      const canvasView2 = leaf.view;
      canvasView2.leaf.rebuildView();
    });
  }
  patchNode(node) {
    const that = this;
    patchObjectInstance(this.plugin, node, {
      setData: (next) => function(...args) {
        const result = next.call(this, ...args);
        if (node.initialized && !node.isDirty) {
          node.isDirty = true;
          that.triggerWorkspaceEvent(CanvasEvent.NodeChanged, this.canvas, node);
          delete node.isDirty;
        }
        this.canvas.data = this.canvas.getData();
        this.canvas.view.requestSave();
        return result;
      },
      getBBox: (next) => function(...args) {
        const result = next.call(this, ...args);
        that.triggerWorkspaceEvent(CanvasEvent.NodeBBoxRequested, this.canvas, node, result);
        return result;
      }
    });
    this.runAfterInitialized(node, () => {
      this.triggerWorkspaceEvent(CanvasEvent.NodeAdded, node.canvas, node);
      this.triggerWorkspaceEvent(CanvasEvent.NodeChanged, node.canvas, node);
    });
  }
  patchEdge(edge) {
    const that = this;
    patchObjectInstance(this.plugin, edge, {
      setData: (next) => function(...args) {
        const result = next.call(this, ...args);
        if (edge.initialized && !edge.isDirty) {
          edge.isDirty = true;
          that.triggerWorkspaceEvent(CanvasEvent.EdgeChanged, this.canvas, edge);
          delete edge.isDirty;
        }
        this.canvas.data = this.canvas.getData();
        this.canvas.view.requestSave();
        return result;
      },
      render: (next) => function(...args) {
        const result = next.call(this, ...args);
        that.triggerWorkspaceEvent(CanvasEvent.EdgeChanged, this.canvas, edge);
        return result;
      },
      getCenter: (next) => function(...args) {
        const result = next.call(this, ...args);
        that.triggerWorkspaceEvent(CanvasEvent.EdgeCenterRequested, this.canvas, edge, result);
        return result;
      }
    });
    this.runAfterInitialized(edge, () => {
      this.triggerWorkspaceEvent(CanvasEvent.EdgeAdded, edge.canvas, edge);
    });
  }
  runAfterInitialized(canvasElement, onReady) {
    if (canvasElement.initialized) {
      onReady();
      return;
    }
    const that = this;
    const uninstall = around(canvasElement, {
      initialize: (next) => function(...args) {
        const result = next.call(this, ...args);
        onReady();
        uninstall();
        return result;
      }
    });
    that.plugin.register(uninstall);
  }
  emitEventsForUnknownDataChanges(canvas) {
    canvas.nodes.forEach((node) => this.runAfterInitialized(node, () => {
      this.triggerWorkspaceEvent(CanvasEvent.NodeChanged, node.canvas, node);
    }));
    canvas.edges.forEach((edge) => this.runAfterInitialized(edge, () => {
      this.triggerWorkspaceEvent(CanvasEvent.EdgeChanged, edge.canvas, edge);
    }));
  }
  triggerWorkspaceEvent(event, ...args) {
    this.plugin.app.workspace.trigger(event, ...args);
  }
};

// src/canvas-extensions/group-canvas-extension.ts
var GROUP_NODE_SIZE = { width: 300, height: 300 };
var GroupCanvasExtension = class {
  constructor(plugin) {
    this.plugin = plugin;
    this.plugin.registerEvent(this.plugin.app.workspace.on(
      CanvasEvent.CanvasChanged,
      (canvas) => {
        addCardMenuOption(
          canvas,
          createCardMenuOption(
            canvas,
            {
              id: "create-group",
              label: "Drag to add group",
              icon: "group"
            },
            () => GROUP_NODE_SIZE,
            (canvas2, pos) => {
              canvas2.createGroupNode({
                pos,
                size: GROUP_NODE_SIZE
              });
            }
          )
        );
      }
    ));
  }
};

// src/canvas-extensions/presentation-canvas-extension.ts
var import_obsidian3 = require("obsidian");
var START_SLIDE_NAME = "Start Slide";
var DEFAULT_SLIDE_NAME = "New Slide";
var PresentationCanvasExtension = class {
  constructor(plugin) {
    this.savedViewport = null;
    this.isPresentationMode = false;
    this.visitedNodes = [];
    this.plugin = plugin;
    if (!this.plugin.settings.getSetting("presentationFeatureEnabled"))
      return;
    this.plugin.registerEvent(this.plugin.app.workspace.on(
      "canvas:selection-menu",
      (menu, canvas) => {
        menu.addItem(
          (item) => item.setTitle("Wrap in slide").setIcon("gallery-vertical").onClick(() => this.addSlide(
            canvas,
            void 0,
            enlargeBBox(combineBBoxes(
              [...canvas.selection.values()].map((element) => element.getBBox())
            ), this.plugin.settings.getSetting("wrapInSlidePadding"))
          ))
        );
      }
    ));
    this.plugin.addCommand({
      id: "create-new-slide",
      name: "Create new slide",
      checkCallback: canvasCommand(
        this.plugin,
        (canvas) => !canvas.readonly && !this.isPresentationMode,
        (canvas) => this.addSlide(canvas)
      )
    });
    this.plugin.addCommand({
      id: "start-presentation",
      name: "Start presentation",
      checkCallback: canvasCommand(
        this.plugin,
        (_canvas) => !this.isPresentationMode,
        (canvas) => this.startPresentation(canvas)
      )
    });
    this.plugin.addCommand({
      id: "previous-node",
      name: "Previous node",
      checkCallback: canvasCommand(
        this.plugin,
        (_canvas) => this.isPresentationMode,
        (canvas) => this.previousNode(canvas)
      )
    });
    this.plugin.addCommand({
      id: "next-node",
      name: "Next node",
      checkCallback: canvasCommand(
        this.plugin,
        (_canvas) => this.isPresentationMode,
        (canvas) => this.nextNode(canvas)
      )
    });
    this.plugin.registerEvent(this.plugin.app.workspace.on(
      CanvasEvent.CanvasChanged,
      (canvas) => this.onCanvasChanged(canvas)
    ));
    this.plugin.registerEvent(this.plugin.app.workspace.on(
      CanvasEvent.PopupMenuCreated,
      (canvas) => this.onPopupMenuCreated(canvas)
    ));
    this.plugin.registerEvent(this.plugin.app.workspace.on(
      CanvasEvent.NodeMoved,
      (canvas, node) => this.onNodeMoved(canvas, node)
    ));
  }
  onCanvasChanged(canvas) {
    addCardMenuOption(
      canvas,
      createCardMenuOption(
        canvas,
        {
          id: "new-slide",
          label: "Drag to add slide",
          icon: "gallery-vertical"
        },
        () => this.getDefaultSlideSize(),
        (canvas2, pos) => this.addSlide(canvas2, pos)
      )
    );
  }
  onPopupMenuCreated(canvas) {
    const selectedNodesData = canvas.getSelectionData().nodes;
    if (canvas.readonly || selectedNodesData.length !== 1 || canvas.selection.size > 1)
      return;
    const selectedNode = canvas.nodes.get(selectedNodesData[0].id);
    if (!selectedNode)
      return;
    addPopupMenuOption(
      canvas,
      createPopupMenuOption({
        id: "start-node",
        label: "Set as start slide",
        icon: "play",
        callback: () => this.setStartNode(canvas, selectedNode)
      })
    );
  }
  onNodeMoved(_canvas, node) {
    const nodeData = node.getData();
    if (!nodeData.sideRatio)
      return;
    const nodeBBox = node.getBBox();
    const nodeSize = {
      width: nodeBBox.maxX - nodeBBox.minX,
      height: nodeBBox.maxY - nodeBBox.minY
    };
    const nodeAspectRatio = nodeSize.width / nodeSize.height;
    if (nodeAspectRatio < nodeData.sideRatio)
      nodeSize.width = nodeSize.height * nodeData.sideRatio;
    else
      nodeSize.height = nodeSize.width / nodeData.sideRatio;
    node.setData({
      ...nodeData,
      width: nodeSize.width,
      height: nodeSize.height
    });
  }
  getStartNode(canvas) {
    for (const [_, node] of canvas.nodes) {
      if (node.getData().isStartNode)
        return node;
    }
    return void 0;
  }
  setStartNode(canvas, node) {
    if (!node)
      return;
    const startNode = this.getStartNode(canvas);
    if (startNode)
      startNode.setData({ ...startNode.getData(), isStartNode: false });
    if (node !== startNode)
      node.setData({ ...node.getData(), isStartNode: true });
  }
  getDefaultSlideSize() {
    const slideSizeString = this.plugin.settings.getSetting("defaultSlideSize");
    const slideSizeArray = slideSizeString.split("x").map((value) => parseInt(value));
    return { width: slideSizeArray[0], height: slideSizeArray[1] };
  }
  getSlideAspectRatio() {
    const slideSize = this.getDefaultSlideSize();
    return slideSize.width / slideSize.height;
  }
  addSlide(canvas, pos, bbox) {
    const isStartNode = this.getStartNode(canvas) == null;
    const slideSize = this.getDefaultSlideSize();
    const slideAspectRatio = this.getSlideAspectRatio();
    if (bbox) {
      const bboxWidth = bbox.maxX - bbox.minX;
      const bboxHeight = bbox.maxY - bbox.minY;
      if (bboxWidth / bboxHeight > slideAspectRatio) {
        slideSize.width = bboxWidth;
        slideSize.height = bboxWidth / slideAspectRatio;
      } else {
        slideSize.height = bboxHeight;
        slideSize.width = bboxHeight * slideAspectRatio;
      }
      pos = {
        x: bbox.minX,
        y: bbox.minY
      };
    }
    if (!pos)
      pos = getCenterCoordinates(canvas, this.getDefaultSlideSize());
    const groupNode = canvas.createGroupNode({
      pos,
      size: slideSize,
      label: isStartNode ? START_SLIDE_NAME : DEFAULT_SLIDE_NAME,
      focus: false
    });
    groupNode.setData({
      ...groupNode.getData(),
      sideRatio: slideAspectRatio,
      isStartNode: isStartNode ? true : void 0
    });
  }
  async animateNodeTransition(canvas, fromNode, toNode) {
    const useCustomZoomFunction = this.plugin.settings.getSetting("zoomToSlideWithoutPadding");
    const animationDurationMs = this.plugin.settings.getSetting("slideTransitionAnimationDuration") * 1e3;
    if (animationDurationMs > 0 && fromNode) {
      const animationIntensity = this.plugin.settings.getSetting("slideTransitionAnimationIntensity");
      const currentNodeBBoxEnlarged = scaleBBox(fromNode.getBBox(), animationIntensity);
      if (useCustomZoomFunction)
        zoomToBBox(canvas, currentNodeBBoxEnlarged);
      else
        canvas.zoomToBbox(currentNodeBBoxEnlarged);
      await sleep(animationDurationMs / 2);
      const nextNodeBBoxEnlarged = scaleBBox(toNode.getBBox(), animationIntensity);
      if (useCustomZoomFunction)
        zoomToBBox(canvas, nextNodeBBoxEnlarged);
      else
        canvas.zoomToBbox(nextNodeBBoxEnlarged);
      await sleep(animationDurationMs / 2);
    }
    let nodeBBox = toNode.getBBox();
    if (useCustomZoomFunction)
      zoomToBBox(canvas, nodeBBox);
    else
      canvas.zoomToBbox(nodeBBox);
  }
  async startPresentation(canvas) {
    const startNode = this.getStartNode(canvas);
    if (!startNode) {
      new import_obsidian3.Notice("No start node found. Please mark a node as a start node trough the popup menu.");
      return;
    }
    this.visitedNodes = [];
    this.savedViewport = {
      x: canvas.tx,
      y: canvas.ty,
      zoom: canvas.tZoom
    };
    canvas.wrapperEl.focus();
    canvas.wrapperEl.requestFullscreen();
    canvas.wrapperEl.classList.add("presentation-mode");
    canvas.setReadonly(true);
    if (this.plugin.settings.getSetting("useArrowKeysToChangeSlides")) {
      canvas.wrapperEl.onkeydown = (e) => {
        if (e.key === "ArrowRight")
          this.nextNode(canvas);
        else if (e.key === "ArrowLeft")
          this.previousNode(canvas);
      };
    }
    const fullscreenModalObserver = new MutationObserver((mutationRecords) => {
      mutationRecords.forEach((mutationRecord) => {
        mutationRecord.addedNodes.forEach((node) => {
          var _a;
          document.body.removeChild(node);
          (_a = document.fullscreenElement) == null ? void 0 : _a.appendChild(node);
        });
      });
      const inputField = document.querySelector(".prompt-input");
      if (inputField)
        inputField.focus();
    });
    fullscreenModalObserver.observe(document.body, { childList: true });
    canvas.wrapperEl.onfullscreenchange = (_e) => {
      if (document.fullscreenElement)
        return;
      fullscreenModalObserver.disconnect();
      this.endPresentation(canvas);
    };
    this.isPresentationMode = true;
    await sleep(500);
    this.visitedNodes.push(startNode);
    this.animateNodeTransition(canvas, void 0, startNode);
  }
  endPresentation(canvas) {
    canvas.wrapperEl.onkeydown = null;
    canvas.wrapperEl.onfullscreenchange = null;
    canvas.setReadonly(false);
    canvas.wrapperEl.classList.remove("presentation-mode");
    if (document.fullscreenElement)
      document.exitFullscreen();
    canvas.setViewport(this.savedViewport.x, this.savedViewport.y, this.savedViewport.zoom);
    this.isPresentationMode = false;
  }
  nextNode(canvas) {
    var _a;
    const fromNode = this.visitedNodes.last();
    if (!fromNode)
      return;
    const outgoingEdges = canvas.getEdgesForNode(fromNode).filter((edge) => edge.from.node === fromNode);
    let toNode = (_a = outgoingEdges.first()) == null ? void 0 : _a.to.node;
    if (outgoingEdges.length > 1) {
      const sortedEdges = outgoingEdges.sort((a, b) => {
        if (!a.label)
          return 1;
        if (!b.label)
          return -1;
        return a.label.localeCompare(b.label);
      });
      const traversedEdgesCount = this.visitedNodes.filter((visitedNode) => visitedNode == fromNode).length - 1;
      const nextEdge = sortedEdges[traversedEdgesCount];
      toNode = nextEdge.to.node;
    }
    if (toNode) {
      this.visitedNodes.push(toNode);
      this.animateNodeTransition(canvas, fromNode, toNode);
    } else {
      this.animateNodeTransition(canvas, fromNode, fromNode);
    }
  }
  previousNode(canvas) {
    const fromNode = this.visitedNodes.pop();
    if (!fromNode)
      return;
    let toNode = this.visitedNodes.last();
    if (!toNode) {
      toNode = fromNode;
      this.visitedNodes.push(fromNode);
    }
    this.animateNodeTransition(canvas, fromNode, toNode);
  }
};

// src/canvas-extensions/node-data-tagger-canvas-extension.ts
function getExposedNodeData(settings) {
  const exposedData = [];
  if (settings.getSetting("stickersFeatureEnabled"))
    exposedData.push("isSticker");
  if (settings.getSetting("shapesFeatureEnabled"))
    exposedData.push("shape");
  if (settings.getSetting("collapsibleGroupsFeatureEnabled"))
    exposedData.push("isCollapsed");
  if (settings.getSetting("presentationFeatureEnabled"))
    exposedData.push("isStartNode");
  if (settings.getSetting("portalsFeatureEnabled"))
    exposedData.push("portalToFile", "portalId");
  return exposedData;
}
var NodeDataTaggerCanvasExtension = class {
  constructor(plugin) {
    this.plugin = plugin;
    this.plugin.registerEvent(this.plugin.app.workspace.on(
      CanvasEvent.NodeChanged,
      (_canvas, node) => {
        const nodeData = node == null ? void 0 : node.getData();
        if (!nodeData)
          return;
        for (const dataKey of getExposedNodeData(this.plugin.settings)) {
          const dataValue = nodeData[dataKey];
          if (!dataValue)
            delete node.nodeEl.dataset[dataKey];
          else
            node.nodeEl.dataset[dataKey] = dataValue;
        }
      }
    ));
  }
};

// src/canvas-extensions/interaction-tagger-canvas-extension.ts
var TARGET_NODE_DATASET_PREFIX = "target";
var InteractionTaggerCanvasExtension = class {
  constructor(plugin) {
    this.plugin = plugin;
    this.plugin.registerEvent(this.plugin.app.workspace.on(
      CanvasEvent.NodeInteraction,
      (canvas, node) => {
        const interactionEl = canvas.nodeInteractionLayer.interactionEl;
        if (!interactionEl)
          return;
        for (const dataKey of getExposedNodeData(this.plugin.settings)) {
          const datasetKey = TARGET_NODE_DATASET_PREFIX + dataKey.toString().charAt(0).toUpperCase() + dataKey.toString().slice(1);
          const dataValue = node == null ? void 0 : node.getData()[dataKey];
          if (!dataValue)
            delete interactionEl.dataset[datasetKey];
          else
            interactionEl.dataset[datasetKey] = dataValue;
        }
      }
    ));
  }
};

// src/canvas-extensions/readonly-canvas-extension.ts
var ReadonlyCanvasExtension = class {
  constructor(plugin) {
    this.plugin = plugin;
    const that = this;
    if (!this.plugin.settings.getSetting("betterReadonlyEnabled"))
      return;
    this.plugin.registerEvent(this.plugin.app.workspace.on(
      CanvasEvent.PopupMenuCreated,
      (canvas, _node) => this.updatePopupMenu(canvas)
    ));
    let movingToBBox = false;
    this.plugin.registerEvent(this.plugin.app.workspace.on(
      CanvasEvent.ViewportChanged.Before,
      (canvas) => {
        var _a, _b, _c, _d, _e, _f;
        if (movingToBBox) {
          movingToBBox = false;
          that.updateLockedZoom(canvas);
          that.updateLockedPan(canvas);
          return;
        }
        if (!canvas.readonly)
          return;
        if (that.plugin.settings.getSetting("disableZoom")) {
          canvas.zoom = (_a = canvas.lockedZoom) != null ? _a : canvas.zoom;
          canvas.tZoom = (_b = canvas.lockedZoom) != null ? _b : canvas.tZoom;
        }
        if (that.plugin.settings.getSetting("disablePan")) {
          canvas.x = (_c = canvas.lockedX) != null ? _c : canvas.x;
          canvas.tx = (_d = canvas.lockedX) != null ? _d : canvas.tx;
          canvas.y = (_e = canvas.lockedY) != null ? _e : canvas.y;
          canvas.ty = (_f = canvas.lockedY) != null ? _f : canvas.ty;
        }
      }
    ));
    this.plugin.registerEvent(this.plugin.app.workspace.on(
      CanvasEvent.ZoomToBbox.Before,
      () => movingToBBox = true
    ));
    this.plugin.registerEvent(this.plugin.app.workspace.on(
      CanvasEvent.ReadonlyChanged,
      (canvas, _readonly) => {
        this.updatePopupMenu(canvas);
        this.updateLockedZoom(canvas);
        this.updateLockedPan(canvas);
      }
    ));
    this.plugin.registerEvent(this.plugin.app.workspace.on(
      CanvasEvent.CanvasChanged,
      (canvas) => this.addQuickSettings(canvas)
    ));
  }
  addQuickSettings(canvas) {
    var _a;
    const settingsContainer = (_a = canvas.quickSettingsButton) == null ? void 0 : _a.parentElement;
    if (!settingsContainer)
      return;
    addQuickSettingsButton(
      settingsContainer,
      this.createToggle({
        id: "disable-node-popup",
        label: "Disable node popup",
        icon: "arrow-up-right-from-circle",
        callback: () => this.updatePopupMenu(canvas)
      }, "disableNodePopup")
    );
    addQuickSettingsButton(
      settingsContainer,
      this.createToggle({
        id: "disable-zoom",
        label: "Disable zoom",
        icon: "zoom-in",
        callback: () => this.updateLockedZoom(canvas)
      }, "disableZoom")
    );
    addQuickSettingsButton(
      settingsContainer,
      this.createToggle({
        id: "disable-pan",
        label: "Disable pan",
        icon: "move",
        callback: () => this.updateLockedPan(canvas)
      }, "disablePan")
    );
  }
  createToggle(menuOption, settingKey) {
    const toggle = createQuickSettingsButton({
      ...menuOption,
      callback: () => (async () => {
        var _a;
        const newValue = !this.plugin.settings.getSetting(settingKey);
        await this.plugin.settings.setSetting({ [settingKey]: newValue });
        toggle.dataset.toggled = this.plugin.settings.getSetting(settingKey).toString();
        (_a = menuOption.callback) == null ? void 0 : _a.call(this);
      })()
    });
    toggle.classList.add("show-while-readonly");
    toggle.dataset.toggled = this.plugin.settings.getSetting(settingKey).toString();
    return toggle;
  }
  updatePopupMenu(canvas) {
    const hidden = canvas.readonly && this.plugin.settings.getSetting("disableNodePopup");
    canvas.menu.menuEl.style.visibility = hidden ? "hidden" : "visible";
  }
  updateLockedZoom(canvas) {
    canvas.lockedZoom = canvas.tZoom;
  }
  updateLockedPan(canvas) {
    canvas.lockedX = canvas.tx;
    canvas.lockedY = canvas.ty;
  }
};

// src/utils/modal-helper.ts
var import_obsidian4 = require("obsidian");

// src/utils/path-helper.ts
function extension(path) {
  return path.includes(".") ? path.split(".").pop() : void 0;
}

// src/utils/modal-helper.ts
var FileNameModal = class extends import_obsidian4.SuggestModal {
  constructor(app, parentPath, fileExtension) {
    super(app);
    this.parentPath = parentPath;
    this.fileExtension = fileExtension;
  }
  getSuggestions(query) {
    const queryWithoutExtension = query.replace(new RegExp(`\\.${this.fileExtension}$`), "");
    if (queryWithoutExtension === "")
      return [];
    const queryWithExtension = queryWithoutExtension + "." + this.fileExtension;
    const suggestions = [`${this.parentPath}/${queryWithExtension}`, queryWithExtension].filter((s) => this.app.vault.getAbstractFileByPath(s) === null);
    return suggestions;
  }
  renderSuggestion(text, el) {
    el.setText(text);
  }
  onChooseSuggestion(_text, _evt) {
  }
  awaitInput() {
    return new Promise((resolve, _reject) => {
      this.onChooseSuggestion = (text) => {
        resolve(text);
      };
      this.open();
    });
  }
};
var FileSelectModal = class extends import_obsidian4.SuggestModal {
  constructor(app, extensionsRegex, suggestNewFile = false) {
    super(app);
    this.files = this.app.vault.getFiles().map((file) => file.path).filter((path) => {
      var _a;
      return (_a = extension(path)) == null ? void 0 : _a.match(extensionsRegex != null ? extensionsRegex : /.*/);
    });
    this.suggestNewFile = suggestNewFile;
    this.setPlaceholder("Type to search...");
    this.setInstructions([{
      command: "\u2191\u2193",
      purpose: "to navigate"
    }, {
      command: "\u21B5",
      purpose: "to open"
    }, {
      command: "shift \u21B5",
      purpose: "to create"
    }, {
      command: "esc",
      purpose: "to dismiss"
    }]);
    this.scope.register(["Shift"], "Enter", (e) => {
      this.onChooseSuggestion(this.inputEl.value, e);
      this.close();
    });
  }
  getSuggestions(query) {
    const suggestions = this.files.filter((path) => path.toLowerCase().includes(query.toLowerCase()));
    if (suggestions.length === 0 && this.suggestNewFile)
      suggestions.push(query);
    return suggestions;
  }
  renderSuggestion(path, el) {
    const simplifiedPath = path.replace(/\.md$/, "");
    el.setText(simplifiedPath);
  }
  onChooseSuggestion(_path, _evt) {
  }
  awaitInput() {
    return new Promise((resolve, _reject) => {
      this.onChooseSuggestion = (path, _evt) => {
        const file = this.app.vault.getAbstractFileByPath(path);
        if (file instanceof import_obsidian4.TFile) {
          resolve(file);
          return;
        }
        if (!this.suggestNewFile)
          return;
        if (extension(path) === void 0)
          path += ".md";
        const newFile = this.app.vault.create(path, "");
        resolve(newFile);
      };
      this.open();
    });
  }
};

// src/canvas-extensions/encapsulate-canvas-extension.ts
var ENCAPSULATED_FILE_NODE_SIZE = { width: 300, height: 300 };
var EncapsulateCanvasExtension = class {
  constructor(plugin) {
    this.plugin = plugin;
    if (!this.plugin.settings.getSetting("canvasEncapsulationEnabled"))
      return;
    this.plugin.addCommand({
      id: "encapsulate-selection",
      name: "Encapsulate selection",
      checkCallback: canvasCommand(
        this.plugin,
        (canvas) => !canvas.readonly && canvas.selection.size > 0,
        (canvas) => this.encapsulateSelection(canvas)
      )
    });
    this.plugin.registerEvent(this.plugin.app.workspace.on(
      "canvas:selection-menu",
      (menu, canvas) => {
        menu.addItem(
          (item) => item.setTitle("Encapsulate").setIcon("file-plus").onClick(() => this.encapsulateSelection(canvas))
        );
      }
    ));
  }
  async encapsulateSelection(canvas) {
    var _a;
    const selection = canvas.getSelectionData();
    const sourceFileFolder = (_a = canvas.view.file.parent) == null ? void 0 : _a.path;
    if (!sourceFileFolder)
      return;
    const targetFilePath = await new FileNameModal(
      this.plugin.app,
      sourceFileFolder,
      "canvas"
    ).awaitInput();
    const newFileData = { nodes: selection.nodes, edges: selection.edges };
    const file = await this.plugin.app.vault.create(targetFilePath, JSON.stringify(newFileData, null, 2));
    for (const nodeData of selection.nodes) {
      const node = canvas.nodes.get(nodeData.id);
      if (node)
        canvas.removeNode(node);
    }
    canvas.createFileNode({
      pos: {
        x: selection.center.x - ENCAPSULATED_FILE_NODE_SIZE.width / 2,
        y: selection.center.y - ENCAPSULATED_FILE_NODE_SIZE.height / 2
      },
      size: ENCAPSULATED_FILE_NODE_SIZE,
      file
    });
  }
};

// src/canvas-extensions/commands-canvas-extension.ts
var DIRECTIONS = ["up", "down", "left", "right"];
var CommandsCanvasExtension = class {
  constructor(plugin) {
    this.plugin = plugin;
    if (!this.plugin.settings.getSetting("commandsFeatureEnabled"))
      return;
    this.plugin.addCommand({
      id: "create-text-node",
      name: "Create text node",
      checkCallback: canvasCommand(
        this.plugin,
        (canvas) => !canvas.readonly,
        (canvas) => this.createTextNode(canvas)
      )
    });
    this.plugin.addCommand({
      id: "create-file-node",
      name: "Create file node",
      checkCallback: canvasCommand(
        this.plugin,
        (canvas) => !canvas.readonly,
        (canvas) => this.createFileNode(canvas)
      )
    });
    this.plugin.addCommand({
      id: "select-all-edges",
      name: "Select all edges",
      checkCallback: canvasCommand(
        this.plugin,
        (_canvas) => true,
        (canvas) => canvas.updateSelection(
          () => canvas.selection = new Set(canvas.edges.values())
        )
      )
    });
    this.plugin.addCommand({
      id: "zoom-to-selection",
      name: "Zoom to selection",
      checkCallback: canvasCommand(
        this.plugin,
        (canvas) => canvas.selection.size > 0,
        (canvas) => canvas.zoomToSelection()
      )
    });
    for (const direction of DIRECTIONS) {
      this.plugin.addCommand({
        id: `clone-node-${direction}`,
        name: `Clone node ${direction}`,
        checkCallback: canvasCommand(
          this.plugin,
          (canvas) => {
            var _a;
            return !canvas.readonly && canvas.selection.size === 1 && ((_a = canvas.selection.values().next().value) == null ? void 0 : _a.getData().type) === "text";
          },
          (canvas) => this.cloneNode(canvas, direction)
        )
      });
      this.plugin.addCommand({
        id: `expand-node-${direction}`,
        name: `Expand node ${direction}`,
        checkCallback: canvasCommand(
          this.plugin,
          (canvas) => !canvas.readonly && canvas.selection.size === 1,
          (canvas) => this.expandNode(canvas, direction)
        )
      });
    }
  }
  createTextNode(canvas) {
    const size = canvas.config.defaultTextNodeDimensions;
    const pos = getCenterCoordinates(canvas, size);
    canvas.createTextNode({ pos, size });
  }
  async createFileNode(canvas) {
    const size = canvas.config.defaultFileNodeDimensions;
    const pos = getCenterCoordinates(canvas, size);
    const file = await new FileSelectModal(this.plugin.app, void 0, true).awaitInput();
    canvas.createFileNode({ pos, size, file });
  }
  cloneNode(canvas, cloneDirection) {
    const sourceNode = canvas.selection.values().next().value;
    if (!sourceNode)
      return;
    const sourceNodeData = sourceNode.getData();
    const nodeMargin = this.plugin.settings.getSetting("cloneNodeMargin");
    const offset = {
      x: (sourceNode.width + nodeMargin) * (cloneDirection === "left" ? -1 : cloneDirection === "right" ? 1 : 0),
      y: (sourceNode.height + nodeMargin) * (cloneDirection === "up" ? -1 : cloneDirection === "down" ? 1 : 0)
    };
    const clonedNode = canvas.createTextNode({
      pos: {
        x: sourceNode.x + offset.x,
        y: sourceNode.y + offset.y
      },
      size: {
        width: sourceNode.width,
        height: sourceNode.height
      }
    });
    clonedNode.setData({
      ...clonedNode.getData(),
      color: sourceNodeData.color,
      shape: sourceNodeData.shape
    });
    if (this.plugin.settings.getSetting("zoomToClonedNode"))
      canvas.zoomToBbox(clonedNode.getBBox());
  }
  expandNode(canvas, expandDirection) {
    const node = canvas.selection.values().next().value;
    if (!node)
      return;
    const expandNodeStepSize = this.plugin.settings.getSetting("expandNodeStepSize");
    const expand = {
      x: expandDirection === "left" ? -1 : expandDirection === "right" ? 1 : 0,
      y: expandDirection === "up" ? -1 : expandDirection === "down" ? 1 : 0
    };
    node.setData({
      ...node.getData(),
      width: node.width + expand.x * expandNodeStepSize,
      height: node.height + expand.y * expandNodeStepSize
    });
  }
};

// src/canvas-extensions/portals-canvas-extension.ts
var import_obsidian5 = require("obsidian");
var PORTAL_PADDING = 50;
var MIN_OPEN_PORTAL_SIZE = { width: 200, height: 200 };
var PortalsCanvasExtension = class {
  constructor(plugin) {
    this.plugin = plugin;
    if (!this.plugin.settings.getSetting("portalsFeatureEnabled"))
      return;
    this.plugin.registerEvent(this.plugin.app.workspace.on(
      CanvasEvent.PopupMenuCreated,
      (canvas) => this.updatePopupMenu(canvas)
    ));
    this.plugin.registerEvent(this.plugin.app.workspace.on(
      CanvasEvent.NodeRemoved,
      (canvas, node) => this.onNodeRemoved(canvas, node)
    ));
    this.plugin.registerEvent(this.plugin.app.workspace.on(
      CanvasEvent.NodeMoved,
      (canvas, node) => this.onNodeMoved(canvas, node)
    ));
    this.plugin.registerEvent(this.plugin.app.workspace.on(
      CanvasEvent.DraggingStateChanged,
      (canvas, startedDragging) => this.onDraggingStateChanged(canvas, startedDragging)
    ));
    this.plugin.registerEvent(this.plugin.app.workspace.on(
      CanvasEvent.ContainingNodesRequested,
      (canvas, bbox, nodes) => this.onContainingNodesRequested(canvas, bbox, nodes)
    ));
    this.plugin.registerEvent(this.plugin.app.workspace.on(
      CanvasEvent.SelectionChanged,
      (canvas, oldSelection, updateSelection) => this.onSelectionChanged(canvas, oldSelection, updateSelection)
    ));
    this.plugin.registerEvent(this.plugin.app.workspace.on(
      CanvasEvent.EdgeChanged,
      (canvas, edge) => this.onEdgeChanged(canvas, edge)
    ));
    this.plugin.registerEvent(this.plugin.app.workspace.on(
      CanvasEvent.DataRequested,
      (canvas, data) => this.removePortalCanvasData(canvas, data)
    ));
    this.plugin.registerEvent(this.plugin.app.workspace.on(
      CanvasEvent.LoadData,
      (canvas, data, setData) => {
        this.getCanvasDataWithPortals(canvas, data).then((newData) => {
          if (newData.nodes.length === data.nodes.length && newData.edges.length === data.edges.length)
            return;
          setData(newData);
        });
      }
    ));
  }
  updatePopupMenu(canvas) {
    if (canvas.readonly)
      return;
    const selectedFileNodes = canvas.getSelectionData().nodes.map((nodeData) => {
      var _a;
      const node = canvas.nodes.get(nodeData.id);
      if (!node)
        return null;
      if (nodeData.type !== "file")
        return null;
      if (((_a = node.file) == null ? void 0 : _a.extension) === "canvas")
        return node;
      if (nodeData.portalToFile)
        this.setPortalOpen(canvas, node, false);
      return null;
    }).filter((node) => node !== null);
    if (selectedFileNodes.length !== 1)
      return;
    const portalNode = selectedFileNodes[0];
    const portalNodeData = portalNode.getData();
    if (portalNodeData.portalToFile && portalNodeData.file !== portalNodeData.portalToFile) {
      this.setPortalOpen(canvas, portalNode, true);
    }
    addPopupMenuOption(
      canvas,
      createPopupMenuOption({
        id: "toggle-portal",
        label: portalNodeData.portalToFile ? "Close portal" : "Open portal",
        icon: portalNodeData.portalToFile ? "door-open" : "door-closed",
        callback: () => {
          this.setPortalOpen(canvas, portalNode, portalNodeData.portalToFile === void 0);
          this.updatePopupMenu(canvas);
        }
      })
    );
  }
  setPortalOpen(canvas, portalNode, open) {
    const portalNodeData = portalNode.getData();
    portalNode.setData({
      ...portalNodeData,
      portalToFile: open ? portalNodeData.file : void 0
    });
    canvas.setData(canvas.getData());
  }
  onNodeRemoved(canvas, node) {
    var _a, _b, _c, _d;
    const nodeData = node.getData();
    if (nodeData.type !== "file" || !nodeData.portalToFile)
      return;
    Object.keys((_b = (_a = nodeData.portalIdMaps) == null ? void 0 : _a.nodeIdMap) != null ? _b : {}).map((refNodeId) => canvas.nodes.get(refNodeId)).filter((node2) => node2 !== void 0).forEach((node2) => canvas.removeNode(node2));
    Object.keys((_d = (_c = nodeData.portalIdMaps) == null ? void 0 : _c.edgeIdMap) != null ? _d : {}).map((refEdgeId) => canvas.edges.get(refEdgeId)).filter((edge) => edge !== void 0).forEach((edge) => canvas.removeEdge(edge));
  }
  onEdgeChanged(_canvas, edge) {
    const isUnsaved = edge.from.node !== void 0 && edge.to.node !== void 0 && // Edge not fully connected
    (edge.from.node.getData().portalId !== void 0 && edge.to.node.getData().portalId !== void 0) && // Both nodes are from portal
    edge.getData().portalId === void 0;
    edge.setData({
      ...edge.getData(),
      isUnsaved: isUnsaved ? true : void 0
    });
  }
  onContainingNodesRequested(_canvas, _bbox, nodes) {
    nodes.splice(0, nodes.length, ...nodes.filter((node) => node.getData().portalId === void 0));
  }
  onSelectionChanged(canvas, oldSelection, updateSelection) {
    updateSelection(() => {
      const updatedSelection = Array.from(canvas.selection).filter((node) => node.getData().portalId === void 0);
      canvas.selection = new Set(updatedSelection);
    });
    const previouslySelectedPortalNodesIds = Array.from(oldSelection).filter((node) => node.getData().portalToFile !== void 0).flatMap((node) => {
      const portalNodeData = node.getData();
      const nestedPortalsIds = this.getNestedPortalsIds(canvas, portalNodeData.id);
      return [portalNodeData.id, ...nestedPortalsIds];
    });
    for (const node of canvas.nodes.values()) {
      const nodeData = node.getData();
      if (nodeData.portalId === void 0 || !previouslySelectedPortalNodesIds.includes(nodeData.portalId))
        continue;
      node.updateZIndex();
    }
  }
  getNestedPortalsIds(canvas, portalId) {
    const nestedPortalsIds = [];
    for (const node of canvas.nodes.values()) {
      const nodeData = node.getData();
      if (nodeData.portalId === portalId) {
        nestedPortalsIds.push(nodeData.id);
        nestedPortalsIds.push(...this.getNestedPortalsIds(canvas, nodeData.id));
      }
    }
    return nestedPortalsIds;
  }
  onDraggingStateChanged(canvas, startedDragging) {
    var _a;
    if (!canvas.getSelectionData().nodes.some((node) => node.type === "file" && node.portalToFile))
      return;
    if (startedDragging) {
      const objectSnappingEnabled = canvas.options.snapToObjects;
      this.restoreObjectSnappingState = () => canvas.toggleObjectSnapping(objectSnappingEnabled);
      if (objectSnappingEnabled)
        canvas.toggleObjectSnapping(false);
    } else
      (_a = this.restoreObjectSnappingState) == null ? void 0 : _a.call(this);
  }
  onNodeMoved(canvas, node) {
    const nodeData = node.getData();
    if (nodeData.type !== "file" || !nodeData.portalToFile)
      return;
    this.onOpenPortalMoved(canvas, node);
  }
  onOpenPortalMoved(canvas, portalNode) {
    var _a;
    let portalNodeData = portalNode.getData();
    const nestedNodesIdMap = (_a = portalNode.getData().portalIdMaps) == null ? void 0 : _a.nodeIdMap;
    if (!nestedNodesIdMap)
      return;
    const nestedNodes = Object.keys(nestedNodesIdMap).map((refNodeId) => canvas.nodes.get(refNodeId)).filter((node) => node !== void 0);
    const sourceBBox = getBBox(nestedNodes);
    const targetSize = this.getPortalSize(sourceBBox);
    if (portalNodeData.width !== targetSize.width || portalNodeData.height !== targetSize.height) {
      portalNode.setData({
        ...portalNodeData,
        width: targetSize.width,
        height: targetSize.height
      });
      return;
    }
    const portalOffset = {
      x: portalNodeData.x - sourceBBox.minX + PORTAL_PADDING,
      y: portalNodeData.y - sourceBBox.minY + PORTAL_PADDING
    };
    for (const nestedNode of nestedNodes) {
      const nestedNodeData = nestedNode.getData();
      nestedNode.setData({
        ...nestedNodeData,
        x: nestedNodeData.x + portalOffset.x,
        y: nestedNodeData.y + portalOffset.y
      });
    }
  }
  removePortalCanvasData(_canvas, data) {
    var _a, _b;
    data.edges = data.edges.filter((edgeData) => {
      var _a2, _b2;
      if (edgeData.portalId !== void 0)
        return false;
      const fromNodeData = data.nodes.find((nodeData) => nodeData.id === edgeData.fromNode);
      const toNodeData = data.nodes.find((nodeData) => nodeData.id === edgeData.toNode);
      if (!fromNodeData || !toNodeData)
        return true;
      if (fromNodeData.portalId === void 0 && toNodeData.portalId === void 0) {
        return true;
      } else if (fromNodeData.portalId !== void 0 && toNodeData.portalId !== void 0) {
        return false;
      } else {
        const fromPortalNodeData = fromNodeData.portalId !== void 0 ? fromNodeData : toNodeData;
        const notFromPortalNodeData = fromNodeData.portalId !== void 0 ? toNodeData : fromNodeData;
        notFromPortalNodeData.edgesToNodeFromPortal = (_a2 = notFromPortalNodeData.edgesToNodeFromPortal) != null ? _a2 : {};
        notFromPortalNodeData.edgesToNodeFromPortal[fromPortalNodeData.portalId] = (_b2 = notFromPortalNodeData.edgesToNodeFromPortal[fromPortalNodeData.portalId]) != null ? _b2 : [];
        notFromPortalNodeData.edgesToNodeFromPortal[fromPortalNodeData.portalId].push(edgeData);
        return false;
      }
    });
    data.nodes = data.nodes.filter((nodeData) => nodeData.portalId === void 0);
    for (const portalNodeData of data.nodes) {
      if (portalNodeData.type !== "file")
        continue;
      if (this.plugin.settings.getSetting("maintainClosedPortalSize")) {
        portalNodeData.width = (_a = portalNodeData.closedPortalWidth) != null ? _a : portalNodeData.width;
        portalNodeData.height = (_b = portalNodeData.closedPortalHeight) != null ? _b : portalNodeData.height;
      }
      delete portalNodeData.closedPortalWidth;
      delete portalNodeData.closedPortalHeight;
      delete portalNodeData.portalIdMaps;
    }
  }
  async getCanvasDataWithPortals(canvas, dataRef) {
    const data = JSON.parse(JSON.stringify(dataRef));
    const addedData = await Promise.all(data.nodes.map((nodeData) => this.tryOpenPortal(canvas, nodeData)));
    for (const newData of addedData) {
      data.nodes.push(...newData.nodes);
      data.edges.push(...newData.edges);
    }
    for (const originNodeData of data.nodes) {
      if (originNodeData.edgesToNodeFromPortal === void 0)
        continue;
      for (const [relativePortalId, edges] of Object.entries(originNodeData.edgesToNodeFromPortal)) {
        const idPrefix = originNodeData.portalId ? `${originNodeData.portalId}-` : "";
        const portalId = `${idPrefix}${relativePortalId}`;
        const targetPortalData = data.nodes.find((nodeData) => nodeData.id === portalId);
        if (!targetPortalData) {
          delete originNodeData.edgesToNodeFromPortal[portalId];
          continue;
        }
        if (targetPortalData.portalToFile) {
          data.edges.push(...edges.map((edge) => ({
            ...edge,
            portalId: originNodeData.portalId,
            fromNode: `${idPrefix}${edge.fromNode}`,
            toNode: `${idPrefix}${edge.toNode}`
          })));
          delete originNodeData.edgesToNodeFromPortal[portalId];
        } else if (this.plugin.settings.getSetting("showEdgesIntoDisabledPortals")) {
          data.edges.push(...edges.map((edge) => {
            const fromNodeId = `${idPrefix}${edge.fromNode}`;
            const fromNode = data.nodes.find((nodeData) => nodeData.id === fromNodeId);
            const toNodeId = `${idPrefix}${edge.toNode}`;
            return {
              ...edge,
              fromNode: fromNode ? fromNodeId : portalId,
              toNode: fromNode ? portalId : toNodeId,
              portalId
              // Mark it as temporary
            };
          }));
        }
      }
      if (Object.keys(originNodeData.edgesToNodeFromPortal).length === 0)
        delete originNodeData.edgesToNodeFromPortal;
    }
    return data;
  }
  async tryOpenPortal(canvas, portalNodeData) {
    var _a, _b;
    const addedData = { nodes: [], edges: [] };
    if (portalNodeData.type !== "file" || !portalNodeData.portalToFile)
      return addedData;
    portalNodeData.portalToFile = portalNodeData.file;
    if (portalNodeData.portalToFile === canvas.view.file.path) {
      portalNodeData.portalToFile = void 0;
      return addedData;
    }
    const portalFile = this.plugin.app.vault.getAbstractFileByPath(portalNodeData.file);
    if (!(portalFile instanceof import_obsidian5.TFile) || portalFile.extension !== "canvas") {
      portalNodeData.portalToFile = void 0;
      return addedData;
    }
    const portalFileData = JSON.parse(await this.plugin.app.vault.cachedRead(portalFile));
    if (!portalFileData) {
      portalNodeData.portalToFile = void 0;
      return addedData;
    }
    portalNodeData.portalIdMaps = {
      nodeIdMap: {},
      edgeIdMap: {}
    };
    const sourceMinCoordinates = getBBox(portalFileData.nodes);
    const portalOffset = {
      x: portalNodeData.x - sourceMinCoordinates.minX + PORTAL_PADDING,
      y: portalNodeData.y - sourceMinCoordinates.minY + PORTAL_PADDING
    };
    for (const nodeDataFromPortal of portalFileData.nodes) {
      const refNodeId = `${portalNodeData.id}-${nodeDataFromPortal.id}`;
      portalNodeData.portalIdMaps.nodeIdMap[refNodeId] = nodeDataFromPortal.id;
      const addedNode = {
        ...nodeDataFromPortal,
        id: refNodeId,
        x: nodeDataFromPortal.x + portalOffset.x,
        y: nodeDataFromPortal.y + portalOffset.y,
        portalId: portalNodeData.id
      };
      addedData.nodes.push(addedNode);
      const nestedNodes = await this.tryOpenPortal(canvas, addedNode);
      addedData.nodes.push(...nestedNodes.nodes);
      addedData.edges.push(...nestedNodes.edges);
    }
    for (const edgeDataFromPortal of portalFileData.edges) {
      const refEdgeId = `${portalNodeData.id}-${edgeDataFromPortal.id}`;
      portalNodeData.portalIdMaps.edgeIdMap[refEdgeId] = edgeDataFromPortal.id;
      const fromRefNode = (_a = Object.entries(portalNodeData.portalIdMaps.nodeIdMap).find(([_refNodeId, nodeId]) => nodeId === edgeDataFromPortal.fromNode)) == null ? void 0 : _a[0];
      const toRefNode = (_b = Object.entries(portalNodeData.portalIdMaps.nodeIdMap).find(([_refNodeId, nodeId]) => nodeId === edgeDataFromPortal.toNode)) == null ? void 0 : _b[0];
      addedData.edges.push({
        ...edgeDataFromPortal,
        id: refEdgeId,
        fromNode: fromRefNode,
        toNode: toRefNode,
        portalId: portalNodeData.id
      });
    }
    const nestedNodesBBox = getBBox(addedData.nodes);
    const targetSize = this.getPortalSize(nestedNodesBBox);
    portalNodeData.closedPortalWidth = portalNodeData.width;
    portalNodeData.closedPortalHeight = portalNodeData.height;
    portalNodeData.width = targetSize.width;
    portalNodeData.height = targetSize.height;
    return addedData;
  }
  getPortalSize(sourceBBox) {
    const sourceSize = {
      width: sourceBBox.maxX - sourceBBox.minX,
      height: sourceBBox.maxY - sourceBBox.minY
    };
    const targetSize = {
      width: Math.max(sourceSize.width + PORTAL_PADDING * 2, MIN_OPEN_PORTAL_SIZE.width),
      height: Math.max(sourceSize.height + PORTAL_PADDING * 2, MIN_OPEN_PORTAL_SIZE.height)
    };
    if (!Number.isFinite(targetSize.width))
      targetSize.width = MIN_OPEN_PORTAL_SIZE.width;
    if (!Number.isFinite(targetSize.height))
      targetSize.height = MIN_OPEN_PORTAL_SIZE.height;
    return targetSize;
  }
};

// src/utils/icons-helper.ts
var import_obsidian6 = require("obsidian");
var CUSTOM_ICONS = {
  "oval": `<rect rx="31.25" height="62.5" width="93.75" y="18.75" x="3.125" stroke-width="8.333" stroke="currentColor" fill="transparent"/>`,
  "parallelogram": `<rect transform="skewX(-20)" rx="5" height="50" width="70" y="25" x="35" stroke-width="8.333" stroke="currentColor" fill="transparent"/>`,
  "predefined-process": `
    <g stroke-width="2" stroke="currentColor" fill="none" transform="matrix(4.166667,0,0,4.166667,0,0)">
      <path d="M 4.999687 3 L 19.000312 3 C 20.104688 3 21 3.895312 21 4.999687 L 21 19.000312 C 21 20.104688 20.104688 21 19.000312 21 L 4.999687 21 C 3.895312 21 3 20.104688 3 19.000312 L 3 4.999687 C 3 3.895312 3.895312 3 4.999687 3 Z M 4.999687 3 "/>
      <path d="M 7 3 L 7 21 "/>
      <path d="M 17 3 L 17 21 "/>
    </g>
  `,
  "document": `<path transform="translate(0, 5)" stroke="currentColor" fill="none" stroke-width="8.333" d="M83.75 25C85.82 25 87.5 26.68 87.5 28.75L87.5 64.375Q68.75 54.25 50 64.375 31.25 74.5 12.5 64.375L12.5 30.625 12.5 28.75C12.5 26.68 14.18 25 16.25 25Z"/>`,
  "database-shape": `
    <g transform="translate(20, 20)" stroke-width="8.333" stroke="currentColor" fill="none">
      <path d="M 1 51 L 1 11 C 1 5.48 14.43 1 31 1 C 47.57 1 61 5.48 61 11 L 61 51 C 61 56.52 47.57 61 31 61 C 14.43 61 1 56.52 1 51 Z"/>
      <path d="M 1 11 C 1 16.52 14.43 21 31 21 C 47.57 21 61 16.52 61 11"/>
    </g>
  `,
  "dotted-line": `<path stroke="currentColor" fill="none" stroke-width="8.5" stroke-dasharray="8.5" d="M20.85 50h58.5"/>`,
  "short-dashed-line": `<path stroke="currentColor" fill="none" stroke-width="8.5" stroke-dasharray="10" d="M20.85 50h58.5"/>`,
  "long-dashed-line": `<path stroke="currentColor" fill="none" stroke-width="8.5" stroke-dasharray="20" d="M20.85 50h58.5"/>`
};
var IconsHelper = class {
  static addIcons() {
    for (const [id, svg] of Object.entries(CUSTOM_ICONS)) {
      (0, import_obsidian6.addIcon)(id, svg);
    }
  }
};

// src/canvas-extensions/stickers-canvas-extension.ts
var IMAGE_FILE_EXTENSIONS = ["bmp", "png", "jpg", "jpeg", "gif", "svg", "webp", "avif"];
var StickersCanvasExtension = class {
  constructor(plugin) {
    this.plugin = plugin;
    if (!this.plugin.settings.getSetting("stickersFeatureEnabled"))
      return;
    this.plugin.registerEvent(this.plugin.app.workspace.on(
      CanvasEvent.PopupMenuCreated,
      (canvas) => this.onPopupMenuCreated(canvas)
    ));
  }
  onPopupMenuCreated(canvas) {
    if (canvas.readonly || !this.hasValidNodeInSelection(canvas))
      return;
    addPopupMenuOption(
      canvas,
      createPopupMenuOption({
        id: "sticker-option",
        label: "Toggle sticker",
        icon: "badge",
        callback: () => this.toggleStickerForSelection(canvas)
      })
    );
  }
  hasValidNodeInSelection(canvas) {
    var _a, _b;
    const selectedNodesData = canvas.getSelectionData().nodes;
    for (const nodeData of selectedNodesData) {
      if (nodeData.type !== "file")
        continue;
      const nodeFileExtension = (_b = (_a = nodeData.file) == null ? void 0 : _a.split(".").pop()) == null ? void 0 : _b.toLowerCase();
      if (!nodeFileExtension)
        continue;
      if (!IMAGE_FILE_EXTENSIONS.includes(nodeFileExtension))
        continue;
      return true;
    }
    return false;
  }
  toggleStickerForSelection(canvas) {
    const selectedNodesData = canvas.getSelectionData().nodes;
    for (const nodeData of selectedNodesData) {
      if (nodeData.type !== "file")
        continue;
      const node = canvas.nodes.get(nodeData.id);
      if (!node)
        continue;
      const wasSticker = node.getData().isSticker;
      node.setData({ ...nodeData, isSticker: wasSticker ? void 0 : true });
    }
  }
};

// src/utils/a-star-helper.ts
var DIRECTIONS2 = [
  { dx: 1, dy: 0 },
  { dx: -1, dy: 0 },
  { dx: 0, dy: 1 },
  { dx: 0, dy: -1 },
  { dx: 1, dy: 1 },
  { dx: -1, dy: 1 },
  { dx: 1, dy: -1 },
  { dx: -1, dy: -1 }
];
var DIAGONAL_COST = Math.sqrt(2);
var Node = class {
  constructor(x, y) {
    this.x = x;
    this.y = y;
    this.gCost = 0;
    this.hCost = 0;
    this.fCost = 0;
    this.parent = null;
  }
  // Only check for x and y, not gCost, hCost, fCost, or parent
  inList(nodes) {
    return nodes.some((n) => n.x === this.x && n.y === this.y);
  }
};
function heuristic(node, end) {
  return Math.abs(node.x - end.x) + Math.abs(node.y - end.y);
}
function isTouchingObstacle(node, obstacles) {
  return obstacles.some((obstacle) => insideBBox(node, obstacle, true));
}
function isInsideObstacle(node, obstacles) {
  return obstacles.some((obstacle) => insideBBox(node, obstacle, false));
}
function getMovementCost(direction) {
  return direction.dx !== 0 && direction.dy !== 0 ? DIAGONAL_COST : 1;
}
function getPossibleNeighbors(node, obstacles, gridResolution) {
  const neighbors = [];
  for (const direction of DIRECTIONS2) {
    const neighbor = new Node(
      node.x + direction.dx * gridResolution,
      node.y + direction.dy * gridResolution
    );
    neighbor.gCost = node.gCost + getMovementCost(direction);
    if (isInsideObstacle(neighbor, obstacles))
      continue;
    neighbors.push(neighbor);
  }
  return neighbors;
}
function reconstructPath(node) {
  const path = [];
  while (node) {
    path.push(node);
    node = node.parent;
  }
  return path.reverse();
}
function aStar(fromPos, fromSide, toPos, toSide, obstacles, gridResolution) {
  const start = new Node(
    Math.floor(fromPos.x / gridResolution) * gridResolution,
    Math.floor(fromPos.y / gridResolution) * gridResolution
  );
  if (fromSide === "right" && fromPos.x !== start.x)
    start.x += gridResolution;
  if (fromSide === "bottom" && fromPos.y !== start.y)
    start.y += gridResolution;
  const end = new Node(
    Math.floor(toPos.x / gridResolution) * gridResolution,
    Math.floor(toPos.y / gridResolution) * gridResolution
  );
  if (toSide === "right" && toPos.x !== end.x)
    end.x += gridResolution;
  if (toSide === "bottom" && toPos.y !== end.y)
    end.y += gridResolution;
  if (isInsideObstacle(start, obstacles) || isInsideObstacle(end, obstacles))
    return null;
  const openSet = [start];
  const closedSet = [];
  while (openSet.length > 0) {
    let current = null;
    let lowestFCost = Infinity;
    for (const node of openSet) {
      if (node.fCost < lowestFCost) {
        current = node;
        lowestFCost = node.fCost;
      }
    }
    if (!current)
      return null;
    openSet.splice(openSet.indexOf(current), 1);
    closedSet.push(current);
    if (current.x === end.x && current.y === end.y) {
      return [fromPos, ...reconstructPath(current), toPos].map((node) => ({ x: node.x, y: node.y }));
    }
    if (!(current.x === start.x && current.y === start.y) && isTouchingObstacle(current, obstacles))
      continue;
    for (const neighbor of getPossibleNeighbors(current, obstacles, gridResolution)) {
      if (neighbor.inList(closedSet))
        continue;
      const tentativeGCost = current.gCost + getMovementCost({
        dx: neighbor.x - current.x,
        dy: neighbor.y - current.y
      });
      if (!neighbor.inList(openSet) || tentativeGCost < neighbor.gCost) {
        neighbor.parent = current;
        neighbor.gCost = tentativeGCost;
        neighbor.hCost = heuristic(neighbor, end);
        neighbor.fCost = neighbor.gCost + neighbor.hCost;
        openSet.push(neighbor);
      }
    }
  }
  return null;
}

// src/utils/svg-path-helper.ts
function pathArrayToSvgPath(positions, rounded = false) {
  const tension = 0.2;
  let newPositions = [...positions];
  if (rounded && positions.length > 2) {
    newPositions = [positions[0]];
    for (let i = 1; i < positions.length - 2; i++) {
      const p1 = positions[i];
      const p2 = positions[i + 1];
      const p3 = positions[i + 2];
      const t1 = (1 - tension) / 2;
      const t2 = 1 - t1;
      const x = t2 * t2 * t2 * p1.x + 3 * t2 * t2 * t1 * p2.x + 3 * t2 * t1 * t1 * p3.x + t1 * t1 * t1 * p2.x;
      const y = t2 * t2 * t2 * p1.y + 3 * t2 * t2 * t1 * p2.y + 3 * t2 * t1 * t1 * p3.y + t1 * t1 * t1 * p2.y;
      newPositions.push({ x, y });
    }
    const lastPoint = positions[positions.length - 1];
    newPositions.push(lastPoint);
  }
  for (let i = 0; i < newPositions.length - 2; i++) {
    const p1 = newPositions[i];
    const p2 = newPositions[i + 1];
    const p3 = newPositions[i + 2];
    const currentDirection = {
      x: p2.x - p1.x,
      y: p2.y - p1.y
    };
    const nextDirection = {
      x: p3.x - p2.x,
      y: p3.y - p2.y
    };
    if (currentDirection.x !== nextDirection.x && currentDirection.y !== nextDirection.y)
      continue;
    newPositions.splice(i + 1, 1);
    i--;
  }
  return newPositions.map(
    (position, index) => `${index === 0 ? "M" : "L"} ${position.x} ${position.y}`
  ).join(" ");
}

// src/canvas-extensions/edges-style-canvas-extension.ts
var STYLES_MENU_OPTIONS = [
  {
    id: void 0,
    label: "Default",
    icon: "minus"
  },
  {
    id: "long-dashed",
    label: "Dashed (long)",
    icon: "long-dashed-line"
  },
  {
    id: "short-dashed",
    label: "Dashed",
    icon: "short-dashed-line"
  },
  {
    id: "dotted",
    label: "Dotted",
    icon: "dotted-line"
  }
];
var ROUTES_MENU_OPTIONS = [
  {
    id: void 0,
    label: "Default",
    icon: "route"
  },
  {
    id: "direct",
    label: "Direct",
    icon: "minus"
  },
  {
    id: "square",
    label: "Square",
    icon: "corner-down-right"
  },
  {
    id: "a-star",
    label: "A*",
    icon: "navigation"
  }
];
var EdgesStyleCanvasExtension = class {
  constructor(plugin) {
    this.plugin = plugin;
    if (!this.plugin.settings.getSetting("edgesStylingFeatureEnabled"))
      return;
    this.plugin.registerEvent(this.plugin.app.workspace.on(
      CanvasEvent.PopupMenuCreated,
      (canvas) => this.onPopupMenuCreated(canvas)
    ));
    this.plugin.registerEvent(this.plugin.app.workspace.on(
      CanvasEvent.EdgeChanged,
      (canvas, edge) => this.onEdgeChanged(canvas, edge)
    ));
    this.plugin.registerEvent(this.plugin.app.workspace.on(
      CanvasEvent.EdgeCenterRequested,
      (canvas, edge, center) => this.onEdgeCenterRequested(canvas, edge, center)
    ));
    this.plugin.registerEvent(this.plugin.app.workspace.on(
      CanvasEvent.NodeAdded,
      (canvas, _node) => this.updateAllEdges(canvas)
    ));
    this.plugin.registerEvent(this.plugin.app.workspace.on(
      CanvasEvent.NodeRemoved,
      (canvas, _node) => this.updateAllEdges(canvas)
    ));
    this.plugin.registerEvent(this.plugin.app.workspace.on(
      CanvasEvent.DraggingStateChanged,
      (canvas, isDragging) => {
        if (!isDragging)
          this.updateAllEdges(canvas);
      }
    ));
  }
  onPopupMenuCreated(canvas) {
    const selectedEdges = [...canvas.selection].filter((item) => item.path !== void 0);
    if (canvas.readonly || selectedEdges.length === 0)
      return;
    const pathStyleNestedOptions = STYLES_MENU_OPTIONS.map((style) => ({
      ...style,
      id: void 0,
      callback: () => this.setStyleForSelection(canvas, selectedEdges, style.id)
    }));
    const pathStyleMenuOption = createExpandablePopupMenuOption({
      id: "edge-style-option",
      label: "Edge style",
      icon: "minus"
    }, pathStyleNestedOptions);
    addPopupMenuOption(canvas, pathStyleMenuOption, -2);
    const pathRouteNestedOptions = ROUTES_MENU_OPTIONS.map((route) => ({
      ...route,
      id: void 0,
      callback: () => this.setPathRouteForSelection(canvas, selectedEdges, route.id)
    }));
    const pathRouteMenuOption = createExpandablePopupMenuOption({
      id: "edge-path-route-option",
      label: "Edge path route",
      icon: "route"
    }, pathRouteNestedOptions);
    addPopupMenuOption(canvas, pathRouteMenuOption, -2);
  }
  setStyleForSelection(_canvas, selectedEdges, styleId) {
    for (const edge of selectedEdges) {
      edge.setData({ ...edge.getData(), edgeStyle: styleId });
    }
  }
  setPathRouteForSelection(_canvas, selectedEdges, pathRouteTypeId) {
    for (const edge of selectedEdges) {
      edge.setData({ ...edge.getData(), edgePathRoute: pathRouteTypeId });
    }
  }
  updateAllEdges(canvas) {
    for (const edge of canvas.edges.values()) {
      this.onEdgeChanged(canvas, edge);
    }
  }
  onEdgeChanged(canvas, edge) {
    var _a, _b, _c;
    if (!edge.bezier)
      return;
    edge.updatePath();
    edge.center = void 0;
    const pathRouteType = (_a = edge.getData().edgePathRoute) != null ? _a : "default";
    if (pathRouteType === "default") {
      (_b = edge.labelElement) == null ? void 0 : _b.render();
      return;
    }
    const fromPos = edge.from.end === "none" ? getCenterOfBBoxSide(edge.from.node.getBBox(), edge.from.side) : edge.bezier.from;
    const toPos = edge.to.end === "none" ? getCenterOfBBoxSide(edge.to.node.getBBox(), edge.to.side) : edge.bezier.to;
    let newPath = edge.path.display.getAttribute("d");
    if (pathRouteType === "direct") {
      newPath = pathArrayToSvgPath([fromPos, toPos], false);
      edge.center = {
        x: (fromPos.x + toPos.x) / 2,
        y: (fromPos.y + toPos.y) / 2
      };
    } else if (pathRouteType === "square") {
      let pathArray = [];
      if (edge.from.side === "bottom" || edge.from.side === "top") {
        pathArray = [
          fromPos,
          { x: fromPos.x, y: fromPos.y + (toPos.y - fromPos.y) / 2 },
          { x: toPos.x, y: fromPos.y + (toPos.y - fromPos.y) / 2 },
          toPos
        ];
      } else {
        pathArray = [
          fromPos,
          { x: fromPos.x + (toPos.x - fromPos.x) / 2, y: fromPos.y },
          { x: fromPos.x + (toPos.x - fromPos.x) / 2, y: toPos.y },
          toPos
        ];
      }
      newPath = pathArrayToSvgPath(pathArray, false);
      edge.center = {
        x: (fromPos.x + toPos.x) / 2,
        y: (fromPos.y + toPos.y) / 2
      };
    } else if (pathRouteType === "a-star") {
      if (canvas.isDragging && !this.plugin.settings.getSetting("edgeStylePathfinderPathLiveUpdate"))
        return;
      const nodeBBoxes = [...canvas.nodes.values()].filter((node) => {
        const nodeData = node.getData();
        const isGroup = nodeData.type === "group";
        const isOpenPortal = nodeData.portalToFile !== void 0;
        return !isGroup && !isOpenPortal;
      }).map((node) => node.getBBox());
      const gridResolution = this.plugin.settings.getSetting("edgeStylePathfinderGridResolution");
      const pathArray = aStar(fromPos, edge.from.side, toPos, edge.to.side, nodeBBoxes, gridResolution);
      if (!pathArray)
        return;
      const roundedPath = this.plugin.settings.getSetting("edgeStylePathfinderPathRounded");
      const svgPath = pathArrayToSvgPath(pathArray, roundedPath);
      newPath = svgPath;
      edge.center = pathArray[Math.floor(pathArray.length / 2)];
    }
    edge.path.interaction.setAttr("d", newPath);
    edge.path.display.setAttr("d", newPath);
    (_c = edge.labelElement) == null ? void 0 : _c.render();
  }
  onEdgeCenterRequested(_canvas, edge, center) {
    var _a, _b, _c, _d;
    center.x = (_b = (_a = edge.center) == null ? void 0 : _a.x) != null ? _b : center.x;
    center.y = (_d = (_c = edge.center) == null ? void 0 : _c.y) != null ? _d : center.y;
  }
};

// src/canvas-extensions/edge-data-tagger-canvas-extension.ts
function getExposedEdgeData(settings) {
  const exposedData = [];
  if (settings.getSetting("edgesStylingFeatureEnabled"))
    exposedData.push("edgeStyle");
  if (settings.getSetting("portalsFeatureEnabled"))
    exposedData.push("isUnsaved");
  return exposedData;
}
var EdgeDataTaggerCanvasExtension = class {
  constructor(plugin) {
    this.plugin = plugin;
    this.plugin.registerEvent(this.plugin.app.workspace.on(
      CanvasEvent.EdgeChanged,
      (_canvas, edge) => {
        const edgeData = edge == null ? void 0 : edge.getData();
        if (!edgeData)
          return;
        for (const dataKey of getExposedEdgeData(this.plugin.settings)) {
          const dataValue = edgeData[dataKey];
          if (!dataValue)
            delete edge.path.display.dataset[dataKey];
          else
            edge.path.display.dataset[dataKey] = dataValue;
        }
      }
    ));
  }
};

// src/utils/debug-helper.ts
var DebugHelper = class {
  constructor(plugin) {
    this.plugin = plugin;
    this.plugin.registerEvent(this.plugin.app.workspace.on(
      CanvasEvent.NodeAdded,
      (_canvas, _node) => console.count("\u{1F7E2} NodeAdded")
    ));
    this.plugin.registerEvent(this.plugin.app.workspace.on(
      CanvasEvent.NodeChanged,
      (_canvas, _node) => console.count("\u{1F7E1} NodeChanged")
    ));
    this.plugin.registerEvent(this.plugin.app.workspace.on(
      CanvasEvent.EdgeAdded,
      (_canvas, _edge) => console.count("\u{1F7E2} EdgeAdded")
    ));
    this.plugin.registerEvent(this.plugin.app.workspace.on(
      CanvasEvent.EdgeChanged,
      (_canvas, _edge) => console.count("\u{1F7E1} EdgeChanged")
    ));
  }
};

// src/canvas-extensions/better-default-settings-canvas-extension.ts
var BetterDefaultSettingsCanvasExtension = class {
  constructor(plugin) {
    this.plugin = plugin;
    this.plugin.registerEvent(this.plugin.app.workspace.on(
      SettingsManager.SETTINGS_CHANGED_EVENT,
      () => this.applySettings(this.plugin.getCurrentCanvas())
    ));
    this.plugin.registerEvent(this.plugin.app.workspace.on(
      CanvasEvent.CanvasChanged,
      (canvas) => this.applySettings(canvas)
    ));
    this.plugin.registerEvent(this.plugin.app.workspace.on(
      CanvasEvent.DoubleClick,
      (canvas, event, preventDefault) => this.onDoubleClick(canvas, event, preventDefault)
    ));
    this.applySettings(this.plugin.getCurrentCanvas());
  }
  applySettings(canvas) {
    if (!canvas)
      return;
    canvas.config.defaultTextNodeDimensions = {
      width: this.plugin.settings.getSetting("defaultTextNodeWidth"),
      height: this.plugin.settings.getSetting("defaultTextNodeHeight")
    };
    canvas.config.defaultFileNodeDimensions = {
      width: this.plugin.settings.getSetting("defaultFileNodeWidth"),
      height: this.plugin.settings.getSetting("defaultFileNodeHeight")
    };
  }
  async onDoubleClick(canvas, event, preventDefault) {
    if (event.defaultPrevented || event.target !== canvas.wrapperEl || canvas.isDragging || canvas.readonly)
      return;
    preventDefault.value = true;
    var pos = canvas.posFromEvt(event);
    switch (this.plugin.settings.getSetting("nodeTypeOnDoubleClick")) {
      case "file":
        const file = await new FileSelectModal(this.plugin.app, void 0, true).awaitInput();
        canvas.createFileNode({
          pos,
          position: "center",
          file
        });
        break;
      default:
        canvas.createTextNode({
          pos,
          position: "center"
        });
        break;
    }
  }
};

// src/canvas-extensions/color-palette-canvas-extension.ts
var DEFAULT_COLORS_COUNT = 6;
var CUSTOM_COLORS_MOD_STYLES_ID = "mod-custom-colors";
var ColorPaletteCanvasExtension = class {
  constructor(plugin) {
    this.observer = null;
    this.plugin = plugin;
    this.plugin.registerEvent(this.plugin.app.workspace.on(
      "window-open",
      (_win, _window) => this.updateCustomColorModStyleClasses()
    ));
    this.plugin.registerEvent(this.plugin.app.workspace.on(
      "css-change",
      () => this.updateCustomColorModStyleClasses()
    ));
    this.updateCustomColorModStyleClasses();
    this.plugin.registerEvent(this.plugin.app.workspace.on(
      CanvasEvent.PopupMenuCreated,
      (canvas) => this.patchColorSelection(canvas)
    ));
    this.plugin.register(() => {
      var _a;
      return (_a = this.observer) == null ? void 0 : _a.disconnect();
    });
  }
  updateCustomColorModStyleClasses() {
    var _a;
    const customCss = this.getCustomColors().map((colorId) => `
      .mod-canvas-color-${colorId} {
        --canvas-color: var(--canvas-color-${colorId});
      }
    `).join("");
    for (const win of this.plugin.windowsManager.windows) {
      const doc = win.document;
      (_a = doc.getElementById(CUSTOM_COLORS_MOD_STYLES_ID)) == null ? void 0 : _a.remove();
      const customColorModStyle = doc.createElement("style");
      customColorModStyle.id = CUSTOM_COLORS_MOD_STYLES_ID;
      doc.head.appendChild(customColorModStyle);
      customColorModStyle.textContent = customCss;
    }
  }
  patchColorSelection(canvas) {
    if (this.observer)
      this.observer.disconnect();
    this.observer = new MutationObserver((mutations) => {
      const colorMenuOpened = mutations.some(
        (mutation) => Object.values(mutation.addedNodes).some(
          (node) => node instanceof HTMLElement && node.classList.contains("canvas-submenu") && Object.values(node.childNodes).some(
            (node2) => node2 instanceof HTMLElement && node2.classList.contains("canvas-color-picker-item")
          )
        )
      );
      if (!colorMenuOpened)
        return;
      const submenu = canvas.menu.menuEl.querySelector(".canvas-submenu");
      if (!submenu)
        return;
      const currentNodeColor = canvas.getSelectionData().nodes.map((node) => node.color).last();
      for (const colorId of this.getCustomColors()) {
        const customColorMenuItem = this.createColorMenuItem(canvas, colorId);
        if (currentNodeColor === colorId)
          customColorMenuItem.classList.add("is-active");
        submenu.insertBefore(customColorMenuItem, submenu.lastChild);
      }
    });
    this.observer.observe(canvas.menu.menuEl, { childList: true });
  }
  createColorMenuItem(canvas, colorId) {
    const menuItem = document.createElement("div");
    menuItem.classList.add("canvas-color-picker-item");
    menuItem.classList.add(`mod-canvas-color-${colorId}`);
    menuItem.addEventListener("click", () => {
      menuItem.classList.add("is-active");
      for (const item of canvas.selection) {
        item.setColor(colorId);
      }
      canvas.requestSave();
    });
    return menuItem;
  }
  getCustomColors() {
    const colors = [];
    while (true) {
      const colorId = (DEFAULT_COLORS_COUNT + colors.length + 1).toString();
      if (!getComputedStyle(document.body).getPropertyValue(`--canvas-color-${colorId}`))
        break;
      colors.push(colorId);
    }
    return colors;
  }
};

// src/canvas-extensions/collapsible-groups-canvas-extension.ts
var import_obsidian7 = require("obsidian");
var COLLAPSE_BUTTON_ID = "group-collapse-button";
var CollapsibleGroupsCanvasExtension = class {
  constructor(plugin) {
    this.plugin = plugin;
    if (!this.plugin.settings.getSetting("collapsibleGroupsFeatureEnabled"))
      return;
    this.plugin.registerEvent(this.plugin.app.workspace.on(
      CanvasEvent.NodeChanged,
      (canvas, node) => this.onNodeChanged(canvas, node)
    ));
    this.plugin.registerEvent(this.plugin.app.workspace.on(
      CanvasEvent.NodeBBoxRequested,
      (canvas, node, bbox) => this.onNodeBBoxRequested(canvas, node, bbox)
    ));
    this.plugin.registerEvent(this.plugin.app.workspace.on(
      CanvasEvent.DataRequested,
      (_canvas, data) => this.expandCollapsedNodes(data)
    ));
    this.plugin.registerEvent(this.plugin.app.workspace.on(
      CanvasEvent.LoadData,
      (_canvas, data, _setData) => this.collapseNodes(data)
    ));
  }
  onNodeChanged(canvas, groupNode) {
    var _a, _b;
    const groupNodeData = groupNode.getData();
    if (groupNodeData.type !== "group")
      return;
    (_a = groupNode.nodeEl) == null ? void 0 : _a.querySelectorAll(`#${COLLAPSE_BUTTON_ID}`).forEach((el) => el.remove());
    const collapseButton = document.createElement("span");
    collapseButton.id = COLLAPSE_BUTTON_ID;
    (0, import_obsidian7.setIcon)(collapseButton, groupNodeData.isCollapsed ? "plus-circle" : "minus-circle");
    collapseButton.onclick = () => {
      this.setCollapsed(canvas, groupNode, groupNode.getData().isCollapsed ? void 0 : true);
    };
    (_b = groupNode.labelEl) == null ? void 0 : _b.insertAdjacentElement("afterend", collapseButton);
  }
  setCollapsed(canvas, groupNode, collapsed) {
    groupNode.setData({ ...groupNode.getData(), isCollapsed: collapsed });
    canvas.setData(canvas.getData());
  }
  onNodeBBoxRequested(_canvas, node, bbox) {
    var _a, _b;
    const nodeData = node.getData();
    if (nodeData.type !== "group" || !nodeData.isCollapsed)
      return;
    bbox.maxX = bbox.minX + ((_b = (_a = node.nodeEl) == null ? void 0 : _a.getBoundingClientRect().width) != null ? _b : 0);
    bbox.maxY = bbox.minY;
  }
  expandCollapsedNodes(data) {
    data.nodes = data.nodes.flatMap((groupNodeData) => {
      const collapsedData = groupNodeData.collapsedData;
      if (collapsedData === void 0)
        return [groupNodeData];
      groupNodeData.collapsedData = void 0;
      data.edges.push(...collapsedData.edges);
      return [groupNodeData, ...collapsedData.nodes.map((nodeData) => ({
        ...nodeData,
        // Restore the relative position of the node to the group
        x: nodeData.x + groupNodeData.x,
        y: nodeData.y + groupNodeData.y
      }))];
    });
  }
  collapseNodes(data) {
    data.nodes.forEach((groupNodeData) => {
      if (!groupNodeData.isCollapsed)
        return;
      const groupNodeBBox = bboxFromNodeData(groupNodeData);
      const containedNodesData = data.nodes.filter(
        (nodeData) => nodeData.id !== groupNodeData.id && insideBBox(bboxFromNodeData(nodeData), groupNodeBBox, false)
      );
      const containedEdgesData = data.edges.filter((edgeData) => {
        return containedNodesData.some((nodeData) => nodeData.id === edgeData.fromNode) || containedNodesData.some((nodeData) => nodeData.id === edgeData.toNode);
      });
      data.nodes = data.nodes.filter((nodeData) => !containedNodesData.includes(nodeData));
      data.edges = data.edges.filter((edgeData) => !containedEdgesData.includes(edgeData));
      groupNodeData.collapsedData = {
        nodes: containedNodesData.map((nodeData) => ({
          ...nodeData,
          // Store the relative position of the node to the group
          x: nodeData.x - groupNodeData.x,
          y: nodeData.y - groupNodeData.y
        })),
        edges: containedEdgesData
      };
    });
  }
};

// src/windows-manager.ts
var WindowsManager = class {
  constructor(plugin) {
    this.windows = [window];
    this.plugin = plugin;
    this.plugin.registerEvent(this.plugin.app.workspace.on(
      "window-open",
      (_win, window2) => this.windows.push(window2)
    ));
    this.plugin.registerEvent(this.plugin.app.workspace.on(
      "window-close",
      (_win, window2) => this.windows = this.windows.filter((w) => w !== window2)
    ));
  }
};

// src/canvas-extensions/canvas-wrapper-data-tagger-canvas-extension.ts
var EXPOSED_SETTINGS = [
  "collapsibleGroupsFeatureEnabled",
  "collapsedGroupPreviewOnDrag"
];
var CanvasWrapperDataTaggerCanvasExtension = class {
  constructor(plugin) {
    this.plugin = plugin;
    this.plugin.registerEvent(this.plugin.app.workspace.on(
      SettingsManager.SETTINGS_CHANGED_EVENT,
      () => this.updateExposedSettings(this.plugin.getCurrentCanvas())
    ));
    this.plugin.registerEvent(this.plugin.app.workspace.on(
      CanvasEvent.CanvasChanged,
      (canvas) => this.updateExposedSettings(canvas)
    ));
    this.plugin.registerEvent(this.plugin.app.workspace.on(
      CanvasEvent.DraggingStateChanged,
      (canvas, dragging) => {
        if (dragging)
          canvas.wrapperEl.dataset.isDragging = "true";
        else
          delete canvas.wrapperEl.dataset.isDragging;
      }
    ));
  }
  updateExposedSettings(canvas) {
    if (!canvas)
      return;
    for (const setting of EXPOSED_SETTINGS) {
      canvas.wrapperEl.dataset[setting] = this.plugin.settings.getSetting(setting).toString();
    }
  }
};

// src/canvas-extensions/properties-canvas-extension.ts
var import_obsidian8 = require("obsidian");
var PropertiesCanvasExtension = class {
  constructor(plugin) {
    this.previousCssclasses = [];
    this.plugin = plugin;
    plugin.registerEvent(plugin.app.workspace.on(
      CanvasEvent.CanvasChanged,
      (canvas) => this.onCanvasChanged(canvas)
    ));
  }
  onCanvasChanged(canvas) {
    var _a;
    this.updateCssClasses(canvas);
    const settingsContainer = (_a = canvas.quickSettingsButton) == null ? void 0 : _a.parentElement;
    if (!settingsContainer)
      return;
    addQuickSettingsButton(
      settingsContainer,
      createQuickSettingsButton({
        id: "properties",
        label: "Properties",
        icon: "settings-2",
        callback: () => this.openPropertiesDialog(canvas)
      })
    );
  }
  updateCssClasses(canvas) {
    var _a;
    this.previousCssclasses.forEach((cssclass) => {
      canvas.wrapperEl.classList.remove(cssclass);
    });
    this.previousCssclasses = ((_a = canvas.metadata.properties) == null ? void 0 : _a.cssclasses) || [];
    this.previousCssclasses.forEach((cssclass) => {
      canvas.wrapperEl.classList.add(cssclass);
    });
  }
  async openPropertiesDialog(canvas) {
    await new PropertiesModal(this.plugin.app, canvas).awaitDialog();
    this.updateCssClasses(canvas);
  }
};
var PropertiesModal = class extends import_obsidian8.Modal {
  constructor(app, canvas) {
    super(app);
    this.canvas = canvas;
  }
  onOpen() {
    new import_obsidian8.Setting(this.contentEl).setHeading().setName("Properties");
    new import_obsidian8.Setting(this.contentEl).setName("cssclasses").setTooltip("Add classes to the canvas wrapper element. Separate multiple classes with spaces.").addText(
      (text) => {
        var _a, _b;
        return text.setValue((_b = (_a = this.canvas.metadata.properties) == null ? void 0 : _a.cssclasses) == null ? void 0 : _b.join(" ")).onChange((value) => {
          this.canvas.metadata.properties = this.canvas.metadata.properties || {};
          this.canvas.metadata.properties.cssclasses = value.split(" ");
        });
      }
    ).settingEl.classList.add("properties-field");
  }
  onClose() {
  }
  awaitDialog() {
    return new Promise((resolve) => {
      this.onClose = () => {
        this.contentEl.empty();
        resolve();
      };
      this.open();
    });
  }
};

// src/main.ts
var CANVAS_EXTENSIONS = [
  CanvasWrapperDataTaggerCanvasExtension,
  NodeDataTaggerCanvasExtension,
  EdgeDataTaggerCanvasExtension,
  InteractionTaggerCanvasExtension,
  BetterDefaultSettingsCanvasExtension,
  CommandsCanvasExtension,
  PropertiesCanvasExtension,
  ReadonlyCanvasExtension,
  GroupCanvasExtension,
  CollapsibleGroupsCanvasExtension,
  EncapsulateCanvasExtension,
  ColorPaletteCanvasExtension,
  StickersCanvasExtension,
  ShapesCanvasExtension,
  EdgesStyleCanvasExtension,
  PresentationCanvasExtension,
  PortalsCanvasExtension
];
var AdvancedCanvasPlugin = class extends import_obsidian9.Plugin {
  async onload() {
    IconsHelper.addIcons();
    this.settings = new SettingsManager(this);
    await this.settings.loadSettings();
    this.settings.addSettingsTab();
    this.windowsManager = new WindowsManager(this);
    this.canvasEventEmitter = new CanvasPatcher(this);
    this.canvasExtensions = CANVAS_EXTENSIONS.map((Extension) => new Extension(this));
  }
  onunload() {
  }
  getCurrentCanvasView() {
    const canvasView = this.app.workspace.getActiveViewOfType(import_obsidian9.ItemView);
    if ((canvasView == null ? void 0 : canvasView.getViewType()) !== "canvas")
      return null;
    return canvasView;
  }
  getCurrentCanvas() {
    var _a;
    return ((_a = this.getCurrentCanvasView()) == null ? void 0 : _a.canvas) || null;
  }
  // this.app.plugins.plugins["advanced-canvas"].enableDebugMode()
  enableDebugMode() {
    if (this.debugHelper)
      return;
    this.debugHelper = new DebugHelper(this);
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsic3JjL21haW4udHMiLCAic3JjL3NldHRpbmdzLnRzIiwgInNyYy91dGlscy9jYW52YXMtaGVscGVyLnRzIiwgInNyYy91dGlscy9iYm94LWhlbHBlci50cyIsICJzcmMvY29yZS9ldmVudHMudHMiLCAic3JjL2NhbnZhcy1leHRlbnNpb25zL3NoYXBlcy1jYW52YXMtZXh0ZW5zaW9uLnRzIiwgIm5vZGVfbW9kdWxlcy9tb25rZXktYXJvdW5kL21qcy9pbmRleC5qcyIsICJzcmMvdXRpbHMvcGF0Y2gtaGVscGVyLnRzIiwgInNyYy9jb3JlL2NhbnZhcy1wYXRjaGVyLnRzIiwgInNyYy9jYW52YXMtZXh0ZW5zaW9ucy9ncm91cC1jYW52YXMtZXh0ZW5zaW9uLnRzIiwgInNyYy9jYW52YXMtZXh0ZW5zaW9ucy9wcmVzZW50YXRpb24tY2FudmFzLWV4dGVuc2lvbi50cyIsICJzcmMvY2FudmFzLWV4dGVuc2lvbnMvbm9kZS1kYXRhLXRhZ2dlci1jYW52YXMtZXh0ZW5zaW9uLnRzIiwgInNyYy9jYW52YXMtZXh0ZW5zaW9ucy9pbnRlcmFjdGlvbi10YWdnZXItY2FudmFzLWV4dGVuc2lvbi50cyIsICJzcmMvY2FudmFzLWV4dGVuc2lvbnMvcmVhZG9ubHktY2FudmFzLWV4dGVuc2lvbi50cyIsICJzcmMvdXRpbHMvbW9kYWwtaGVscGVyLnRzIiwgInNyYy91dGlscy9wYXRoLWhlbHBlci50cyIsICJzcmMvY2FudmFzLWV4dGVuc2lvbnMvZW5jYXBzdWxhdGUtY2FudmFzLWV4dGVuc2lvbi50cyIsICJzcmMvY2FudmFzLWV4dGVuc2lvbnMvY29tbWFuZHMtY2FudmFzLWV4dGVuc2lvbi50cyIsICJzcmMvY2FudmFzLWV4dGVuc2lvbnMvcG9ydGFscy1jYW52YXMtZXh0ZW5zaW9uLnRzIiwgInNyYy91dGlscy9pY29ucy1oZWxwZXIudHMiLCAic3JjL2NhbnZhcy1leHRlbnNpb25zL3N0aWNrZXJzLWNhbnZhcy1leHRlbnNpb24udHMiLCAic3JjL3V0aWxzL2Etc3Rhci1oZWxwZXIudHMiLCAic3JjL3V0aWxzL3N2Zy1wYXRoLWhlbHBlci50cyIsICJzcmMvY2FudmFzLWV4dGVuc2lvbnMvZWRnZXMtc3R5bGUtY2FudmFzLWV4dGVuc2lvbi50cyIsICJzcmMvY2FudmFzLWV4dGVuc2lvbnMvZWRnZS1kYXRhLXRhZ2dlci1jYW52YXMtZXh0ZW5zaW9uLnRzIiwgInNyYy91dGlscy9kZWJ1Zy1oZWxwZXIudHMiLCAic3JjL2NhbnZhcy1leHRlbnNpb25zL2JldHRlci1kZWZhdWx0LXNldHRpbmdzLWNhbnZhcy1leHRlbnNpb24udHMiLCAic3JjL2NhbnZhcy1leHRlbnNpb25zL2NvbG9yLXBhbGV0dGUtY2FudmFzLWV4dGVuc2lvbi50cyIsICJzcmMvY2FudmFzLWV4dGVuc2lvbnMvY29sbGFwc2libGUtZ3JvdXBzLWNhbnZhcy1leHRlbnNpb24udHMiLCAic3JjL3dpbmRvd3MtbWFuYWdlci50cyIsICJzcmMvY2FudmFzLWV4dGVuc2lvbnMvY2FudmFzLXdyYXBwZXItZGF0YS10YWdnZXItY2FudmFzLWV4dGVuc2lvbi50cyIsICJzcmMvY2FudmFzLWV4dGVuc2lvbnMvcHJvcGVydGllcy1jYW52YXMtZXh0ZW5zaW9uLnRzIl0sCiAgInNvdXJjZXNDb250ZW50IjogWyJpbXBvcnQgeyBJdGVtVmlldywgUGx1Z2luIH0gZnJvbSAnb2JzaWRpYW4nXHJcbmltcG9ydCBTZXR0aW5nc01hbmFnZXIgZnJvbSAnLi9zZXR0aW5ncydcclxuaW1wb3J0IFNoYXBlc0NhbnZhc0V4dGVuc2lvbiBmcm9tICcuL2NhbnZhcy1leHRlbnNpb25zL3NoYXBlcy1jYW52YXMtZXh0ZW5zaW9uJ1xyXG5pbXBvcnQgeyBDYW52YXMsIENhbnZhc1ZpZXcgfSBmcm9tICcuL0B0eXBlcy9DYW52YXMnXHJcbmltcG9ydCBDYW52YXNQYXRjaGVyIGZyb20gJy4vY29yZS9jYW52YXMtcGF0Y2hlcidcclxuaW1wb3J0IEdyb3VwQ2FudmFzRXh0ZW5zaW9uIGZyb20gJy4vY2FudmFzLWV4dGVuc2lvbnMvZ3JvdXAtY2FudmFzLWV4dGVuc2lvbidcclxuaW1wb3J0IFByZXNlbnRhdGlvbkNhbnZhc0V4dGVuc2lvbiBmcm9tICcuL2NhbnZhcy1leHRlbnNpb25zL3ByZXNlbnRhdGlvbi1jYW52YXMtZXh0ZW5zaW9uJ1xyXG5pbXBvcnQgSW50ZXJhY3Rpb25UYWdnZXJDYW52YXNFeHRlbnNpb24gZnJvbSAnLi9jYW52YXMtZXh0ZW5zaW9ucy9pbnRlcmFjdGlvbi10YWdnZXItY2FudmFzLWV4dGVuc2lvbidcclxuaW1wb3J0IE5vZGVEYXRhVGFnZ2VyQ2FudmFzRXh0ZW5zaW9uIGZyb20gJy4vY2FudmFzLWV4dGVuc2lvbnMvbm9kZS1kYXRhLXRhZ2dlci1jYW52YXMtZXh0ZW5zaW9uJ1xyXG5pbXBvcnQgUmVhZG9ubHlDYW52YXNFeHRlbnNpb24gZnJvbSAnLi9jYW52YXMtZXh0ZW5zaW9ucy9yZWFkb25seS1jYW52YXMtZXh0ZW5zaW9uJ1xyXG5pbXBvcnQgRW5jYXBzdWxhdGVDYW52YXNFeHRlbnNpb24gZnJvbSAnLi9jYW52YXMtZXh0ZW5zaW9ucy9lbmNhcHN1bGF0ZS1jYW52YXMtZXh0ZW5zaW9uJ1xyXG5pbXBvcnQgQ29tbWFuZHNDYW52YXNFeHRlbnNpb24gZnJvbSAnLi9jYW52YXMtZXh0ZW5zaW9ucy9jb21tYW5kcy1jYW52YXMtZXh0ZW5zaW9uJ1xyXG5pbXBvcnQgUG9ydGFsc0NhbnZhc0V4dGVuc2lvbiBmcm9tICcuL2NhbnZhcy1leHRlbnNpb25zL3BvcnRhbHMtY2FudmFzLWV4dGVuc2lvbidcclxuaW1wb3J0IEljb25zSGVscGVyIGZyb20gJy4vdXRpbHMvaWNvbnMtaGVscGVyJ1xyXG5pbXBvcnQgU3RpY2tlcnNDYW52YXNFeHRlbnNpb24gZnJvbSAnLi9jYW52YXMtZXh0ZW5zaW9ucy9zdGlja2Vycy1jYW52YXMtZXh0ZW5zaW9uJ1xyXG5pbXBvcnQgRWRnZXNTdHlsZUNhbnZhc0V4dGVuc2lvbiBmcm9tICcuL2NhbnZhcy1leHRlbnNpb25zL2VkZ2VzLXN0eWxlLWNhbnZhcy1leHRlbnNpb24nXHJcbmltcG9ydCBFZGdlRGF0YVRhZ2dlckNhbnZhc0V4dGVuc2lvbiBmcm9tICcuL2NhbnZhcy1leHRlbnNpb25zL2VkZ2UtZGF0YS10YWdnZXItY2FudmFzLWV4dGVuc2lvbidcclxuaW1wb3J0IERlYnVnSGVscGVyIGZyb20gJy4vdXRpbHMvZGVidWctaGVscGVyJ1xyXG5pbXBvcnQgQmV0dGVyRGVmYXVsdFNldHRpbmdzQ2FudmFzRXh0ZW5zaW9uIGZyb20gJy4vY2FudmFzLWV4dGVuc2lvbnMvYmV0dGVyLWRlZmF1bHQtc2V0dGluZ3MtY2FudmFzLWV4dGVuc2lvbidcclxuaW1wb3J0IENvbG9yUGFsZXR0ZUNhbnZhc0V4dGVuc2lvbiBmcm9tICcuL2NhbnZhcy1leHRlbnNpb25zL2NvbG9yLXBhbGV0dGUtY2FudmFzLWV4dGVuc2lvbidcclxuaW1wb3J0IENvbGxhcHNpYmxlR3JvdXBzQ2FudmFzRXh0ZW5zaW9uIGZyb20gJy4vY2FudmFzLWV4dGVuc2lvbnMvY29sbGFwc2libGUtZ3JvdXBzLWNhbnZhcy1leHRlbnNpb24nXHJcbmltcG9ydCBXaW5kb3dzTWFuYWdlciBmcm9tICcuL3dpbmRvd3MtbWFuYWdlcidcclxuaW1wb3J0IENhbnZhc1dyYXBwZXJEYXRhVGFnZ2VyQ2FudmFzRXh0ZW5zaW9uIGZyb20gJy4vY2FudmFzLWV4dGVuc2lvbnMvY2FudmFzLXdyYXBwZXItZGF0YS10YWdnZXItY2FudmFzLWV4dGVuc2lvbidcclxuaW1wb3J0IFByb3BlcnRpZXNDYW52YXNFeHRlbnNpb24gZnJvbSAnLi9jYW52YXMtZXh0ZW5zaW9ucy9wcm9wZXJ0aWVzLWNhbnZhcy1leHRlbnNpb24nXHJcblxyXG5jb25zdCBDQU5WQVNfRVhURU5TSU9OUzogYW55W10gPSBbXHJcbiAgQ2FudmFzV3JhcHBlckRhdGFUYWdnZXJDYW52YXNFeHRlbnNpb24sXHJcbiAgTm9kZURhdGFUYWdnZXJDYW52YXNFeHRlbnNpb24sXHJcbiAgRWRnZURhdGFUYWdnZXJDYW52YXNFeHRlbnNpb24sXHJcbiAgSW50ZXJhY3Rpb25UYWdnZXJDYW52YXNFeHRlbnNpb24sXHJcbiAgQmV0dGVyRGVmYXVsdFNldHRpbmdzQ2FudmFzRXh0ZW5zaW9uLFxyXG4gIENvbW1hbmRzQ2FudmFzRXh0ZW5zaW9uLFxyXG4gIFByb3BlcnRpZXNDYW52YXNFeHRlbnNpb24sXHJcbiAgUmVhZG9ubHlDYW52YXNFeHRlbnNpb24sXHJcbiAgR3JvdXBDYW52YXNFeHRlbnNpb24sXHJcbiAgQ29sbGFwc2libGVHcm91cHNDYW52YXNFeHRlbnNpb24sXHJcbiAgRW5jYXBzdWxhdGVDYW52YXNFeHRlbnNpb24sXHJcbiAgQ29sb3JQYWxldHRlQ2FudmFzRXh0ZW5zaW9uLFxyXG4gIFN0aWNrZXJzQ2FudmFzRXh0ZW5zaW9uLFxyXG4gIFNoYXBlc0NhbnZhc0V4dGVuc2lvbixcclxuICBFZGdlc1N0eWxlQ2FudmFzRXh0ZW5zaW9uLFxyXG4gIFByZXNlbnRhdGlvbkNhbnZhc0V4dGVuc2lvbixcclxuICBQb3J0YWxzQ2FudmFzRXh0ZW5zaW9uXHJcbl1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEFkdmFuY2VkQ2FudmFzUGx1Z2luIGV4dGVuZHMgUGx1Z2luIHtcclxuICBzZXR0aW5nczogU2V0dGluZ3NNYW5hZ2VyXHJcbiAgd2luZG93c01hbmFnZXI6IFdpbmRvd3NNYW5hZ2VyXHJcbiAgZGVidWdIZWxwZXI6IERlYnVnSGVscGVyXHJcblxyXG4gIGNhbnZhc0V2ZW50RW1pdHRlcjogQ2FudmFzUGF0Y2hlclxyXG4gIGNhbnZhc0V4dGVuc2lvbnM6IGFueVtdXHJcblxyXG5cdGFzeW5jIG9ubG9hZCgpIHtcclxuICAgIEljb25zSGVscGVyLmFkZEljb25zKClcclxuICAgIFxyXG4gICAgdGhpcy5zZXR0aW5ncyA9IG5ldyBTZXR0aW5nc01hbmFnZXIodGhpcylcclxuICAgIGF3YWl0IHRoaXMuc2V0dGluZ3MubG9hZFNldHRpbmdzKClcclxuICAgIHRoaXMuc2V0dGluZ3MuYWRkU2V0dGluZ3NUYWIoKVxyXG5cclxuICAgIHRoaXMud2luZG93c01hbmFnZXIgPSBuZXcgV2luZG93c01hbmFnZXIodGhpcylcclxuXHJcbiAgICB0aGlzLmNhbnZhc0V2ZW50RW1pdHRlciA9IG5ldyBDYW52YXNQYXRjaGVyKHRoaXMpXHJcbiAgICB0aGlzLmNhbnZhc0V4dGVuc2lvbnMgPSBDQU5WQVNfRVhURU5TSU9OUy5tYXAoKEV4dGVuc2lvbikgPT4gbmV3IEV4dGVuc2lvbih0aGlzKSlcclxuXHR9XHJcblxyXG4gIG9udW5sb2FkKCkge31cclxuXHJcbiAgZ2V0Q3VycmVudENhbnZhc1ZpZXcoKTogQ2FudmFzVmlld3xudWxsIHtcclxuICAgIGNvbnN0IGNhbnZhc1ZpZXcgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlVmlld09mVHlwZShJdGVtVmlldylcclxuICAgIGlmIChjYW52YXNWaWV3Py5nZXRWaWV3VHlwZSgpICE9PSAnY2FudmFzJykgcmV0dXJuIG51bGxcclxuICAgIHJldHVybiBjYW52YXNWaWV3IGFzIENhbnZhc1ZpZXdcclxuICB9XHJcblxyXG4gIGdldEN1cnJlbnRDYW52YXMoKTogQ2FudmFzfG51bGwge1xyXG4gICAgcmV0dXJuIHRoaXMuZ2V0Q3VycmVudENhbnZhc1ZpZXcoKT8uY2FudmFzIHx8IG51bGxcclxuICB9XHJcblxyXG4gIC8vIHRoaXMuYXBwLnBsdWdpbnMucGx1Z2luc1tcImFkdmFuY2VkLWNhbnZhc1wiXS5lbmFibGVEZWJ1Z01vZGUoKVxyXG4gIGVuYWJsZURlYnVnTW9kZSgpIHtcclxuICAgIGlmICh0aGlzLmRlYnVnSGVscGVyKSByZXR1cm5cclxuICAgIHRoaXMuZGVidWdIZWxwZXIgPSBuZXcgRGVidWdIZWxwZXIodGhpcylcclxuICB9XHJcbn0iLCAiaW1wb3J0IHsgTm90aWNlLCBQbHVnaW5TZXR0aW5nVGFiLCBTZXR0aW5nIH0gZnJvbSBcIm9ic2lkaWFuXCJcclxuaW1wb3J0IEFkdmFuY2VkQ2FudmFzUGx1Z2luIGZyb20gXCIuL21haW5cIlxyXG5cclxuY29uc3QgTk9ERV9UWVBFU19PTl9ET1VCTEVfQ0xJQ0sgPSB7XHJcbiAgJ3RleHQnOiAnVGV4dCcsXHJcbiAgJ2ZpbGUnOiAnRmlsZSdcclxufVxyXG5cclxuZXhwb3J0IGludGVyZmFjZSBBZHZhbmNlZENhbnZhc1BsdWdpblNldHRpbmdzIHtcclxuICBub2RlVHlwZU9uRG91YmxlQ2xpY2s6IHN0cmluZ1xyXG4gIGRlZmF1bHRUZXh0Tm9kZVdpZHRoOiBudW1iZXJcclxuICBkZWZhdWx0VGV4dE5vZGVIZWlnaHQ6IG51bWJlclxyXG4gIGRlZmF1bHRGaWxlTm9kZVdpZHRoOiBudW1iZXJcclxuICBkZWZhdWx0RmlsZU5vZGVIZWlnaHQ6IG51bWJlclxyXG5cclxuICBzaGFwZXNGZWF0dXJlRW5hYmxlZDogYm9vbGVhblxyXG5cclxuICBlZGdlc1N0eWxpbmdGZWF0dXJlRW5hYmxlZDogYm9vbGVhblxyXG4gIGVkZ2VTdHlsZVBhdGhmaW5kZXJHcmlkUmVzb2x1dGlvbjogbnVtYmVyXHJcbiAgZWRnZVN0eWxlUGF0aGZpbmRlclBhdGhMaXZlVXBkYXRlOiBib29sZWFuXHJcbiAgZWRnZVN0eWxlUGF0aGZpbmRlclBhdGhSb3VuZGVkOiBib29sZWFuXHJcblxyXG4gIGNvbW1hbmRzRmVhdHVyZUVuYWJsZWQ6IGJvb2xlYW5cclxuICB6b29tVG9DbG9uZWROb2RlOiBib29sZWFuXHJcbiAgY2xvbmVOb2RlTWFyZ2luOiBudW1iZXJcclxuICBleHBhbmROb2RlU3RlcFNpemU6IG51bWJlclxyXG5cclxuICBiZXR0ZXJSZWFkb25seUVuYWJsZWQ6IGJvb2xlYW5cclxuICBkaXNhYmxlTm9kZVBvcHVwOiBib29sZWFuXHJcbiAgZGlzYWJsZVpvb206IGJvb2xlYW5cclxuICBkaXNhYmxlUGFuOiBib29sZWFuXHJcblxyXG4gIGNvbGxhcHNpYmxlR3JvdXBzRmVhdHVyZUVuYWJsZWQ6IGJvb2xlYW5cclxuICBjb2xsYXBzZWRHcm91cFByZXZpZXdPbkRyYWc6IGJvb2xlYW5cclxuXHJcbiAgc3RpY2tlcnNGZWF0dXJlRW5hYmxlZDogYm9vbGVhblxyXG5cclxuICBwcmVzZW50YXRpb25GZWF0dXJlRW5hYmxlZDogYm9vbGVhblxyXG4gIGRlZmF1bHRTbGlkZVNpemU6IHN0cmluZ1xyXG4gIHdyYXBJblNsaWRlUGFkZGluZzogbnVtYmVyXHJcbiAgdXNlQXJyb3dLZXlzVG9DaGFuZ2VTbGlkZXM6IGJvb2xlYW5cclxuICB6b29tVG9TbGlkZVdpdGhvdXRQYWRkaW5nOiBib29sZWFuXHJcbiAgc2xpZGVUcmFuc2l0aW9uQW5pbWF0aW9uRHVyYXRpb246IG51bWJlclxyXG4gIHNsaWRlVHJhbnNpdGlvbkFuaW1hdGlvbkludGVuc2l0eTogbnVtYmVyXHJcblxyXG4gIGNhbnZhc0VuY2Fwc3VsYXRpb25FbmFibGVkOiBib29sZWFuXHJcblxyXG4gIHBvcnRhbHNGZWF0dXJlRW5hYmxlZDogYm9vbGVhblxyXG4gIG1haW50YWluQ2xvc2VkUG9ydGFsU2l6ZTogYm9vbGVhblxyXG4gIHNob3dFZGdlc0ludG9EaXNhYmxlZFBvcnRhbHM6IGJvb2xlYW5cclxufVxyXG5cclxuZXhwb3J0IGNvbnN0IERFRkFVTFRfU0VUVElOR1M6IFBhcnRpYWw8QWR2YW5jZWRDYW52YXNQbHVnaW5TZXR0aW5ncz4gPSB7XHJcbiAgbm9kZVR5cGVPbkRvdWJsZUNsaWNrOiBPYmplY3Qua2V5cyhOT0RFX1RZUEVTX09OX0RPVUJMRV9DTElDSykuZmlyc3QoKSxcclxuICBkZWZhdWx0VGV4dE5vZGVXaWR0aDogMjYwLFxyXG4gIGRlZmF1bHRUZXh0Tm9kZUhlaWdodDogNjAsXHJcbiAgZGVmYXVsdEZpbGVOb2RlV2lkdGg6IDQwMCxcclxuICBkZWZhdWx0RmlsZU5vZGVIZWlnaHQ6IDQwMCxcclxuXHJcbiAgc2hhcGVzRmVhdHVyZUVuYWJsZWQ6IHRydWUsXHJcblxyXG4gIGVkZ2VzU3R5bGluZ0ZlYXR1cmVFbmFibGVkOiB0cnVlLFxyXG4gIGVkZ2VTdHlsZVBhdGhmaW5kZXJHcmlkUmVzb2x1dGlvbjogMTAsXHJcbiAgZWRnZVN0eWxlUGF0aGZpbmRlclBhdGhMaXZlVXBkYXRlOiB0cnVlLFxyXG4gIGVkZ2VTdHlsZVBhdGhmaW5kZXJQYXRoUm91bmRlZDogdHJ1ZSxcclxuXHJcbiAgY29tbWFuZHNGZWF0dXJlRW5hYmxlZDogdHJ1ZSxcclxuICB6b29tVG9DbG9uZWROb2RlOiB0cnVlLFxyXG4gIGNsb25lTm9kZU1hcmdpbjogMjAsXHJcbiAgZXhwYW5kTm9kZVN0ZXBTaXplOiAyMCxcclxuXHJcbiAgYmV0dGVyUmVhZG9ubHlFbmFibGVkOiB0cnVlLFxyXG4gIGRpc2FibGVOb2RlUG9wdXA6IGZhbHNlLFxyXG4gIGRpc2FibGVab29tOiBmYWxzZSxcclxuICBkaXNhYmxlUGFuOiBmYWxzZSxcclxuXHJcbiAgY29sbGFwc2libGVHcm91cHNGZWF0dXJlRW5hYmxlZDogdHJ1ZSxcclxuICBjb2xsYXBzZWRHcm91cFByZXZpZXdPbkRyYWc6IHRydWUsXHJcblxyXG4gIHN0aWNrZXJzRmVhdHVyZUVuYWJsZWQ6IHRydWUsXHJcblxyXG4gIHByZXNlbnRhdGlvbkZlYXR1cmVFbmFibGVkOiB0cnVlLFxyXG4gIGRlZmF1bHRTbGlkZVNpemU6ICcxMjAweDY3NScsXHJcbiAgd3JhcEluU2xpZGVQYWRkaW5nOiAyMCxcclxuICB1c2VBcnJvd0tleXNUb0NoYW5nZVNsaWRlczogdHJ1ZSxcclxuICB6b29tVG9TbGlkZVdpdGhvdXRQYWRkaW5nOiB0cnVlLFxyXG4gIHNsaWRlVHJhbnNpdGlvbkFuaW1hdGlvbkR1cmF0aW9uOiAwLjUsXHJcbiAgc2xpZGVUcmFuc2l0aW9uQW5pbWF0aW9uSW50ZW5zaXR5OiAxLjI1LFxyXG5cclxuICBjYW52YXNFbmNhcHN1bGF0aW9uRW5hYmxlZDogdHJ1ZSxcclxuXHJcbiAgcG9ydGFsc0ZlYXR1cmVFbmFibGVkOiB0cnVlLFxyXG4gIG1haW50YWluQ2xvc2VkUG9ydGFsU2l6ZTogdHJ1ZSxcclxuICBzaG93RWRnZXNJbnRvRGlzYWJsZWRQb3J0YWxzOiB0cnVlXHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFNldHRpbmdzTWFuYWdlciB7XHJcbiAgc3RhdGljIFNFVFRJTkdTX0NIQU5HRURfRVZFTlQgPSAnYWR2YW5jZWQtY2FudmFzOnNldHRpbmdzLWNoYW5nZWQnXHJcblxyXG4gIHByaXZhdGUgcGx1Z2luOiBBZHZhbmNlZENhbnZhc1BsdWdpblxyXG4gIHByaXZhdGUgc2V0dGluZ3M6IEFkdmFuY2VkQ2FudmFzUGx1Z2luU2V0dGluZ3NcclxuICBwcml2YXRlIHNldHRpbmdzVGFiOiBBZHZhbmNlZENhbnZhc1BsdWdpblNldHRpbmdUYWJcclxuXHJcbiAgY29uc3RydWN0b3IocGx1Z2luOiBBZHZhbmNlZENhbnZhc1BsdWdpbikge1xyXG4gICAgdGhpcy5wbHVnaW4gPSBwbHVnaW5cclxuICB9XHJcblxyXG4gIGFzeW5jIGxvYWRTZXR0aW5ncygpIHtcclxuICAgIHRoaXMuc2V0dGluZ3MgPSBPYmplY3QuYXNzaWduKHt9LCBERUZBVUxUX1NFVFRJTkdTLCBhd2FpdCB0aGlzLnBsdWdpbi5sb2FkRGF0YSgpKVxyXG4gICAgdGhpcy5wbHVnaW4uYXBwLndvcmtzcGFjZS50cmlnZ2VyKFNldHRpbmdzTWFuYWdlci5TRVRUSU5HU19DSEFOR0VEX0VWRU5UKVxyXG4gIH1cclxuXHJcbiAgYXN5bmMgc2F2ZVNldHRpbmdzKCkge1xyXG4gICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZURhdGEodGhpcy5zZXR0aW5ncylcclxuICB9XHJcblxyXG4gIGdldFNldHRpbmc8VCBleHRlbmRzIGtleW9mIEFkdmFuY2VkQ2FudmFzUGx1Z2luU2V0dGluZ3M+KGtleTogVCk6IEFkdmFuY2VkQ2FudmFzUGx1Z2luU2V0dGluZ3NbVF0ge1xyXG4gICAgcmV0dXJuIHRoaXMuc2V0dGluZ3Nba2V5XVxyXG4gIH1cclxuXHJcbiAgYXN5bmMgc2V0U2V0dGluZyhkYXRhOiBQYXJ0aWFsPEFkdmFuY2VkQ2FudmFzUGx1Z2luU2V0dGluZ3M+KSB7XHJcbiAgICB0aGlzLnNldHRpbmdzID0gT2JqZWN0LmFzc2lnbih0aGlzLnNldHRpbmdzLCBkYXRhKVxyXG4gICAgYXdhaXQgdGhpcy5zYXZlU2V0dGluZ3MoKVxyXG4gICAgdGhpcy5wbHVnaW4uYXBwLndvcmtzcGFjZS50cmlnZ2VyKFNldHRpbmdzTWFuYWdlci5TRVRUSU5HU19DSEFOR0VEX0VWRU5UKVxyXG4gIH1cclxuXHJcbiAgYWRkU2V0dGluZ3NUYWIoKSB7XHJcbiAgICB0aGlzLnNldHRpbmdzVGFiID0gbmV3IEFkdmFuY2VkQ2FudmFzUGx1Z2luU2V0dGluZ1RhYih0aGlzLnBsdWdpbiwgdGhpcylcclxuICAgIHRoaXMucGx1Z2luLmFkZFNldHRpbmdUYWIodGhpcy5zZXR0aW5nc1RhYilcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBjbGFzcyBBZHZhbmNlZENhbnZhc1BsdWdpblNldHRpbmdUYWIgZXh0ZW5kcyBQbHVnaW5TZXR0aW5nVGFiIHtcclxuICBzZXR0aW5nc01hbmFnZXI6IFNldHRpbmdzTWFuYWdlclxyXG5cclxuICBjb25zdHJ1Y3RvcihwbHVnaW46IEFkdmFuY2VkQ2FudmFzUGx1Z2luLCBzZXR0aW5nc01hbmFnZXI6IFNldHRpbmdzTWFuYWdlcikge1xyXG4gICAgc3VwZXIocGx1Z2luLmFwcCwgcGx1Z2luKVxyXG4gICAgdGhpcy5zZXR0aW5nc01hbmFnZXIgPSBzZXR0aW5nc01hbmFnZXJcclxuICB9XHJcblxyXG4gIGRpc3BsYXkoKTogdm9pZCB7XHJcbiAgICBsZXQgeyBjb250YWluZXJFbCB9ID0gdGhpc1xyXG4gICAgY29udGFpbmVyRWwuZW1wdHkoKVxyXG5cclxuICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxyXG4gICAgICAuc2V0SGVhZGluZygpXHJcbiAgICAgIC5zZXROYW1lKFwiR2VuZXJhbFwiKVxyXG5cclxuICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxyXG4gICAgICAuc2V0TmFtZShcIk5vZGUgdHlwZSBvbiBkb3VibGUgY2xpY2tcIilcclxuICAgICAgLnNldERlc2MoXCJUaGUgdHlwZSBvZiBub2RlIHRoYXQgd2lsbCBiZSBjcmVhdGVkIHdoZW4gZG91YmxlIGNsaWNraW5nIG9uIHRoZSBjYW52YXMuXCIpXHJcbiAgICAgIC5hZGREcm9wZG93bigoZHJvcGRvd24pID0+XHJcbiAgICAgICAgZHJvcGRvd25cclxuICAgICAgICAgIC5hZGRPcHRpb25zKE5PREVfVFlQRVNfT05fRE9VQkxFX0NMSUNLKVxyXG4gICAgICAgICAgLnNldFZhbHVlKHRoaXMuc2V0dGluZ3NNYW5hZ2VyLmdldFNldHRpbmcoJ25vZGVUeXBlT25Eb3VibGVDbGljaycpKVxyXG4gICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4gYXdhaXQgdGhpcy5zZXR0aW5nc01hbmFnZXIuc2V0U2V0dGluZyh7IG5vZGVUeXBlT25Eb3VibGVDbGljazogdmFsdWUgfSkpXHJcbiAgICAgICAgKVxyXG4gICAgXHJcbiAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcclxuICAgICAgLnNldE5hbWUoXCJEZWZhdWx0IHRleHQgbm9kZSB3aWR0aFwiKVxyXG4gICAgICAuc2V0RGVzYyhcIlRoZSBkZWZhdWx0IHdpZHRoIG9mIGEgdGV4dCBub2RlLlwiKVxyXG4gICAgICAuYWRkVGV4dCgodGV4dCkgPT5cclxuICAgICAgICB0ZXh0XHJcbiAgICAgICAgICAuc2V0VmFsdWUodGhpcy5zZXR0aW5nc01hbmFnZXIuZ2V0U2V0dGluZygnZGVmYXVsdFRleHROb2RlV2lkdGgnKS50b1N0cmluZygpKVxyXG4gICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4gYXdhaXQgdGhpcy5zZXR0aW5nc01hbmFnZXIuc2V0U2V0dGluZyh7IGRlZmF1bHRUZXh0Tm9kZVdpZHRoOiBNYXRoLm1heCgxLCBwYXJzZUludCh2YWx1ZSkpIH0pKVxyXG4gICAgICApXHJcbiAgICBcclxuICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxyXG4gICAgICAuc2V0TmFtZShcIkRlZmF1bHQgdGV4dCBub2RlIGhlaWdodFwiKVxyXG4gICAgICAuc2V0RGVzYyhcIlRoZSBkZWZhdWx0IGhlaWdodCBvZiBhIHRleHQgbm9kZS5cIilcclxuICAgICAgLmFkZFRleHQoKHRleHQpID0+XHJcbiAgICAgICAgdGV4dFxyXG4gICAgICAgICAgLnNldFZhbHVlKHRoaXMuc2V0dGluZ3NNYW5hZ2VyLmdldFNldHRpbmcoJ2RlZmF1bHRUZXh0Tm9kZUhlaWdodCcpLnRvU3RyaW5nKCkpXHJcbiAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiBhd2FpdCB0aGlzLnNldHRpbmdzTWFuYWdlci5zZXRTZXR0aW5nKHsgZGVmYXVsdFRleHROb2RlSGVpZ2h0OiBNYXRoLm1heCgxLCBwYXJzZUludCh2YWx1ZSkpIH0pKVxyXG4gICAgICApXHJcblxyXG4gICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXHJcbiAgICAgIC5zZXROYW1lKFwiRGVmYXVsdCBmaWxlIG5vZGUgd2lkdGhcIilcclxuICAgICAgLnNldERlc2MoXCJUaGUgZGVmYXVsdCB3aWR0aCBvZiBhIGZpbGUgbm9kZS5cIilcclxuICAgICAgLmFkZFRleHQoKHRleHQpID0+XHJcbiAgICAgICAgdGV4dFxyXG4gICAgICAgICAgLnNldFZhbHVlKHRoaXMuc2V0dGluZ3NNYW5hZ2VyLmdldFNldHRpbmcoJ2RlZmF1bHRGaWxlTm9kZVdpZHRoJykudG9TdHJpbmcoKSlcclxuICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IGF3YWl0IHRoaXMuc2V0dGluZ3NNYW5hZ2VyLnNldFNldHRpbmcoeyBkZWZhdWx0RmlsZU5vZGVXaWR0aDogTWF0aC5tYXgoMSwgcGFyc2VJbnQodmFsdWUpKSB9KSlcclxuICAgICAgKVxyXG5cclxuICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxyXG4gICAgICAuc2V0TmFtZShcIkRlZmF1bHQgZmlsZSBub2RlIGhlaWdodFwiKVxyXG4gICAgICAuc2V0RGVzYyhcIlRoZSBkZWZhdWx0IGhlaWdodCBvZiBhIGZpbGUgbm9kZS5cIilcclxuICAgICAgLmFkZFRleHQoKHRleHQpID0+XHJcbiAgICAgICAgdGV4dFxyXG4gICAgICAgICAgLnNldFZhbHVlKHRoaXMuc2V0dGluZ3NNYW5hZ2VyLmdldFNldHRpbmcoJ2RlZmF1bHRGaWxlTm9kZUhlaWdodCcpLnRvU3RyaW5nKCkpXHJcbiAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiBhd2FpdCB0aGlzLnNldHRpbmdzTWFuYWdlci5zZXRTZXR0aW5nKHsgZGVmYXVsdEZpbGVOb2RlSGVpZ2h0OiBNYXRoLm1heCgxLCBwYXJzZUludCh2YWx1ZSkpIH0pKVxyXG4gICAgICApXHJcblxyXG4gICAgdGhpcy5jcmVhdGVGZWF0dXJlSGVhZGluZyhcclxuICAgICAgY29udGFpbmVyRWwsXHJcbiAgICAgIFwiU2hhcGVzXCIsXHJcbiAgICAgIFwiU2hhcGUgeW91ciBub2RlcyBmb3IgY3JlYXRpbmcgZS5nLiBtaW5kIG1hcHMgb3IgZmxvdyBjaGFydHMuXCIsXHJcbiAgICAgICdzaGFwZXNGZWF0dXJlRW5hYmxlZCdcclxuICAgIClcclxuXHJcbiAgICB0aGlzLmNyZWF0ZUZlYXR1cmVIZWFkaW5nKFxyXG4gICAgICBjb250YWluZXJFbCxcclxuICAgICAgXCJFZGdlcyBzdHlsaW5nXCIsXHJcbiAgICAgIFwiU3R5bGUgeW91ciBlZGdlcyB3aXRoIGRpZmZlcmVudCBwYXRoIHN0eWxlcy5cIixcclxuICAgICAgJ2VkZ2VzU3R5bGluZ0ZlYXR1cmVFbmFibGVkJ1xyXG4gICAgKVxyXG5cclxuICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxyXG4gICAgICAuc2V0TmFtZShcIkEqIGdyaWQgcmVzb2x1dGlvblwiKVxyXG4gICAgICAuc2V0RGVzYyhcIlRoZSByZXNvbHV0aW9uIG9mIHRoZSBncmlkIHdoZW4gdXNpbmcgdGhlIEEqIHBhdGggc3R5bGUuIFRoZSBsb3dlciB0aGUgdmFsdWUsIHRoZSBtb3JlIHByZWNpc2UgdGhlIHBhdGggd2lsbCBiZS4gQnV0IGl0IHdpbGwgYWxzbyB0YWtlIGxvbmdlciB0byBjYWxjdWxhdGUuXCIpXHJcbiAgICAgIC5hZGRUZXh0KCh0ZXh0KSA9PlxyXG4gICAgICAgIHRleHRcclxuICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnNldHRpbmdzTWFuYWdlci5nZXRTZXR0aW5nKCdlZGdlU3R5bGVQYXRoZmluZGVyR3JpZFJlc29sdXRpb24nKS50b1N0cmluZygpKVxyXG4gICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4gYXdhaXQgdGhpcy5zZXR0aW5nc01hbmFnZXIuc2V0U2V0dGluZyh7IGVkZ2VTdHlsZVBhdGhmaW5kZXJHcmlkUmVzb2x1dGlvbjogTWF0aC5tYXgoNSwgcGFyc2VJbnQodmFsdWUpKSB9KSlcclxuICAgICAgKVxyXG5cclxuICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxyXG4gICAgICAuc2V0TmFtZShcIkxpdmUgdXBkYXRlIEEqIHBhdGhcIilcclxuICAgICAgLnNldERlc2MoXCJXaGVuIGVuYWJsZWQsIHRoZSBBKiBwYXRoIHN0eWxlIHdpbGwgYmUgdXBkYXRlZCBsaXZlIHdoaWxlIGRyYWdnaW5nIHRoZSBlZGdlLlwiKVxyXG4gICAgICAuYWRkVG9nZ2xlKCh0b2dnbGUpID0+XHJcbiAgICAgICAgdG9nZ2xlXHJcbiAgICAgICAgICAuc2V0VmFsdWUodGhpcy5zZXR0aW5nc01hbmFnZXIuZ2V0U2V0dGluZygnZWRnZVN0eWxlUGF0aGZpbmRlclBhdGhMaXZlVXBkYXRlJykpXHJcbiAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiBhd2FpdCB0aGlzLnNldHRpbmdzTWFuYWdlci5zZXRTZXR0aW5nKHsgZWRnZVN0eWxlUGF0aGZpbmRlclBhdGhMaXZlVXBkYXRlOiB2YWx1ZSB9KSlcclxuICAgICAgKVxyXG5cclxuICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxyXG4gICAgICAuc2V0TmFtZShcIkEqIHJvdW5kZWQgcGF0aFwiKVxyXG4gICAgICAuc2V0RGVzYyhcIldoZW4gZW5hYmxlZCwgdGhlIEEqIHBhdGggc3R5bGUgd2lsbCBiZSByb3VuZGVkLlwiKVxyXG4gICAgICAuYWRkVG9nZ2xlKCh0b2dnbGUpID0+XHJcbiAgICAgICAgdG9nZ2xlXHJcbiAgICAgICAgICAuc2V0VmFsdWUodGhpcy5zZXR0aW5nc01hbmFnZXIuZ2V0U2V0dGluZygnZWRnZVN0eWxlUGF0aGZpbmRlclBhdGhSb3VuZGVkJykpXHJcbiAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiBhd2FpdCB0aGlzLnNldHRpbmdzTWFuYWdlci5zZXRTZXR0aW5nKHsgZWRnZVN0eWxlUGF0aGZpbmRlclBhdGhSb3VuZGVkOiB2YWx1ZSB9KSlcclxuICAgICAgKVxyXG5cclxuICAgIHRoaXMuY3JlYXRlRmVhdHVyZUhlYWRpbmcoXHJcbiAgICAgIGNvbnRhaW5lckVsLFxyXG4gICAgICBcIkV4dGVuZGVkIGNvbW1hbmRzXCIsXHJcbiAgICAgIFwiQWRkIG1vcmUgY29tbWFuZHMgdG8gdGhlIGNhbnZhcy5cIixcclxuICAgICAgJ2NvbW1hbmRzRmVhdHVyZUVuYWJsZWQnXHJcbiAgICApXHJcblxyXG4gICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXHJcbiAgICAgIC5zZXROYW1lKFwiWm9vbSB0byBjbG9uZWQgbm9kZVwiKVxyXG4gICAgICAuc2V0RGVzYyhcIldoZW4gZW5hYmxlZCwgdGhlIGNhbnZhcyB3aWxsIHpvb20gdG8gdGhlIGNsb25lZCBub2RlLlwiKVxyXG4gICAgICAuYWRkVG9nZ2xlKCh0b2dnbGUpID0+XHJcbiAgICAgICAgdG9nZ2xlXHJcbiAgICAgICAgICAuc2V0VmFsdWUodGhpcy5zZXR0aW5nc01hbmFnZXIuZ2V0U2V0dGluZygnem9vbVRvQ2xvbmVkTm9kZScpKVxyXG4gICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4gYXdhaXQgdGhpcy5zZXR0aW5nc01hbmFnZXIuc2V0U2V0dGluZyh7IHpvb21Ub0Nsb25lZE5vZGU6IHZhbHVlIH0pKVxyXG4gICAgICApXHJcblxyXG4gICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXHJcbiAgICAgIC5zZXROYW1lKFwiQ2xvbmUgbm9kZSBtYXJnaW5cIilcclxuICAgICAgLnNldERlc2MoXCJUaGUgbWFyZ2luIGJldHdlZW4gdGhlIGNsb25lZCBub2RlIGFuZCB0aGUgc291cmNlIG5vZGUuXCIpXHJcbiAgICAgIC5hZGRUZXh0KCh0ZXh0KSA9PlxyXG4gICAgICAgIHRleHRcclxuICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnNldHRpbmdzTWFuYWdlci5nZXRTZXR0aW5nKCdjbG9uZU5vZGVNYXJnaW4nKS50b1N0cmluZygpKVxyXG4gICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4gYXdhaXQgdGhpcy5zZXR0aW5nc01hbmFnZXIuc2V0U2V0dGluZyh7IGNsb25lTm9kZU1hcmdpbjogcGFyc2VJbnQodmFsdWUpIH0pKVxyXG4gICAgICApXHJcblxyXG4gICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXHJcbiAgICAgIC5zZXROYW1lKFwiRXhwYW5kIG5vZGUgc3RlcCBzaXplXCIpXHJcbiAgICAgIC5zZXREZXNjKFwiVGhlIHN0ZXAgc2l6ZSBmb3IgZXhwYW5kaW5nIHRoZSBub2RlLlwiKVxyXG4gICAgICAuYWRkVGV4dCgodGV4dCkgPT5cclxuICAgICAgICB0ZXh0XHJcbiAgICAgICAgICAuc2V0VmFsdWUodGhpcy5zZXR0aW5nc01hbmFnZXIuZ2V0U2V0dGluZygnZXhwYW5kTm9kZVN0ZXBTaXplJykudG9TdHJpbmcoKSlcclxuICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IGF3YWl0IHRoaXMuc2V0dGluZ3NNYW5hZ2VyLnNldFNldHRpbmcoeyBleHBhbmROb2RlU3RlcFNpemU6IHBhcnNlSW50KHZhbHVlKSB9KSlcclxuICAgICAgKVxyXG5cclxuICAgIHRoaXMuY3JlYXRlRmVhdHVyZUhlYWRpbmcoXHJcbiAgICAgIGNvbnRhaW5lckVsLFxyXG4gICAgICBcIkJldHRlciByZWFkb25seVwiLFxyXG4gICAgICBcIkltcHJvdmUgdGhlIHJlYWRvbmx5IG1vZGUuXCIsXHJcbiAgICAgICdiZXR0ZXJSZWFkb25seUVuYWJsZWQnXHJcbiAgICApXHJcblxyXG4gICAgLyogV291bGQgcmVxdWlyZSBhIHNvbHV0aW9uIHRvIHN5bmMgdGhlIHNldHRpbmdzIHdpdGggdGhlIGNhbnZhcyAqL1xyXG4gICAgLypuZXcgU2V0dGluZyhjb250YWluZXJFbClcclxuICAgICAgLnNldE5hbWUoXCJEaXNhYmxlIG5vZGUgaW50ZXJhY3Rpb25cIilcclxuICAgICAgLnNldERlc2MoXCJXaGVuIGVuYWJsZWQsIHlvdSBjYW4ndCBpbnRlcmFjdCB3aXRoIHRoZSBub2RlcyB3aGVuIGluIHJlYWRvbmx5IG1vZGUuXCIpXHJcbiAgICAgIC5hZGRUb2dnbGUoKHRvZ2dsZSkgPT5cclxuICAgICAgICB0b2dnbGVcclxuICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnNldHRpbmdzTWFuYWdlci5zZXR0aW5ncy5kaXNhYmxlTm9kZUludGVyYWN0aW9uKVxyXG4gICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4gYXdhaXQgdGhpcy5zZXR0aW5nc01hbmFnZXIuc2V0U2V0dGluZyh7IGRpc2FibGVOb2RlSW50ZXJhY3Rpb246IHZhbHVlIH0pKVxyXG4gICAgICApXHJcblxyXG4gICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXHJcbiAgICAgIC5zZXROYW1lKFwiRGlzYWJsZSBub2RlIHBvcHVwIG1lbnVcIilcclxuICAgICAgLnNldERlc2MoXCJXaGVuIGVuYWJsZWQsIHRoZSBub2RlIHBvcHVwIG1lbnUgd29uJ3Qgc2hvdyB3aGVuIGluIHJlYWRvbmx5IG1vZGUuIChJZiBub2RlIGludGVyYWN0aW9uIGlzIGRpc2FibGVkLCB0aGlzIHNldHRpbmcgaGFzIG5vIGVmZmVjdC4pXCIpXHJcbiAgICAgIC5hZGRUb2dnbGUoKHRvZ2dsZSkgPT5cclxuICAgICAgICB0b2dnbGVcclxuICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnNldHRpbmdzTWFuYWdlci5zZXR0aW5ncy5kaXNhYmxlTm9kZVBvcHVwKVxyXG4gICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4gYXdhaXQgdGhpcy5zZXR0aW5nc01hbmFnZXIuc2V0U2V0dGluZyh7IGRpc2FibGVOb2RlUG9wdXA6IHZhbHVlIH0pKVxyXG4gICAgICApXHJcblxyXG4gICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXHJcbiAgICAgIC5zZXROYW1lKFwiRGlzYWJsZSB6b29tXCIpXHJcbiAgICAgIC5zZXREZXNjKFwiV2hlbiBlbmFibGVkLCB5b3UgY2FuJ3Qgem9vbSB3aGVuIGluIHJlYWRvbmx5IG1vZGUuXCIpXHJcbiAgICAgIC5hZGRUb2dnbGUoKHRvZ2dsZSkgPT5cclxuICAgICAgICB0b2dnbGVcclxuICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnNldHRpbmdzTWFuYWdlci5zZXR0aW5ncy5kaXNhYmxlWm9vbSlcclxuICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IGF3YWl0IHRoaXMuc2V0dGluZ3NNYW5hZ2VyLnNldFNldHRpbmcoeyBkaXNhYmxlWm9vbTogdmFsdWUgfSkpXHJcbiAgICAgIClcclxuXHJcbiAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcclxuICAgICAgLnNldE5hbWUoXCJEaXNhYmxlIHBhblwiKVxyXG4gICAgICAuc2V0RGVzYyhcIldoZW4gZW5hYmxlZCwgeW91IGNhbid0IHBhbiB3aGVuIGluIHJlYWRvbmx5IG1vZGUuXCIpXHJcbiAgICAgIC5hZGRUb2dnbGUoKHRvZ2dsZSkgPT5cclxuICAgICAgICB0b2dnbGVcclxuICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnNldHRpbmdzTWFuYWdlci5zZXR0aW5ncy5kaXNhYmxlUGFuKVxyXG4gICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4gYXdhaXQgdGhpcy5zZXR0aW5nc01hbmFnZXIuc2V0U2V0dGluZyh7IGRpc2FibGVQYW46IHZhbHVlIH0pKVxyXG4gICAgICApKi9cclxuXHJcbiAgICB0aGlzLmNyZWF0ZUZlYXR1cmVIZWFkaW5nKFxyXG4gICAgICBjb250YWluZXJFbCxcclxuICAgICAgXCJDb2xsYXBzaWJsZSBncm91cHNcIixcclxuICAgICAgXCJHcm91cCBub2RlcyBjYW4gYmUgY29sbGFwc2VkIGFuZCBleHBhbmRlZCB0byBrZWVwIHRoZSBjYW52YXMgb3JnYW5pemVkLlwiLFxyXG4gICAgICAnY29sbGFwc2libGVHcm91cHNGZWF0dXJlRW5hYmxlZCdcclxuICAgIClcclxuXHJcbiAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcclxuICAgICAgLnNldE5hbWUoXCJDb2xsYXBzZWQgZ3JvdXAgcHJldmlldyBvbiBkcmFnXCIpXHJcbiAgICAgIC5zZXREZXNjKFwiV2hlbiBlbmFibGVkLCBhIGdyb3VwIHRoYXQgaXMgY29sbGFwc2VkIHNob3cgaXRzIGJvcmRlciB3aGlsZSBkcmFnZ2luZyBhIG5vZGUuXCIpXHJcbiAgICAgIC5hZGRUb2dnbGUoKHRvZ2dsZSkgPT5cclxuICAgICAgICB0b2dnbGVcclxuICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnNldHRpbmdzTWFuYWdlci5nZXRTZXR0aW5nKCdjb2xsYXBzZWRHcm91cFByZXZpZXdPbkRyYWcnKSlcclxuICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IGF3YWl0IHRoaXMuc2V0dGluZ3NNYW5hZ2VyLnNldFNldHRpbmcoeyBjb2xsYXBzZWRHcm91cFByZXZpZXdPbkRyYWc6IHZhbHVlIH0pKVxyXG4gICAgICApXHJcblxyXG4gICAgdGhpcy5jcmVhdGVGZWF0dXJlSGVhZGluZyhcclxuICAgICAgY29udGFpbmVyRWwsXHJcbiAgICAgIFwiU3RpY2tlcnNcIixcclxuICAgICAgXCJDb252ZXJ0IGFuIGltYWdlIG5vZGUgdG8gYSBzdGlja2VyIGJ5IHN1cHBvcnRpbmcgdHJhbnNwYXJlbmN5IGFuZCByZW1vdmluZyB0aGUgYm9yZGVyLlwiLFxyXG4gICAgICAnc3RpY2tlcnNGZWF0dXJlRW5hYmxlZCdcclxuICAgIClcclxuXHJcbiAgICB0aGlzLmNyZWF0ZUZlYXR1cmVIZWFkaW5nKFxyXG4gICAgICBjb250YWluZXJFbCxcclxuICAgICAgXCJQcmVzZW50YXRpb25zXCIsXHJcbiAgICAgIFwiQ3JlYXRlIGEgcHJlc2VudGF0aW9uIGZyb20geW91ciBjYW52YXMuXCIsXHJcbiAgICAgICdwcmVzZW50YXRpb25GZWF0dXJlRW5hYmxlZCdcclxuICAgIClcclxuXHJcbiAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcclxuICAgICAgLnNldE5hbWUoXCJEZWZhdWx0IHNsaWRlIHJhdGlvXCIpXHJcbiAgICAgIC5zZXREZXNjKFwiVGhlIGRlZmF1bHQgcmF0aW8gb2YgdGhlIHNsaWRlLiBGb3IgZXhhbXBsZSwgMTY6OSBpcyAxMjAweDY3NSBhbmQgMzoyIGlzIDEzNTB4OTAwLlwiKVxyXG4gICAgICAuYWRkVGV4dCgodGV4dCkgPT5cclxuICAgICAgICB0ZXh0XHJcbiAgICAgICAgICAuc2V0VmFsdWUodGhpcy5zZXR0aW5nc01hbmFnZXIuZ2V0U2V0dGluZygnZGVmYXVsdFNsaWRlU2l6ZScpKVxyXG4gICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4gYXdhaXQgdGhpcy5zZXR0aW5nc01hbmFnZXIuc2V0U2V0dGluZyh7IGRlZmF1bHRTbGlkZVNpemU6IHZhbHVlLnJlcGxhY2UoJyAnLCAnJykgfSkpXHJcbiAgICAgIClcclxuXHJcbiAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcclxuICAgICAgLnNldE5hbWUoXCJXcmFwIGluIHNsaWRlIHBhZGRpbmdcIilcclxuICAgICAgLnNldERlc2MoXCJUaGUgcGFkZGluZyBvZiB0aGUgc2xpZGUgd2hlbiB3cmFwcGluZyB0aGUgY2FudmFzIGluIGEgc2xpZGUuXCIpXHJcbiAgICAgIC5hZGRUZXh0KCh0ZXh0KSA9PlxyXG4gICAgICAgIHRleHRcclxuICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnNldHRpbmdzTWFuYWdlci5nZXRTZXR0aW5nKCd3cmFwSW5TbGlkZVBhZGRpbmcnKS50b1N0cmluZygpKVxyXG4gICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4gYXdhaXQgdGhpcy5zZXR0aW5nc01hbmFnZXIuc2V0U2V0dGluZyh7IHdyYXBJblNsaWRlUGFkZGluZzogcGFyc2VJbnQodmFsdWUpIH0pKVxyXG4gICAgICApXHJcblxyXG4gICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXHJcbiAgICAgIC5zZXROYW1lKFwiVXNlIGFycm93IGtleXMgdG8gY2hhbmdlIHNsaWRlc1wiKVxyXG4gICAgICAuc2V0RGVzYyhcIldoZW4gZW5hYmxlZCwgeW91IGNhbiB1c2UgdGhlIGFycm93IGtleXMgdG8gY2hhbmdlIHNsaWRlcyBpbiBwcmVzZW50YXRpb24gbW9kZS5cIilcclxuICAgICAgLmFkZFRvZ2dsZSgodG9nZ2xlKSA9PlxyXG4gICAgICAgIHRvZ2dsZVxyXG4gICAgICAgICAgLnNldFZhbHVlKHRoaXMuc2V0dGluZ3NNYW5hZ2VyLmdldFNldHRpbmcoJ3VzZUFycm93S2V5c1RvQ2hhbmdlU2xpZGVzJykpXHJcbiAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiBhd2FpdCB0aGlzLnNldHRpbmdzTWFuYWdlci5zZXRTZXR0aW5nKHsgdXNlQXJyb3dLZXlzVG9DaGFuZ2VTbGlkZXM6IHZhbHVlIH0pKVxyXG4gICAgICApXHJcblxyXG4gICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXHJcbiAgICAgIC5zZXROYW1lKFwiWm9vbSB0byBzbGlkZSB3aXRob3V0IHBhZGRpbmdcIilcclxuICAgICAgLnNldERlc2MoXCJXaGVuIGVuYWJsZWQsIHRoZSBjYW52YXMgd2lsbCB6b29tIHRvIHRoZSBzbGlkZSB3aXRob3V0IHBhZGRpbmcuXCIpXHJcbiAgICAgIC5hZGRUb2dnbGUoKHRvZ2dsZSkgPT5cclxuICAgICAgICB0b2dnbGVcclxuICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnNldHRpbmdzTWFuYWdlci5nZXRTZXR0aW5nKCd6b29tVG9TbGlkZVdpdGhvdXRQYWRkaW5nJykpXHJcbiAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiBhd2FpdCB0aGlzLnNldHRpbmdzTWFuYWdlci5zZXRTZXR0aW5nKHsgem9vbVRvU2xpZGVXaXRob3V0UGFkZGluZzogdmFsdWUgfSkpXHJcbiAgICAgIClcclxuXHJcbiAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcclxuICAgICAgLnNldE5hbWUoXCJTbGlkZSB0cmFuc2l0aW9uIGFuaW1hdGlvbiBkdXJhdGlvblwiKVxyXG4gICAgICAuc2V0RGVzYyhcIlRoZSBkdXJhdGlvbiBvZiB0aGUgc2xpZGUgdHJhbnNpdGlvbiBhbmltYXRpb24gaW4gc2Vjb25kcy4gU2V0IHRvIDAgdG8gZGlzYWJsZSB0aGUgYW5pbWF0aW9uLlwiKVxyXG4gICAgICAuYWRkVGV4dCgodGV4dCkgPT5cclxuICAgICAgICB0ZXh0XHJcbiAgICAgICAgICAuc2V0VmFsdWUodGhpcy5zZXR0aW5nc01hbmFnZXIuZ2V0U2V0dGluZygnc2xpZGVUcmFuc2l0aW9uQW5pbWF0aW9uRHVyYXRpb24nKS50b1N0cmluZygpKVxyXG4gICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4gYXdhaXQgdGhpcy5zZXR0aW5nc01hbmFnZXIuc2V0U2V0dGluZyh7IHNsaWRlVHJhbnNpdGlvbkFuaW1hdGlvbkR1cmF0aW9uOiBwYXJzZUZsb2F0KHZhbHVlKSB9KSlcclxuICAgICAgKVxyXG5cclxuICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxyXG4gICAgICAuc2V0TmFtZShcIlNsaWRlIHRyYW5zaXRpb24gYW5pbWF0aW9uIGludGVuc2l0eVwiKVxyXG4gICAgICAuc2V0RGVzYyhcIlRoZSBpbnRlbnNpdHkgb2YgdGhlIHNsaWRlIHRyYW5zaXRpb24gYW5pbWF0aW9uLiBUaGUgaGlnaGVyIHRoZSB2YWx1ZSwgdGhlIG1vcmUgdGhlIGNhbnZhcyB3aWxsIHpvb20gb3V0IGJlZm9yZSB6b29taW5nIGluIG9uIHRoZSBuZXh0IHNsaWRlLlwiKVxyXG4gICAgICAuYWRkVGV4dCgodGV4dCkgPT5cclxuICAgICAgICB0ZXh0XHJcbiAgICAgICAgICAuc2V0VmFsdWUodGhpcy5zZXR0aW5nc01hbmFnZXIuZ2V0U2V0dGluZygnc2xpZGVUcmFuc2l0aW9uQW5pbWF0aW9uSW50ZW5zaXR5JykudG9TdHJpbmcoKSlcclxuICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IGF3YWl0IHRoaXMuc2V0dGluZ3NNYW5hZ2VyLnNldFNldHRpbmcoeyBzbGlkZVRyYW5zaXRpb25BbmltYXRpb25JbnRlbnNpdHk6IHBhcnNlRmxvYXQodmFsdWUpIH0pKVxyXG4gICAgICApXHJcblxyXG4gICAgdGhpcy5jcmVhdGVGZWF0dXJlSGVhZGluZyhcclxuICAgICAgY29udGFpbmVyRWwsXHJcbiAgICAgIFwiQ2FudmFzIGVuY2Fwc3VsYXRpb25cIixcclxuICAgICAgXCJFbmNhcHN1bGF0ZSBhIHNlbGVjdGlvbiBvZiBub2RlcyBhbmQgZWRnZXMgaW50byBhIG5ldyBjYW52YXMuXCIsXHJcbiAgICAgICdjYW52YXNFbmNhcHN1bGF0aW9uRW5hYmxlZCdcclxuICAgIClcclxuXHJcbiAgICB0aGlzLmNyZWF0ZUZlYXR1cmVIZWFkaW5nKFxyXG4gICAgICBjb250YWluZXJFbCxcclxuICAgICAgXCJQb3J0YWxzXCIsXHJcbiAgICAgIFwiQ3JlYXRlIHBvcnRhbHMgdG8gb3RoZXIgY2FudmFzZXMuXCIsXHJcbiAgICAgICdwb3J0YWxzRmVhdHVyZUVuYWJsZWQnXHJcbiAgICApXHJcblxyXG4gICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXHJcbiAgICAgIC5zZXROYW1lKFwiTWFpbnRhaW4gY2xvc2VkIHBvcnRhbCBzaXplXCIpXHJcbiAgICAgIC5zZXREZXNjKFwiV2hlbiBlbmFibGVkLCBjbG9zaW5nIGEgcG9ydGFsIHdpbGwgY2hhbmdlIHRoZSBzaXplIG9mIHRoZSBwb3J0YWwgdG8gdGhlIG9yaWdpbmFsLCBjbG9zZWQgc2l6ZS5cIilcclxuICAgICAgLmFkZFRvZ2dsZSgodG9nZ2xlKSA9PlxyXG4gICAgICAgIHRvZ2dsZVxyXG4gICAgICAgICAgLnNldFZhbHVlKHRoaXMuc2V0dGluZ3NNYW5hZ2VyLmdldFNldHRpbmcoJ21haW50YWluQ2xvc2VkUG9ydGFsU2l6ZScpKVxyXG4gICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4gYXdhaXQgdGhpcy5zZXR0aW5nc01hbmFnZXIuc2V0U2V0dGluZyh7IG1haW50YWluQ2xvc2VkUG9ydGFsU2l6ZTogdmFsdWUgfSkpXHJcbiAgICAgIClcclxuXHJcbiAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcclxuICAgICAgLnNldE5hbWUoXCJTaG93IGVkZ2VzIGludG8gZGlzYWJsZWQgcG9ydGFsc1wiKVxyXG4gICAgICAuc2V0RGVzYyhcIldoZW4gZW5hYmxlZCwgZWRnZXMgaW50byBkaXNhYmxlZCBwb3J0YWxzIHdpbGwgYmUgc2hvd24gYnkgYW4gZWRnZSB0byB0aGUgcG9ydGFsIG5vZGUuXCIpXHJcbiAgICAgIC5hZGRUb2dnbGUoKHRvZ2dsZSkgPT5cclxuICAgICAgICB0b2dnbGVcclxuICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnNldHRpbmdzTWFuYWdlci5nZXRTZXR0aW5nKCdzaG93RWRnZXNJbnRvRGlzYWJsZWRQb3J0YWxzJykpXHJcbiAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiBhd2FpdCB0aGlzLnNldHRpbmdzTWFuYWdlci5zZXRTZXR0aW5nKHsgc2hvd0VkZ2VzSW50b0Rpc2FibGVkUG9ydGFsczogdmFsdWUgfSkpXHJcbiAgICAgIClcclxuICB9XHJcblxyXG4gIHByaXZhdGUgY3JlYXRlRmVhdHVyZUhlYWRpbmcoY29udGFpbmVyRWw6IEhUTUxFbGVtZW50LCBsYWJlbDogc3RyaW5nLCBkZXNjcmlwdGlvbjogc3RyaW5nLCBzZXR0aW5nc0tleToga2V5b2YgQWR2YW5jZWRDYW52YXNQbHVnaW5TZXR0aW5ncyk6IFNldHRpbmcge1xyXG4gICAgcmV0dXJuIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxyXG4gICAgICAuc2V0SGVhZGluZygpXHJcbiAgICAgIC5zZXROYW1lKGxhYmVsKVxyXG4gICAgICAuc2V0RGVzYyhkZXNjcmlwdGlvbilcclxuICAgICAgLmFkZFRvZ2dsZSgodG9nZ2xlKSA9PlxyXG4gICAgICAgIHRvZ2dsZVxyXG4gICAgICAgICAgLnNldFRvb2x0aXAoXCJSZXF1aXJlcyBhIHJlbG9hZCB0byB0YWtlIGVmZmVjdC5cIilcclxuICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnNldHRpbmdzTWFuYWdlci5nZXRTZXR0aW5nKHNldHRpbmdzS2V5KSBhcyBib29sZWFuKVxyXG4gICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xyXG4gICAgICAgICAgICBhd2FpdCB0aGlzLnNldHRpbmdzTWFuYWdlci5zZXRTZXR0aW5nKHsgW3NldHRpbmdzS2V5XTogdmFsdWUgfSlcclxuICAgICAgICAgICAgbmV3IE5vdGljZShcIlJlbG9hZCBvYnNpZGlhbiB0byBhcHBseSB0aGUgY2hhbmdlcy5cIilcclxuICAgICAgICAgIH0pXHJcbiAgICAgIClcclxuICB9XHJcbn0iLCAiaW1wb3J0IHsgc2V0SWNvbiwgc2V0VG9vbHRpcCB9IGZyb20gXCJvYnNpZGlhblwiXHJcbmltcG9ydCB7IEJCb3gsIENhbnZhcywgQ2FudmFzTm9kZSwgQ2FudmFzTm9kZURhdGEsIFBvc2l0aW9uLCBTaXplIH0gZnJvbSBcInNyYy9AdHlwZXMvQ2FudmFzXCJcclxuaW1wb3J0IEFkdmFuY2VkQ2FudmFzUGx1Z2luIGZyb20gXCJzcmMvbWFpblwiXHJcbmltcG9ydCAqIGFzIEJCb3hIZWxwZXIgZnJvbSBcInNyYy91dGlscy9iYm94LWhlbHBlclwiXHJcblxyXG5leHBvcnQgZnVuY3Rpb24gY2FudmFzQ29tbWFuZChwbHVnaW46IEFkdmFuY2VkQ2FudmFzUGx1Z2luLCBjaGVjazogKGNhbnZhczogQ2FudmFzKSA9PiBib29sZWFuLCBydW46IChjYW52YXM6IENhbnZhcykgPT4gdm9pZCk6IChjaGVja2luZzogYm9vbGVhbikgPT4gYm9vbGVhbiB7XHJcbiAgcmV0dXJuIChjaGVja2luZzogYm9vbGVhbikgPT4ge1xyXG4gICAgY29uc3QgY2FudmFzID0gcGx1Z2luLmdldEN1cnJlbnRDYW52YXMoKVxyXG4gICAgaWYgKGNoZWNraW5nKSByZXR1cm4gY2FudmFzICE9PSBudWxsICYmIGNoZWNrKGNhbnZhcylcclxuXHJcbiAgICBpZiAoY2FudmFzKSBydW4oY2FudmFzKVxyXG5cclxuICAgIHJldHVybiB0cnVlXHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIE1lbnVPcHRpb24ge1xyXG4gIGlkPzogc3RyaW5nXHJcbiAgbGFiZWw6IHN0cmluZ1xyXG4gIGljb246IHN0cmluZ1xyXG4gIGNhbGxiYWNrPzogKCkgPT4gdm9pZFxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlUXVpY2tTZXR0aW5nc0J1dHRvbihtZW51T3B0aW9uOiBNZW51T3B0aW9uKTogSFRNTEVsZW1lbnQge1xyXG4gIGNvbnN0IHF1aWNrU2V0dGluZyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpXHJcbiAgaWYgKG1lbnVPcHRpb24uaWQpIHF1aWNrU2V0dGluZy5pZCA9IG1lbnVPcHRpb24uaWRcclxuICBxdWlja1NldHRpbmcuY2xhc3NMaXN0LmFkZCgnY2FudmFzLWNvbnRyb2wtaXRlbScpXHJcbiAgc2V0SWNvbihxdWlja1NldHRpbmcsIG1lbnVPcHRpb24uaWNvbilcclxuICBzZXRUb29sdGlwKHF1aWNrU2V0dGluZywgbWVudU9wdGlvbi5sYWJlbCwgeyBwbGFjZW1lbnQ6ICdsZWZ0JyB9KVxyXG4gIHF1aWNrU2V0dGluZy5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IG1lbnVPcHRpb24uY2FsbGJhY2s/LigpKVxyXG5cclxuICByZXR1cm4gcXVpY2tTZXR0aW5nXHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBhZGRRdWlja1NldHRpbmdzQnV0dG9uKGNvbnRyb2xHcm91cDogSFRNTEVsZW1lbnQsIGVsZW1lbnQ6IEhUTUxFbGVtZW50KSB7XHJcbiAgaWYgKGVsZW1lbnQuaWQpIGNvbnRyb2xHcm91cC5xdWVyeVNlbGVjdG9yKGAjJHtlbGVtZW50LmlkfWApPy5yZW1vdmUoKVxyXG4gIGNvbnRyb2xHcm91cC5hcHBlbmRDaGlsZChlbGVtZW50KVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlQ2FyZE1lbnVPcHRpb24oY2FudmFzOiBDYW52YXMsIG1lbnVPcHRpb246IE1lbnVPcHRpb24sIHByZXZpZXdOb2RlU2l6ZTogKCkgPT4gU2l6ZSwgb25QbGFjZWQ6IChjYW52YXM6IENhbnZhcywgcG9zOiBQb3NpdGlvbikgPT4gdm9pZCk6IEhUTUxFbGVtZW50IHtcclxuICBjb25zdCBtZW51T3B0aW9uRWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpXHJcbiAgaWYgKG1lbnVPcHRpb24uaWQpIG1lbnVPcHRpb25FbGVtZW50LmlkID0gbWVudU9wdGlvbi5pZFxyXG4gIG1lbnVPcHRpb25FbGVtZW50LmNsYXNzTGlzdC5hZGQoJ2NhbnZhcy1jYXJkLW1lbnUtYnV0dG9uJylcclxuICBtZW51T3B0aW9uRWxlbWVudC5jbGFzc0xpc3QuYWRkKCdtb2QtZHJhZ2dhYmxlJylcclxuICBzZXRJY29uKG1lbnVPcHRpb25FbGVtZW50LCBtZW51T3B0aW9uLmljb24pXHJcbiAgc2V0VG9vbHRpcChtZW51T3B0aW9uRWxlbWVudCwgbWVudU9wdGlvbi5sYWJlbCwgeyBwbGFjZW1lbnQ6ICd0b3AnIH0pXHJcblxyXG4gIG1lbnVPcHRpb25FbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKF9lKSA9PiB7XHJcbiAgICBvblBsYWNlZChjYW52YXMsIGdldENlbnRlckNvb3JkaW5hdGVzKGNhbnZhcywgcHJldmlld05vZGVTaXplKCkpKVxyXG4gIH0pXHJcblxyXG4gIG1lbnVPcHRpb25FbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ3BvaW50ZXJkb3duJywgKGUpID0+IHtcclxuICAgIGNhbnZhcy5kcmFnVGVtcE5vZGUoZSwgcHJldmlld05vZGVTaXplKCksIChwb3M6IFBvc2l0aW9uKSA9PiB7XHJcbiAgICAgIGNhbnZhcy5kZXNlbGVjdEFsbCgpXHJcbiAgICAgIG9uUGxhY2VkKGNhbnZhcywgcG9zKVxyXG4gICAgfSlcclxuICB9KVxyXG5cclxuICByZXR1cm4gbWVudU9wdGlvbkVsZW1lbnRcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGFkZENhcmRNZW51T3B0aW9uKGNhbnZhczogQ2FudmFzLCBlbGVtZW50OiBIVE1MRWxlbWVudCkge1xyXG4gIGlmIChlbGVtZW50LmlkKSBjYW52YXM/LmNhcmRNZW51RWwucXVlcnlTZWxlY3RvcihgIyR7ZWxlbWVudC5pZH1gKT8ucmVtb3ZlKClcclxuICBjYW52YXM/LmNhcmRNZW51RWwuYXBwZW5kQ2hpbGQoZWxlbWVudClcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZVBvcHVwTWVudU9wdGlvbihtZW51T3B0aW9uOiBNZW51T3B0aW9uKTogSFRNTEVsZW1lbnQge1xyXG4gIGNvbnN0IG1lbnVPcHRpb25FbGVtZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYnV0dG9uJylcclxuICBpZiAobWVudU9wdGlvbi5pZCkgbWVudU9wdGlvbkVsZW1lbnQuaWQgPSBtZW51T3B0aW9uLmlkXHJcbiAgbWVudU9wdGlvbkVsZW1lbnQuY2xhc3NMaXN0LmFkZCgnY2xpY2thYmxlLWljb24nKVxyXG4gIHNldEljb24obWVudU9wdGlvbkVsZW1lbnQsIG1lbnVPcHRpb24uaWNvbilcclxuICBzZXRUb29sdGlwKG1lbnVPcHRpb25FbGVtZW50LCBtZW51T3B0aW9uLmxhYmVsLCB7IHBsYWNlbWVudDogJ3RvcCcgfSlcclxuICBtZW51T3B0aW9uRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IG1lbnVPcHRpb24uY2FsbGJhY2s/LigpKVxyXG5cclxuICByZXR1cm4gbWVudU9wdGlvbkVsZW1lbnRcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZUV4cGFuZGFibGVQb3B1cE1lbnVPcHRpb24obWVudU9wdGlvbjogTWVudU9wdGlvbiwgc3ViTWVudU9wdGlvbnM6IE1lbnVPcHRpb25bXSk6IEhUTUxFbGVtZW50IHtcclxuICBjb25zdCBtZW51T3B0aW9uRWxlbWVudCA9IGNyZWF0ZVBvcHVwTWVudU9wdGlvbih7XHJcbiAgICAuLi5tZW51T3B0aW9uLFxyXG4gICAgY2FsbGJhY2s6ICgpID0+IHtcclxuICAgICAgY29uc3Qgc3VibWVudUlkID0gYCR7bWVudU9wdGlvbi5pZH0tc3VibWVudWBcclxuXHJcbiAgICAgIGlmIChtZW51T3B0aW9uRWxlbWVudC5jbGFzc0xpc3QuY29udGFpbnMoJ2lzLWFjdGl2ZScpKSB7XHJcbiAgICAgICAgbWVudU9wdGlvbkVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSgnaXMtYWN0aXZlJylcclxuICAgICAgICBtZW51T3B0aW9uRWxlbWVudC5wYXJlbnRFbGVtZW50Py5xdWVyeVNlbGVjdG9yKGAjJHtzdWJtZW51SWR9YCk/LnJlbW92ZSgpXHJcbiAgICAgICAgcmV0dXJuXHJcbiAgICAgIH1cclxuXHJcbiAgICAgIG1lbnVPcHRpb25FbGVtZW50LmNsYXNzTGlzdC5hZGQoJ2lzLWFjdGl2ZScpXHJcblxyXG4gICAgICAvLyBBZGQgcG9wdXAgbWVudVxyXG4gICAgICBjb25zdCBzdWJtZW51ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2JylcclxuICAgICAgc3VibWVudS5pZCA9IHN1Ym1lbnVJZFxyXG4gICAgICBzdWJtZW51LmNsYXNzTGlzdC5hZGQoJ2NhbnZhcy1zdWJtZW51JylcclxuICAgIFxyXG4gICAgICAvLyBBZGQgbmVzdGVkIG9wdGlvbnNcclxuICAgICAgZm9yIChjb25zdCBzdWJNZW51T3B0aW9uIG9mIHN1Yk1lbnVPcHRpb25zKSB7XHJcbiAgICAgICAgY29uc3Qgc3ViTWVudU9wdGlvbkVsZW1lbnQgPSBjcmVhdGVQb3B1cE1lbnVPcHRpb24oc3ViTWVudU9wdGlvbilcclxuICAgICAgICBzdWJtZW51LmFwcGVuZENoaWxkKHN1Yk1lbnVPcHRpb25FbGVtZW50KVxyXG4gICAgICB9XHJcblxyXG4gICAgICBtZW51T3B0aW9uRWxlbWVudC5wYXJlbnRFbGVtZW50Py5hcHBlbmRDaGlsZChzdWJtZW51KVxyXG4gICAgfVxyXG4gIH0pXHJcblxyXG4gIHJldHVybiBtZW51T3B0aW9uRWxlbWVudFxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gYWRkUG9wdXBNZW51T3B0aW9uKGNhbnZhczogQ2FudmFzLCBlbGVtZW50OiBIVE1MRWxlbWVudCwgaW5kZXg6IG51bWJlciA9IC0xKSB7XHJcbiAgY29uc3QgcG9wdXBNZW51RWwgPSBjYW52YXM/Lm1lbnU/Lm1lbnVFbFxyXG4gIGlmICghcG9wdXBNZW51RWwpIHJldHVyblxyXG5cclxuICBpZiAoZWxlbWVudC5pZCkgcG9wdXBNZW51RWwucXVlcnlTZWxlY3RvcihgIyR7ZWxlbWVudC5pZH1gKT8ucmVtb3ZlKClcclxuXHJcbiAgY29uc3Qgc2lzdGVyRWxlbWVudCA9IGluZGV4ID49IDAgPyBwb3B1cE1lbnVFbC5jaGlsZHJlbltpbmRleF0gOiBwb3B1cE1lbnVFbC5jaGlsZHJlbltwb3B1cE1lbnVFbC5jaGlsZHJlbi5sZW5ndGggKyBpbmRleF1cclxuICBwb3B1cE1lbnVFbC5pbnNlcnRBZnRlcihlbGVtZW50LCBzaXN0ZXJFbGVtZW50KVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gZ2V0Q2VudGVyQ29vcmRpbmF0ZXMoY2FudmFzOiBDYW52YXMsIG5vZGVTaXplOiBTaXplKTogUG9zaXRpb24ge1xyXG4gIGNvbnN0IHZpZXdCb3VuZHMgPSBjYW52YXMuZ2V0Vmlld3BvcnRCQm94KClcclxuXHJcbiAgcmV0dXJuIHsgXHJcbiAgICB4OiAodmlld0JvdW5kcy5taW5YICsgdmlld0JvdW5kcy5tYXhYKSAvIDIgLSBub2RlU2l6ZS53aWR0aCAvIDIsXHJcbiAgICB5OiAodmlld0JvdW5kcy5taW5ZICsgdmlld0JvdW5kcy5tYXhZKSAvIDIgLSBub2RlU2l6ZS5oZWlnaHQgLyAyLFxyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGdldEJCb3goY2FudmFzTm9kZXM6IChDYW52YXNOb2RlfENhbnZhc05vZGVEYXRhKVtdKSB7XHJcbiAgbGV0IG1pblggPSBJbmZpbml0eVxyXG4gIGxldCBtaW5ZID0gSW5maW5pdHlcclxuICBsZXQgbWF4WCA9IC1JbmZpbml0eVxyXG4gIGxldCBtYXhZID0gLUluZmluaXR5XHJcblxyXG4gIGZvciAoY29uc3Qgbm9kZSBvZiBjYW52YXNOb2Rlcykge1xyXG4gICAgY29uc3Qgbm9kZURhdGEgPSBub2RlLmdldERhdGEgPyBub2RlLmdldERhdGEoKSA6IG5vZGVcclxuXHJcbiAgICBtaW5YID0gTWF0aC5taW4obWluWCwgbm9kZURhdGEueClcclxuICAgIG1pblkgPSBNYXRoLm1pbihtaW5ZLCBub2RlRGF0YS55KVxyXG4gICAgbWF4WCA9IE1hdGgubWF4KG1heFgsIG5vZGVEYXRhLnggKyBub2RlRGF0YS53aWR0aClcclxuICAgIG1heFkgPSBNYXRoLm1heChtYXhZLCBub2RlRGF0YS55ICsgbm9kZURhdGEuaGVpZ2h0KVxyXG4gIH1cclxuXHJcbiAgcmV0dXJuIHsgbWluWCwgbWluWSwgbWF4WCwgbWF4WSB9XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiB6b29tVG9CQm94KGNhbnZhczogQ2FudmFzLCBiYm94OiBCQm94KSB7XHJcbiAgY29uc3QgUEFERElOR19DT1JSRUNUSU9OX0ZBQ1RPUiA9IDEgLyAxLjFcclxuICBjb25zdCB6b29tZWRCQm94ID0gQkJveEhlbHBlci5zY2FsZUJCb3goYmJveCwgUEFERElOR19DT1JSRUNUSU9OX0ZBQ1RPUilcclxuXHJcbiAgY2FudmFzLnpvb21Ub0Jib3goem9vbWVkQkJveClcclxuICBcclxuICAvLyBDYWxjdWxhdGUgem9vbSBmYWN0b3Igd2l0aG91dCBjbGFtcFxyXG4gIGNvbnN0IHNjYWxlRmFjdG9yID0gTWF0aC5taW4oXHJcbiAgICBjYW52YXMuY2FudmFzUmVjdC53aWR0aCAvIChiYm94Lm1heFggLSBiYm94Lm1pblgpLFxyXG4gICAgY2FudmFzLmNhbnZhc1JlY3QuaGVpZ2h0IC8gKGJib3gubWF4WSAtIGJib3gubWluWSlcclxuICApXHJcblxyXG4gIGNhbnZhcy50Wm9vbSA9IE1hdGgubG9nMihzY2FsZUZhY3RvcilcclxufSIsICJpbXBvcnQgeyBCQm94LCBDYW52YXNOb2RlRGF0YSwgUG9zaXRpb24sIFNpZGUgfSBmcm9tIFwic3JjL0B0eXBlcy9DYW52YXNcIlxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGNvbWJpbmVCQm94ZXMoYmJveGVzOiBCQm94W10pOiBCQm94IHtcclxuICBsZXQgbWluWCA9IEluZmluaXR5XHJcbiAgbGV0IG1pblkgPSBJbmZpbml0eVxyXG4gIGxldCBtYXhYID0gLUluZmluaXR5XHJcbiAgbGV0IG1heFkgPSAtSW5maW5pdHlcclxuXHJcbiAgZm9yIChsZXQgYmJveCBvZiBiYm94ZXMpIHtcclxuICAgIG1pblggPSBNYXRoLm1pbihtaW5YLCBiYm94Lm1pblgpXHJcbiAgICBtaW5ZID0gTWF0aC5taW4obWluWSwgYmJveC5taW5ZKVxyXG4gICAgbWF4WCA9IE1hdGgubWF4KG1heFgsIGJib3gubWF4WClcclxuICAgIG1heFkgPSBNYXRoLm1heChtYXhZLCBiYm94Lm1heFkpXHJcbiAgfVxyXG5cclxuICByZXR1cm4geyBtaW5YLCBtaW5ZLCBtYXhYLCBtYXhZIH1cclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIHNjYWxlQkJveChiYm94OiBCQm94LCBzY2FsZTogbnVtYmVyKTogQkJveCB7XHJcbiAgbGV0IGRpZmZYID0gKHNjYWxlIC0gMSkgKiAoYmJveC5tYXhYIC0gYmJveC5taW5YKVxyXG4gIGxldCBkaWZmWSA9IChzY2FsZSAtIDEpICogKGJib3gubWF4WSAtIGJib3gubWluWSlcclxuXHJcbiAgcmV0dXJuIHtcclxuICAgIG1pblg6IGJib3gubWluWCAtIGRpZmZYIC8gMixcclxuICAgIG1heFg6IGJib3gubWF4WCArIGRpZmZYIC8gMixcclxuICAgIG1pblk6IGJib3gubWluWSAtIGRpZmZZIC8gMixcclxuICAgIG1heFk6IGJib3gubWF4WSArIGRpZmZZIC8gMlxyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGluc2lkZUJCb3gocG9zaXRpb246IFBvc2l0aW9ufEJCb3gsIGJib3g6IEJCb3gsIGNhblRvdWNoRWRnZTogQm9vbGVhbik6IGJvb2xlYW4ge1xyXG4gIGNvbnN0IHByb3ZpZGVkQkJveCA9IHtcclxuICAgIG1pblg6IChwb3NpdGlvbiBhcyBCQm94KS5taW5YID8/IChwb3NpdGlvbiBhcyBQb3NpdGlvbikueCxcclxuICAgIG1pblk6IChwb3NpdGlvbiBhcyBCQm94KS5taW5ZID8/IChwb3NpdGlvbiBhcyBQb3NpdGlvbikueSxcclxuICAgIG1heFg6IChwb3NpdGlvbiBhcyBCQm94KS5tYXhYID8/IChwb3NpdGlvbiBhcyBQb3NpdGlvbikueCxcclxuICAgIG1heFk6IChwb3NpdGlvbiBhcyBCQm94KS5tYXhZID8/IChwb3NpdGlvbiBhcyBQb3NpdGlvbikueVxyXG4gIH1cclxuICBcclxuICByZXR1cm4gY2FuVG91Y2hFZGdlID8gcHJvdmlkZWRCQm94Lm1pblggPj0gYmJveC5taW5YICYmIHByb3ZpZGVkQkJveC5tYXhYIDw9IGJib3gubWF4WCAmJiBwcm92aWRlZEJCb3gubWluWSA+PSBiYm94Lm1pblkgJiYgcHJvdmlkZWRCQm94Lm1heFkgPD0gYmJveC5tYXhZIDpcclxuICAgIHByb3ZpZGVkQkJveC5taW5YID4gYmJveC5taW5YICYmIHByb3ZpZGVkQkJveC5tYXhYIDwgYmJveC5tYXhYICYmIHByb3ZpZGVkQkJveC5taW5ZID4gYmJveC5taW5ZICYmIHByb3ZpZGVkQkJveC5tYXhZIDwgYmJveC5tYXhZXHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBlbmxhcmdlQkJveChiYm94OiBCQm94LCBwYWRkaW5nOiBudW1iZXIpOiBCQm94IHtcclxuICByZXR1cm4ge1xyXG4gICAgbWluWDogYmJveC5taW5YIC0gcGFkZGluZyxcclxuICAgIG1pblk6IGJib3gubWluWSAtIHBhZGRpbmcsXHJcbiAgICBtYXhYOiBiYm94Lm1heFggKyBwYWRkaW5nLFxyXG4gICAgbWF4WTogYmJveC5tYXhZICsgcGFkZGluZ1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGdldENlbnRlck9mQkJveFNpZGUoYmJveDogQkJveCwgc2lkZTogU2lkZSk6IFBvc2l0aW9uIHtcclxuICBzd2l0Y2ggKHNpZGUpIHtcclxuICAgIGNhc2UgJ3RvcCc6XHJcbiAgICAgIHJldHVybiB7IHg6IChiYm94Lm1pblggKyBiYm94Lm1heFgpIC8gMiwgeTogYmJveC5taW5ZIH1cclxuICAgIGNhc2UgJ3JpZ2h0JzpcclxuICAgICAgcmV0dXJuIHsgeDogYmJveC5tYXhYLCB5OiAoYmJveC5taW5ZICsgYmJveC5tYXhZKSAvIDIgfVxyXG4gICAgY2FzZSAnYm90dG9tJzpcclxuICAgICAgcmV0dXJuIHsgeDogKGJib3gubWluWCArIGJib3gubWF4WCkgLyAyLCB5OiBiYm94Lm1heFkgfVxyXG4gICAgY2FzZSAnbGVmdCc6XHJcbiAgICAgIHJldHVybiB7IHg6IGJib3gubWluWCwgeTogKGJib3gubWluWSArIGJib3gubWF4WSkgLyAyIH1cclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBiYm94RnJvbU5vZGVEYXRhKG5vZGVEYXRhOiBDYW52YXNOb2RlRGF0YSk6IEJCb3gge1xyXG4gIHJldHVybiB7XHJcbiAgICBtaW5YOiBub2RlRGF0YS54LFxyXG4gICAgbWluWTogbm9kZURhdGEueSxcclxuICAgIG1heFg6IG5vZGVEYXRhLnggKyBub2RlRGF0YS53aWR0aCxcclxuICAgIG1heFk6IG5vZGVEYXRhLnkgKyBub2RlRGF0YS5oZWlnaHRcclxuICB9XHJcbn0iLCAiY29uc3QgUExVR0lOX0VWRU5UX1BSRUZJWCA9ICdhZHZhbmNlZC1jYW52YXMnXHJcblxyXG5leHBvcnQgY29uc3QgQ2FudmFzRXZlbnQgPSB7XHJcbiAgQ2FudmFzQ2hhbmdlZDogYCR7UExVR0lOX0VWRU5UX1BSRUZJWH06Y2FudmFzLWNoYW5nZWRgLFxyXG4gIFZpZXdwb3J0Q2hhbmdlZDoge1xyXG4gICAgQmVmb3JlOiBgJHtQTFVHSU5fRVZFTlRfUFJFRklYfTp2aWV3cG9ydC1jaGFuZ2VkOmJlZm9yZWAsXHJcbiAgICBBZnRlcjogYCR7UExVR0lOX0VWRU5UX1BSRUZJWH06dmlld3BvcnQtY2hhbmdlZDphZnRlcmBcclxuICB9LFxyXG4gIE5vZGVNb3ZlZDogYCR7UExVR0lOX0VWRU5UX1BSRUZJWH06bm9kZS1tb3ZlZGAsXHJcbiAgRG91YmxlQ2xpY2s6IGAke1BMVUdJTl9FVkVOVF9QUkVGSVh9OmRvdWJsZS1jbGlja2AsXHJcbiAgRHJhZ2dpbmdTdGF0ZUNoYW5nZWQ6IGAke1BMVUdJTl9FVkVOVF9QUkVGSVh9OmRyYWdnaW5nLXN0YXRlLWNoYW5nZWRgLFxyXG4gIE5vZGVBZGRlZDogYCR7UExVR0lOX0VWRU5UX1BSRUZJWH06bm9kZS1hZGRlZGAsXHJcbiAgRWRnZUFkZGVkOiBgJHtQTFVHSU5fRVZFTlRfUFJFRklYfTplZGdlLWFkZGVkYCxcclxuICBOb2RlUmVtb3ZlZDogYCR7UExVR0lOX0VWRU5UX1BSRUZJWH06bm9kZS1yZW1vdmVkYCxcclxuICBFZGdlUmVtb3ZlZDogYCR7UExVR0lOX0VWRU5UX1BSRUZJWH06ZWRnZS1yZW1vdmVkYCxcclxuICBOb2RlQ2hhbmdlZDogYCR7UExVR0lOX0VWRU5UX1BSRUZJWH06bm9kZS1jaGFuZ2VkYCxcclxuICBFZGdlQ2hhbmdlZDogYCR7UExVR0lOX0VWRU5UX1BSRUZJWH06ZWRnZS1jaGFuZ2VkYCxcclxuICBOb2RlQkJveFJlcXVlc3RlZDogYCR7UExVR0lOX0VWRU5UX1BSRUZJWH06bm9kZS1iYm94LXJlcXVlc3RlZGAsXHJcbiAgRWRnZUNlbnRlclJlcXVlc3RlZDogYCR7UExVR0lOX0VWRU5UX1BSRUZJWH06ZWRnZS1jZW50ZXItcmVxdWVzdGVkYCxcclxuICBDb250YWluaW5nTm9kZXNSZXF1ZXN0ZWQ6IGAke1BMVUdJTl9FVkVOVF9QUkVGSVh9OmNvbnRhaW5pbmctbm9kZXMtcmVxdWVzdGVkYCxcclxuICBTZWxlY3Rpb25DaGFuZ2VkOiBgJHtQTFVHSU5fRVZFTlRfUFJFRklYfTpzZWxlY3Rpb24tY2hhbmdlZGAsXHJcbiAgWm9vbVRvQmJveDoge1xyXG4gICAgQmVmb3JlOiBgJHtQTFVHSU5fRVZFTlRfUFJFRklYfTp6b29tLXRvLWJib3g6YmVmb3JlYCxcclxuICAgIEFmdGVyOiBgJHtQTFVHSU5fRVZFTlRfUFJFRklYfTp6b29tLXRvLWJib3g6YWZ0ZXJgXHJcbiAgfSxcclxuICBQb3B1cE1lbnVDcmVhdGVkOiBgJHtQTFVHSU5fRVZFTlRfUFJFRklYfTpwb3B1cC1tZW51LWNyZWF0ZWRgLFxyXG4gIE5vZGVJbnRlcmFjdGlvbjogYCR7UExVR0lOX0VWRU5UX1BSRUZJWH06bm9kZS1pbnRlcmFjdGlvbmAsXHJcbiAgVW5kbzogYCR7UExVR0lOX0VWRU5UX1BSRUZJWH06dW5kb2AsXHJcbiAgUmVkbzogYCR7UExVR0lOX0VWRU5UX1BSRUZJWH06cmVkb2AsXHJcbiAgUmVhZG9ubHlDaGFuZ2VkOiBgJHtQTFVHSU5fRVZFTlRfUFJFRklYfTpyZWFkb25seS1jaGFuZ2VkYCxcclxuICBEYXRhUmVxdWVzdGVkOiBgJHtQTFVHSU5fRVZFTlRfUFJFRklYfTpkYXRhLXJlcXVlc3RlZGAsXHJcbiAgTG9hZERhdGE6IGAke1BMVUdJTl9FVkVOVF9QUkVGSVh9OmxvYWQtZGF0YWAsXHJcbiAgQ2FudmFzU2F2ZWQ6IHtcclxuICAgIEJlZm9yZTogYCR7UExVR0lOX0VWRU5UX1BSRUZJWH06Y2FudmFzLXNhdmVkOmJlZm9yZWAsXHJcbiAgICBBZnRlcjogYCR7UExVR0lOX0VWRU5UX1BSRUZJWH06Y2FudmFzLXNhdmVkOmFmdGVyYFxyXG4gIH1cclxufSIsICJpbXBvcnQgeyBDYW52YXMgfSBmcm9tIFwic3JjL0B0eXBlcy9DYW52YXNcIlxyXG5pbXBvcnQgQWR2YW5jZWRDYW52YXNQbHVnaW4gZnJvbSBcInNyYy9tYWluXCJcclxuaW1wb3J0ICogYXMgQ2FudmFzSGVscGVyIGZyb20gXCJzcmMvdXRpbHMvY2FudmFzLWhlbHBlclwiXHJcbmltcG9ydCB7IENhbnZhc0V2ZW50IH0gZnJvbSBcInNyYy9jb3JlL2V2ZW50c1wiXHJcblxyXG5pbnRlcmZhY2UgU2hhcGUge1xyXG4gIGlkPzogc3RyaW5nXHJcbiAgbWVudU5hbWU6IHN0cmluZ1xyXG4gIGljb246IHN0cmluZ1xyXG59XHJcblxyXG5jb25zdCBTSEFQRVM6IFNoYXBlW10gPSBbXHJcbiAge1xyXG4gICAgbWVudU5hbWU6ICdEZWZhdWx0JyxcclxuICAgIGljb246ICdjaXJjbGUtb2ZmJ1xyXG4gIH0sXHJcbiAge1xyXG4gICAgaWQ6ICdvdmFsJyxcclxuICAgIG1lbnVOYW1lOiAnT3ZhbCcsXHJcbiAgICBpY29uOiAnb3ZhbCdcclxuICB9LFxyXG4gIHtcclxuICAgIGlkOiAnY2VudGVyZWQtcmVjdGFuZ2xlJyxcclxuICAgIG1lbnVOYW1lOiAnUmVjdGFuZ2xlJyxcclxuICAgIGljb246ICdyZWN0YW5nbGUtaG9yaXpvbnRhbCdcclxuICB9LFxyXG4gIHtcclxuICAgIGlkOiAnZGlhbW9uZCcsXHJcbiAgICBtZW51TmFtZTogJ0RpYW1vbmQnLFxyXG4gICAgaWNvbjogJ2RpYW1vbmQnXHJcbiAgfSxcclxuICB7XHJcbiAgICBpZDogJ3BhcmFsbGVsb2dyYW0nLFxyXG4gICAgbWVudU5hbWU6ICdQYXJhbGxlbG9ncmFtJyxcclxuICAgIGljb246ICdwYXJhbGxlbG9ncmFtJ1xyXG4gIH0sXHJcbiAge1xyXG4gICAgaWQ6ICdjaXJjbGUnLFxyXG4gICAgbWVudU5hbWU6ICdDaXJjbGUnLFxyXG4gICAgaWNvbjogJ2NpcmNsZSdcclxuICB9LFxyXG4gIHtcclxuICAgIGlkOiAncHJlZGVmaW5lZC1wcm9jZXNzJyxcclxuICAgIG1lbnVOYW1lOiAnUHJlZGVmaW5lZCBwcm9jZXNzJyxcclxuICAgIGljb246ICdwcmVkZWZpbmVkLXByb2Nlc3MnXHJcbiAgfSxcclxuICB7XHJcbiAgICBpZDogJ2RvY3VtZW50JyxcclxuICAgIG1lbnVOYW1lOiAnRG9jdW1lbnQnLFxyXG4gICAgaWNvbjogJ2RvY3VtZW50J1xyXG4gIH0sXHJcbiAge1xyXG4gICAgaWQ6ICdkYXRhYmFzZScsXHJcbiAgICBtZW51TmFtZTogJ0RhdGFiYXNlJyxcclxuICAgIGljb246ICdkYXRhYmFzZS1zaGFwZSdcclxuICB9XHJcbl1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFNoYXBlc0NhbnZhc0V4dGVuc2lvbiB7XHJcbiAgcGx1Z2luOiBBZHZhbmNlZENhbnZhc1BsdWdpblxyXG5cclxuICBjb25zdHJ1Y3RvcihwbHVnaW46IEFkdmFuY2VkQ2FudmFzUGx1Z2luKSB7XHJcbiAgICB0aGlzLnBsdWdpbiA9IHBsdWdpblxyXG5cclxuICAgIGlmICghdGhpcy5wbHVnaW4uc2V0dGluZ3MuZ2V0U2V0dGluZygnc2hhcGVzRmVhdHVyZUVuYWJsZWQnKSkgcmV0dXJuXHJcblxyXG4gICAgdGhpcy5wbHVnaW4ucmVnaXN0ZXJFdmVudCh0aGlzLnBsdWdpbi5hcHAud29ya3NwYWNlLm9uKFxyXG4gICAgICBDYW52YXNFdmVudC5Qb3B1cE1lbnVDcmVhdGVkLFxyXG4gICAgICAoY2FudmFzOiBDYW52YXMpID0+IHRoaXMub25Qb3B1cE1lbnVDcmVhdGVkKGNhbnZhcylcclxuICAgICkpXHJcbiAgfVxyXG5cclxuICBvblBvcHVwTWVudUNyZWF0ZWQoY2FudmFzOiBDYW52YXMpOiB2b2lkIHtcclxuICAgIC8vIElmIHRoZSBjYW52YXMgaXMgcmVhZG9ubHkgb3IgdGhlcmUgaXMgbm8gdmFsaWQgc2hhcGUgaW4gdGhlIHNlbGVjdGlvbiwgcmV0dXJuXHJcbiAgICBpZiAoY2FudmFzLnJlYWRvbmx5IHx8ICF0aGlzLmhhc1ZhbGlkTm9kZUluU2VsZWN0aW9uKGNhbnZhcykpXHJcbiAgICAgIHJldHVyblxyXG5cclxuICAgIGNvbnN0IG5lc3RlZE1lbnVPcHRpb25zID0gU0hBUEVTLm1hcCgoc2hhcGUpID0+ICh7XHJcbiAgICAgIGxhYmVsOiBzaGFwZS5tZW51TmFtZSxcclxuICAgICAgaWNvbjogc2hhcGUuaWNvbixcclxuICAgICAgY2FsbGJhY2s6ICgpID0+IHRoaXMuc2V0U2hhcGVGb3JTZWxlY3Rpb24oY2FudmFzLCBzaGFwZSlcclxuICAgIH0pKVxyXG5cclxuICAgIGNvbnN0IG1lbnVPcHRpb24gPSBDYW52YXNIZWxwZXIuY3JlYXRlRXhwYW5kYWJsZVBvcHVwTWVudU9wdGlvbih7XHJcbiAgICAgIGlkOiAnbm9kZS1zaGFwZS1vcHRpb24nLFxyXG4gICAgICBsYWJlbDogJ05vZGUgc2hhcGUnLFxyXG4gICAgICBpY29uOiAnc2hhcGVzJ1xyXG4gICAgfSwgbmVzdGVkTWVudU9wdGlvbnMpXHJcblxyXG4gICAgLy8gQWRkIG1lbnUgb3B0aW9uIHRvIG1lbnUgYmFyXHJcbiAgICBDYW52YXNIZWxwZXIuYWRkUG9wdXBNZW51T3B0aW9uKGNhbnZhcywgbWVudU9wdGlvbilcclxuICB9XHJcblxyXG4gIHByaXZhdGUgaGFzVmFsaWROb2RlSW5TZWxlY3Rpb24oY2FudmFzOiBDYW52YXMpOiBib29sZWFuIHtcclxuICAgIGNvbnN0IHNlbGVjdGVkTm9kZXNEYXRhID0gY2FudmFzLmdldFNlbGVjdGlvbkRhdGEoKS5ub2Rlc1xyXG5cclxuICAgIGZvciAoY29uc3Qgbm9kZURhdGEgb2Ygc2VsZWN0ZWROb2Rlc0RhdGEpIHtcclxuICAgICAgaWYgKG5vZGVEYXRhLnR5cGUgPT09ICd0ZXh0JykgcmV0dXJuIHRydWVcclxuICAgIH1cclxuICAgIFxyXG4gICAgcmV0dXJuIGZhbHNlXHJcbiAgfVxyXG5cclxuICBwcml2YXRlIHNldFNoYXBlRm9yU2VsZWN0aW9uKGNhbnZhczogQ2FudmFzLCBzaGFwZTogU2hhcGUpIHsgIFxyXG4gICAgY29uc3Qgc2VsZWN0ZWROb2Rlc0RhdGEgPSBjYW52YXMuZ2V0U2VsZWN0aW9uRGF0YSgpLm5vZGVzXHJcblxyXG4gICAgZm9yIChjb25zdCBub2RlRGF0YSBvZiBzZWxlY3RlZE5vZGVzRGF0YSkge1xyXG4gICAgICBpZiAobm9kZURhdGEudHlwZSAhPT0gJ3RleHQnKSBjb250aW51ZVxyXG5cclxuICAgICAgY29uc3Qgbm9kZSA9IGNhbnZhcy5ub2Rlcy5nZXQobm9kZURhdGEuaWQpXHJcbiAgICAgIGlmICghbm9kZSkgY29udGludWVcclxuICAgICAgXHJcbiAgICAgIG5vZGUuc2V0RGF0YSh7IC4uLm5vZGVEYXRhLCBzaGFwZTogc2hhcGUuaWQgfSlcclxuICAgIH1cclxuICB9XHJcbn0iLCAiZXhwb3J0IGZ1bmN0aW9uIGFyb3VuZChvYmosIGZhY3Rvcmllcykge1xuICAgIGNvbnN0IHJlbW92ZXJzID0gT2JqZWN0LmtleXMoZmFjdG9yaWVzKS5tYXAoa2V5ID0+IGFyb3VuZDEob2JqLCBrZXksIGZhY3Rvcmllc1trZXldKSk7XG4gICAgcmV0dXJuIHJlbW92ZXJzLmxlbmd0aCA9PT0gMSA/IHJlbW92ZXJzWzBdIDogZnVuY3Rpb24gKCkgeyByZW1vdmVycy5mb3JFYWNoKHIgPT4gcigpKTsgfTtcbn1cbmZ1bmN0aW9uIGFyb3VuZDEob2JqLCBtZXRob2QsIGNyZWF0ZVdyYXBwZXIpIHtcbiAgICBjb25zdCBvcmlnaW5hbCA9IG9ialttZXRob2RdLCBoYWRPd24gPSBvYmouaGFzT3duUHJvcGVydHkobWV0aG9kKTtcbiAgICBsZXQgY3VycmVudCA9IGNyZWF0ZVdyYXBwZXIob3JpZ2luYWwpO1xuICAgIC8vIExldCBvdXIgd3JhcHBlciBpbmhlcml0IHN0YXRpYyBwcm9wcyBmcm9tIHRoZSB3cmFwcGluZyBtZXRob2QsXG4gICAgLy8gYW5kIHRoZSB3cmFwcGluZyBtZXRob2QsIHByb3BzIGZyb20gdGhlIG9yaWdpbmFsIG1ldGhvZFxuICAgIGlmIChvcmlnaW5hbClcbiAgICAgICAgT2JqZWN0LnNldFByb3RvdHlwZU9mKGN1cnJlbnQsIG9yaWdpbmFsKTtcbiAgICBPYmplY3Quc2V0UHJvdG90eXBlT2Yod3JhcHBlciwgY3VycmVudCk7XG4gICAgb2JqW21ldGhvZF0gPSB3cmFwcGVyO1xuICAgIC8vIFJldHVybiBhIGNhbGxiYWNrIHRvIGFsbG93IHNhZmUgcmVtb3ZhbFxuICAgIHJldHVybiByZW1vdmU7XG4gICAgZnVuY3Rpb24gd3JhcHBlciguLi5hcmdzKSB7XG4gICAgICAgIC8vIElmIHdlIGhhdmUgYmVlbiBkZWFjdGl2YXRlZCBhbmQgYXJlIG5vIGxvbmdlciB3cmFwcGVkLCByZW1vdmUgb3Vyc2VsdmVzXG4gICAgICAgIGlmIChjdXJyZW50ID09PSBvcmlnaW5hbCAmJiBvYmpbbWV0aG9kXSA9PT0gd3JhcHBlcilcbiAgICAgICAgICAgIHJlbW92ZSgpO1xuICAgICAgICByZXR1cm4gY3VycmVudC5hcHBseSh0aGlzLCBhcmdzKTtcbiAgICB9XG4gICAgZnVuY3Rpb24gcmVtb3ZlKCkge1xuICAgICAgICAvLyBJZiBubyBvdGhlciBwYXRjaGVzLCBqdXN0IGRvIGEgZGlyZWN0IHJlbW92YWxcbiAgICAgICAgaWYgKG9ialttZXRob2RdID09PSB3cmFwcGVyKSB7XG4gICAgICAgICAgICBpZiAoaGFkT3duKVxuICAgICAgICAgICAgICAgIG9ialttZXRob2RdID0gb3JpZ2luYWw7XG4gICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgICAgZGVsZXRlIG9ialttZXRob2RdO1xuICAgICAgICB9XG4gICAgICAgIGlmIChjdXJyZW50ID09PSBvcmlnaW5hbClcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgLy8gRWxzZSBwYXNzIGZ1dHVyZSBjYWxscyB0aHJvdWdoLCBhbmQgcmVtb3ZlIHdyYXBwZXIgZnJvbSB0aGUgcHJvdG90eXBlIGNoYWluXG4gICAgICAgIGN1cnJlbnQgPSBvcmlnaW5hbDtcbiAgICAgICAgT2JqZWN0LnNldFByb3RvdHlwZU9mKHdyYXBwZXIsIG9yaWdpbmFsIHx8IEZ1bmN0aW9uKTtcbiAgICB9XG59XG5leHBvcnQgZnVuY3Rpb24gZGVkdXBlKGtleSwgb2xkRm4sIG5ld0ZuKSB7XG4gICAgY2hlY2tba2V5XSA9IGtleTtcbiAgICByZXR1cm4gY2hlY2s7XG4gICAgZnVuY3Rpb24gY2hlY2soLi4uYXJncykge1xuICAgICAgICByZXR1cm4gKG9sZEZuW2tleV0gPT09IGtleSA/IG9sZEZuIDogbmV3Rm4pLmFwcGx5KHRoaXMsIGFyZ3MpO1xuICAgIH1cbn1cbmV4cG9ydCBmdW5jdGlvbiBhZnRlcihwcm9taXNlLCBjYikge1xuICAgIHJldHVybiBwcm9taXNlLnRoZW4oY2IsIGNiKTtcbn1cbmV4cG9ydCBmdW5jdGlvbiBzZXJpYWxpemUoYXN5bmNGdW5jdGlvbikge1xuICAgIGxldCBsYXN0UnVuID0gUHJvbWlzZS5yZXNvbHZlKCk7XG4gICAgZnVuY3Rpb24gd3JhcHBlciguLi5hcmdzKSB7XG4gICAgICAgIHJldHVybiBsYXN0UnVuID0gbmV3IFByb21pc2UoKHJlcywgcmVqKSA9PiB7XG4gICAgICAgICAgICBhZnRlcihsYXN0UnVuLCAoKSA9PiB7XG4gICAgICAgICAgICAgICAgYXN5bmNGdW5jdGlvbi5hcHBseSh0aGlzLCBhcmdzKS50aGVuKHJlcywgcmVqKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgd3JhcHBlci5hZnRlciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIGxhc3RSdW4gPSBuZXcgUHJvbWlzZSgocmVzLCByZWopID0+IHsgYWZ0ZXIobGFzdFJ1biwgcmVzKTsgfSk7XG4gICAgfTtcbiAgICByZXR1cm4gd3JhcHBlcjtcbn1cbiIsICJpbXBvcnQgeyBhcm91bmQgfSBmcm9tIFwibW9ua2V5LWFyb3VuZFwiXHJcbmltcG9ydCB7IFBsdWdpbiB9IGZyb20gXCJvYnNpZGlhblwiXHJcblxyXG5leHBvcnQgZnVuY3Rpb24gdHJ5UGF0Y2hXb3Jrc3BhY2VQcm90b3R5cGU8VD4ocGx1Z2luOiBQbHVnaW4sIGdldFRhcmdldDogKCkgPT4gVHx1bmRlZmluZWQsIGZ1bmN0aW9uczogeyBba2V5OiBzdHJpbmddOiAobmV4dDogYW55KSA9PiAoLi4uYXJnczogYW55KSA9PiBhbnkgfSk6IFByb21pc2U8VD4ge1xyXG4gIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSkgPT4ge1xyXG4gICAgY29uc3QgdHJ5UGF0Y2ggPSAoKSA9PiB7XHJcbiAgICAgIGNvbnN0IHRhcmdldCA9IGdldFRhcmdldCgpXHJcbiAgICAgIGlmICghdGFyZ2V0KSByZXR1cm4gbnVsbFxyXG5cclxuICAgICAgY29uc3QgdW5pbnN0YWxsZXIgPSBhcm91bmQodGFyZ2V0LmNvbnN0cnVjdG9yLnByb3RvdHlwZSwgZnVuY3Rpb25zKVxyXG4gICAgICBwbHVnaW4ucmVnaXN0ZXIodW5pbnN0YWxsZXIpXHJcblxyXG4gICAgICByZXR1cm4gdGFyZ2V0XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgcmVzdWx0ID0gdHJ5UGF0Y2goKVxyXG4gICAgaWYgKHJlc3VsdCkge1xyXG4gICAgICByZXNvbHZlKHJlc3VsdClcclxuICAgICAgcmV0dXJuXHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgbGlzdGVuZXIgPSBwbHVnaW4uYXBwLndvcmtzcGFjZS5vbignbGF5b3V0LWNoYW5nZScsICgpID0+IHtcclxuICAgICAgY29uc3QgcmVzdWx0ID0gdHJ5UGF0Y2goKVxyXG5cclxuICAgICAgaWYgKHJlc3VsdCkge1xyXG4gICAgICAgIHBsdWdpbi5hcHAud29ya3NwYWNlLm9mZnJlZihsaXN0ZW5lcilcclxuICAgICAgICByZXNvbHZlKHJlc3VsdClcclxuICAgICAgfVxyXG4gICAgfSlcclxuXHJcbiAgICBwbHVnaW4ucmVnaXN0ZXJFdmVudChsaXN0ZW5lcilcclxuICB9KVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gcGF0Y2hPYmplY3RQcm90b3R5cGU8VD4ocGx1Z2luOiBQbHVnaW4sIHRhcmdldDogVCwgZnVuY3Rpb25zOiB7IFtrZXk6IHN0cmluZ106IChuZXh0OiBhbnkpID0+ICguLi5hcmdzOiBhbnkpID0+IGFueSB9KTogdm9pZCB7XHJcbiAgY29uc3QgdW5pbnN0YWxsZXIgPSBhcm91bmQoKHRhcmdldCBhcyBhbnkpLmNvbnN0cnVjdG9yLnByb3RvdHlwZSwgZnVuY3Rpb25zKVxyXG4gIHBsdWdpbi5yZWdpc3Rlcih1bmluc3RhbGxlcilcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIHBhdGNoT2JqZWN0SW5zdGFuY2U8VD4ocGx1Z2luOiBQbHVnaW4sIHRhcmdldDogVCwgZnVuY3Rpb25zOiB7IFtrZXk6IHN0cmluZ106IChuZXh0OiBhbnkpID0+ICguLi5hcmdzOiBhbnkpID0+IGFueSB9KTogdm9pZCB7XHJcbiAgY29uc3QgdW5pbnN0YWxsZXIgPSBhcm91bmQodGFyZ2V0IGFzIGFueSwgZnVuY3Rpb25zKVxyXG4gIHBsdWdpbi5yZWdpc3Rlcih1bmluc3RhbGxlcilcclxufSIsICJpbXBvcnQgQWR2YW5jZWRDYW52YXNQbHVnaW4gZnJvbSBcInNyYy9tYWluXCJcclxuaW1wb3J0IHsgQkJveCwgQ2FudmFzLCBDYW52YXNEYXRhLCBDYW52YXNFZGdlLCBDYW52YXNFbGVtZW50LCBDYW52YXNOb2RlLCBDYW52YXNWaWV3IH0gZnJvbSBcInNyYy9AdHlwZXMvQ2FudmFzXCJcclxuaW1wb3J0IHsgcGF0Y2hPYmplY3RJbnN0YW5jZSwgcGF0Y2hPYmplY3RQcm90b3R5cGUgfSBmcm9tIFwic3JjL3V0aWxzL3BhdGNoLWhlbHBlclwiXHJcbmltcG9ydCB7IENhbnZhc0V2ZW50IH0gZnJvbSBcIi4vZXZlbnRzXCJcclxuaW1wb3J0IHsgV29ya3NwYWNlTGVhZiB9IGZyb20gXCJvYnNpZGlhblwiXHJcbmltcG9ydCB7IGFyb3VuZCB9IGZyb20gXCJtb25rZXktYXJvdW5kXCJcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIENhbnZhc1BhdGNoZXIge1xyXG4gIHBsdWdpbjogQWR2YW5jZWRDYW52YXNQbHVnaW5cclxuXHJcbiAgY29uc3RydWN0b3IocGx1Z2luOiBBZHZhbmNlZENhbnZhc1BsdWdpbikge1xyXG4gICAgdGhpcy5wbHVnaW4gPSBwbHVnaW5cclxuICAgIHRoaXMuYXBwbHlQYXRjaGVzKClcclxuICB9XHJcblxyXG4gIHByaXZhdGUgYXN5bmMgYXBwbHlQYXRjaGVzKCkge1xyXG4gICAgY29uc3QgdGhhdCA9IHRoaXNcclxuXHJcbiAgICAvLyBHZXQgdGhlIGN1cnJlbnQgY2FudmFzIHZpZXcgb3Igd2FpdCBmb3IgaXQgdG8gYmUgY3JlYXRlZFxyXG4gICAgY29uc3QgY2FudmFzVmlldyA9IChcclxuICAgICAgdGhpcy5wbHVnaW4uYXBwLndvcmtzcGFjZS5nZXRMZWF2ZXNPZlR5cGUoJ2NhbnZhcycpPy5maXJzdCgpPy52aWV3ID8/XHJcbiAgICAgIGF3YWl0IG5ldyBQcm9taXNlPENhbnZhc1ZpZXc+KChyZXNvbHZlKSA9PiB7XHJcbiAgICAgICAgLy8gQHRzLWlnbm9yZVxyXG4gICAgICAgIGNvbnN0IHVuaW5zdGFsbCA9IGFyb3VuZCh0aGlzLnBsdWdpbi5hcHAuaW50ZXJuYWxQbHVnaW5zLnBsdWdpbnMuY2FudmFzLnZpZXdzLCB7XHJcbiAgICAgICAgICBjYW52YXM6IChuZXh0OiBhbnkpID0+IGZ1bmN0aW9uICguLi5hcmdzOiBhbnkpIHtcclxuICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0gbmV4dC5jYWxsKHRoaXMsIC4uLmFyZ3MpXHJcblxyXG4gICAgICAgICAgICByZXNvbHZlKHJlc3VsdClcclxuICAgICAgICAgICAgdW5pbnN0YWxsKCkgLy8gVW5pbnN0YWxsIHRoZSBwYXRjaFxyXG5cclxuICAgICAgICAgICAgcmV0dXJuIHJlc3VsdFxyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0pXHJcbiAgICAgICAgdGhpcy5wbHVnaW4ucmVnaXN0ZXIodW5pbnN0YWxsKVxyXG4gICAgICB9KVxyXG4gICAgKSBhcyBDYW52YXNWaWV3XHJcbiAgICBcclxuICAgIC8vIFBhdGNoIGNhbnZhcyB2aWV3XHJcbiAgICBwYXRjaE9iamVjdFByb3RvdHlwZSh0aGlzLnBsdWdpbiwgY2FudmFzVmlldywge1xyXG4gICAgICBnZXRWaWV3RGF0YTogKF9uZXh0OiBhbnkpID0+IGZ1bmN0aW9uICguLi5fYXJnczogYW55KSB7XHJcbiAgICAgICAgY29uc3QgY2FudmFzRGF0YSA9IHRoaXMuY2FudmFzLmdldERhdGEoKVxyXG4gICAgICAgIGNhbnZhc0RhdGEubWV0YWRhdGEgPSB0aGlzLmNhbnZhcy5tZXRhZGF0YSA/PyB7fVxyXG5cclxuICAgICAgICByZXR1cm4gSlNPTi5zdHJpbmdpZnkoY2FudmFzRGF0YSwgbnVsbCwgMilcclxuICAgICAgfSxcclxuICAgICAgc2V0Vmlld0RhdGE6IChuZXh0OiBhbnkpID0+IGZ1bmN0aW9uIChqc29uOiBzdHJpbmcsIC4uLmFyZ3M6IGFueSkge1xyXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IG5leHQuY2FsbCh0aGlzLCBqc29uLCAuLi5hcmdzKVxyXG4gICAgICAgIHRoaXMuY2FudmFzLm1ldGFkYXRhID0gSlNPTi5wYXJzZShqc29uKS5tZXRhZGF0YVxyXG5cclxuICAgICAgICB0aGF0LnRyaWdnZXJXb3Jrc3BhY2VFdmVudChDYW52YXNFdmVudC5DYW52YXNDaGFuZ2VkLCB0aGlzLmNhbnZhcylcclxuXHJcbiAgICAgICAgcmV0dXJuIHJlc3VsdFxyXG4gICAgICB9XHJcbiAgICB9KVxyXG5cclxuICAgIC8vIFBhdGNoIGNhbnZhc1xyXG4gICAgcGF0Y2hPYmplY3RQcm90b3R5cGUodGhpcy5wbHVnaW4sIGNhbnZhc1ZpZXcuY2FudmFzLCB7XHJcbiAgICAgIG1hcmtWaWV3cG9ydENoYW5nZWQ6IChuZXh0OiBhbnkpID0+IGZ1bmN0aW9uICguLi5hcmdzOiBhbnkpIHtcclxuICAgICAgICB0aGF0LnRyaWdnZXJXb3Jrc3BhY2VFdmVudChDYW52YXNFdmVudC5WaWV3cG9ydENoYW5nZWQuQmVmb3JlLCB0aGlzKVxyXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IG5leHQuY2FsbCh0aGlzLCAuLi5hcmdzKVxyXG4gICAgICAgIHRoYXQudHJpZ2dlcldvcmtzcGFjZUV2ZW50KENhbnZhc0V2ZW50LlZpZXdwb3J0Q2hhbmdlZC5BZnRlciwgdGhpcylcclxuICAgICAgICByZXR1cm4gcmVzdWx0XHJcbiAgICAgIH0sXHJcbiAgICAgIG1hcmtNb3ZlZDogKG5leHQ6IGFueSkgPT4gZnVuY3Rpb24gKG5vZGU6IENhbnZhc05vZGUpIHtcclxuICAgICAgICBjb25zdCByZXN1bHQgPSBuZXh0LmNhbGwodGhpcywgbm9kZSlcclxuICAgICAgICB0aGF0LnRyaWdnZXJXb3Jrc3BhY2VFdmVudChDYW52YXNFdmVudC5Ob2RlTW92ZWQsIHRoaXMsIG5vZGUpXHJcbiAgICAgICAgcmV0dXJuIHJlc3VsdFxyXG4gICAgICB9LFxyXG4gICAgICBvbkRvdWJsZUNsaWNrOiAobmV4dDogYW55KSA9PiBmdW5jdGlvbiAoZXZlbnQ6IE1vdXNlRXZlbnQpIHtcclxuICAgICAgICBjb25zdCBwcmV2ZW50RGVmYXVsdCA9IHsgdmFsdWU6IGZhbHNlIH1cclxuICAgICAgICB0aGF0LnRyaWdnZXJXb3Jrc3BhY2VFdmVudChDYW52YXNFdmVudC5Eb3VibGVDbGljaywgdGhpcywgZXZlbnQsIHByZXZlbnREZWZhdWx0KVxyXG4gICAgICAgIGlmICghcHJldmVudERlZmF1bHQudmFsdWUpIG5leHQuY2FsbCh0aGlzLCBldmVudClcclxuICAgICAgfSxcclxuICAgICAgc2V0RHJhZ2dpbmc6IChuZXh0OiBhbnkpID0+IGZ1bmN0aW9uIChkcmFnZ2luZzogYm9vbGVhbikge1xyXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IG5leHQuY2FsbCh0aGlzLCBkcmFnZ2luZylcclxuICAgICAgICB0aGF0LnRyaWdnZXJXb3Jrc3BhY2VFdmVudChDYW52YXNFdmVudC5EcmFnZ2luZ1N0YXRlQ2hhbmdlZCwgdGhpcywgZHJhZ2dpbmcpXHJcbiAgICAgICAgcmV0dXJuIHJlc3VsdFxyXG4gICAgICB9LFxyXG4gICAgICBnZXRDb250YWluaW5nTm9kZXM6IChuZXh0OiBhbnkpID0+IGZ1bmN0aW9uIChiYm94OiBCQm94KSB7XHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gbmV4dC5jYWxsKHRoaXMsIGJib3gpXHJcbiAgICAgICAgdGhhdC50cmlnZ2VyV29ya3NwYWNlRXZlbnQoQ2FudmFzRXZlbnQuQ29udGFpbmluZ05vZGVzUmVxdWVzdGVkLCB0aGlzLCBiYm94LCByZXN1bHQpXHJcbiAgICAgICAgcmV0dXJuIHJlc3VsdFxyXG4gICAgICB9LFxyXG4gICAgICB1cGRhdGVTZWxlY3Rpb246IChuZXh0OiBhbnkpID0+IGZ1bmN0aW9uICh1cGRhdGU6ICgpID0+IHZvaWQpIHtcclxuICAgICAgICBjb25zdCBvbGRTZWxlY3Rpb24gPSBuZXcgU2V0KHRoaXMuc2VsZWN0aW9uKVxyXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IG5leHQuY2FsbCh0aGlzLCB1cGRhdGUpXHJcbiAgICAgICAgdGhhdC50cmlnZ2VyV29ya3NwYWNlRXZlbnQoQ2FudmFzRXZlbnQuU2VsZWN0aW9uQ2hhbmdlZCwgdGhpcywgb2xkU2VsZWN0aW9uLCAoKHVwZGF0ZTogKCkgPT4gdm9pZCkgPT4gbmV4dC5jYWxsKHRoaXMsIHVwZGF0ZSkpKVxyXG4gICAgICAgIHJldHVybiByZXN1bHRcclxuICAgICAgfSxcclxuICAgICAgYWRkTm9kZTogKG5leHQ6IGFueSkgPT4gZnVuY3Rpb24gKG5vZGU6IENhbnZhc05vZGUpIHtcclxuICAgICAgICB0aGF0LnBhdGNoTm9kZShub2RlKVxyXG4gICAgICAgIHJldHVybiBuZXh0LmNhbGwodGhpcywgbm9kZSlcclxuICAgICAgfSxcclxuICAgICAgYWRkRWRnZTogKG5leHQ6IGFueSkgPT4gZnVuY3Rpb24gKGVkZ2U6IENhbnZhc0VkZ2UpIHtcclxuICAgICAgICB0aGF0LnBhdGNoRWRnZShlZGdlKVxyXG4gICAgICAgIHJldHVybiBuZXh0LmNhbGwodGhpcywgZWRnZSlcclxuICAgICAgfSxcclxuICAgICAgcmVtb3ZlTm9kZTogKG5leHQ6IGFueSkgPT4gZnVuY3Rpb24gKG5vZGU6IENhbnZhc05vZGUpIHtcclxuICAgICAgICBjb25zdCByZXN1bHQgPSBuZXh0LmNhbGwodGhpcywgbm9kZSlcclxuICAgICAgICB0aGF0LnRyaWdnZXJXb3Jrc3BhY2VFdmVudChDYW52YXNFdmVudC5Ob2RlUmVtb3ZlZCwgdGhpcywgbm9kZSlcclxuICAgICAgICByZXR1cm4gcmVzdWx0XHJcbiAgICAgIH0sXHJcbiAgICAgIHJlbW92ZUVkZ2U6IChuZXh0OiBhbnkpID0+IGZ1bmN0aW9uIChlZGdlOiBDYW52YXNFZGdlKSB7XHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gbmV4dC5jYWxsKHRoaXMsIGVkZ2UpXHJcbiAgICAgICAgdGhhdC50cmlnZ2VyV29ya3NwYWNlRXZlbnQoQ2FudmFzRXZlbnQuRWRnZVJlbW92ZWQsIHRoaXMsIGVkZ2UpXHJcbiAgICAgICAgcmV0dXJuIHJlc3VsdFxyXG4gICAgICB9LFxyXG4gICAgICB6b29tVG9CYm94OiAobmV4dDogYW55KSA9PiBmdW5jdGlvbiAoYmJveDogQkJveCkge1xyXG4gICAgICAgIHRoYXQudHJpZ2dlcldvcmtzcGFjZUV2ZW50KENhbnZhc0V2ZW50Llpvb21Ub0Jib3guQmVmb3JlLCB0aGlzLCBiYm94KVxyXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IG5leHQuY2FsbCh0aGlzLCBiYm94KVxyXG4gICAgICAgIHRoYXQudHJpZ2dlcldvcmtzcGFjZUV2ZW50KENhbnZhc0V2ZW50Llpvb21Ub0Jib3guQWZ0ZXIsIHRoaXMsIGJib3gpXHJcbiAgICAgICAgcmV0dXJuIHJlc3VsdFxyXG4gICAgICB9LFxyXG4gICAgICBzZXRSZWFkb25seTogKG5leHQ6IGFueSkgPT4gZnVuY3Rpb24gKHJlYWRvbmx5OiBib29sZWFuKSB7XHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gbmV4dC5jYWxsKHRoaXMsIHJlYWRvbmx5KVxyXG4gICAgICAgIHRoYXQudHJpZ2dlcldvcmtzcGFjZUV2ZW50KENhbnZhc0V2ZW50LlJlYWRvbmx5Q2hhbmdlZCwgdGhpcywgcmVhZG9ubHkpXHJcbiAgICAgICAgcmV0dXJuIHJlc3VsdFxyXG4gICAgICB9LFxyXG4gICAgICB1bmRvOiAobmV4dDogYW55KSA9PiBmdW5jdGlvbiAoLi4uYXJnczogYW55KSB7XHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gbmV4dC5jYWxsKHRoaXMsIC4uLmFyZ3MpXHJcbiAgICAgICAgdGhpcy5pbXBvcnREYXRhKHRoaXMuZ2V0RGF0YSgpLCB0cnVlKSAvLyBGb3JjZSB1cGRhdGUgdGhlIGNhbnZhcyBkYXRhXHJcbiAgICAgICAgdGhhdC50cmlnZ2VyV29ya3NwYWNlRXZlbnQoQ2FudmFzRXZlbnQuVW5kbywgdGhpcylcclxuICAgICAgICByZXR1cm4gcmVzdWx0XHJcbiAgICAgIH0sXHJcbiAgICAgIHJlZG86IChuZXh0OiBhbnkpID0+IGZ1bmN0aW9uICguLi5hcmdzOiBhbnkpIHtcclxuICAgICAgICBjb25zdCByZXN1bHQgPSBuZXh0LmNhbGwodGhpcywgLi4uYXJncylcclxuICAgICAgICB0aGlzLmltcG9ydERhdGEodGhpcy5nZXREYXRhKCksIHRydWUpIC8vIEZvcmNlIHVwZGF0ZSB0aGUgY2FudmFzIGRhdGFcclxuICAgICAgICB0aGF0LnRyaWdnZXJXb3Jrc3BhY2VFdmVudChDYW52YXNFdmVudC5SZWRvLCB0aGlzKVxyXG4gICAgICAgIHJldHVybiByZXN1bHRcclxuICAgICAgfSxcclxuICAgICAgZ2V0RGF0YTogKG5leHQ6IGFueSkgPT4gZnVuY3Rpb24gKC4uLmFyZ3M6IGFueSkge1xyXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IG5leHQuY2FsbCh0aGlzLCAuLi5hcmdzKVxyXG4gICAgICAgIHRoYXQudHJpZ2dlcldvcmtzcGFjZUV2ZW50KENhbnZhc0V2ZW50LkRhdGFSZXF1ZXN0ZWQsIHRoaXMsIHJlc3VsdClcclxuICAgICAgICByZXR1cm4gcmVzdWx0XHJcbiAgICAgIH0sXHJcbiAgICAgIGltcG9ydERhdGE6IChuZXh0OiBhbnkpID0+IGZ1bmN0aW9uIChkYXRhOiBDYW52YXNEYXRhLCBjbGVhckNhbnZhcz86IGJvb2xlYW4sIHNpbGVudD86IGJvb2xlYW4pIHtcclxuICAgICAgICBjb25zdCB0YXJnZXRGaWxlUGF0aCA9IHRoaXMudmlldy5maWxlLnBhdGhcclxuICAgICAgICBjb25zdCBzZXREYXRhID0gKGRhdGE6IENhbnZhc0RhdGEpID0+IHtcclxuICAgICAgICAgIC8vIFNraXAgaWYgdGhlIGNhbnZhcyBnb3QgdW5sb2FkZWQgb3IgdGhlIGZpbGUgY2hhbmdlZFxyXG4gICAgICAgICAgaWYgKCF0aGlzLnZpZXcuZmlsZSB8fCB0aGlzLnZpZXcuZmlsZS5wYXRoICE9PSB0YXJnZXRGaWxlUGF0aCkgcmV0dXJuXHJcblxyXG4gICAgICAgICAgdGhpcy5pbXBvcnREYXRhKGRhdGEsIHRydWUsIHRydWUpXHJcbiAgICAgICAgICB0aGF0LmVtaXRFdmVudHNGb3JVbmtub3duRGF0YUNoYW5nZXModGhpcylcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmICghc2lsZW50KSB0aGF0LnRyaWdnZXJXb3Jrc3BhY2VFdmVudChDYW52YXNFdmVudC5Mb2FkRGF0YSwgdGhpcywgZGF0YSwgc2V0RGF0YSlcclxuICAgICAgICBjb25zdCByZXN1bHQgPSBuZXh0LmNhbGwodGhpcywgZGF0YSwgY2xlYXJDYW52YXMpXHJcbiAgICAgICAgdGhhdC5lbWl0RXZlbnRzRm9yVW5rbm93bkRhdGFDaGFuZ2VzKHRoaXMpXHJcbiAgICAgICAgcmV0dXJuIHJlc3VsdFxyXG4gICAgICB9LFxyXG4gICAgICByZXF1ZXN0U2F2ZTogKG5leHQ6IGFueSkgPT4gZnVuY3Rpb24gKC4uLmFyZ3M6IGFueSkge1xyXG4gICAgICAgIHRoYXQudHJpZ2dlcldvcmtzcGFjZUV2ZW50KENhbnZhc0V2ZW50LkNhbnZhc1NhdmVkLkJlZm9yZSwgdGhpcylcclxuICAgICAgICBjb25zdCByZXN1bHQgPSBuZXh0LmNhbGwodGhpcywgLi4uYXJncylcclxuICAgICAgICB0aGF0LnRyaWdnZXJXb3Jrc3BhY2VFdmVudChDYW52YXNFdmVudC5DYW52YXNTYXZlZC5BZnRlciwgdGhpcylcclxuICAgICAgICByZXR1cm4gcmVzdWx0XHJcbiAgICAgIH1cclxuICAgIH0pXHJcblxyXG4gICAgLy8gUGF0Y2ggY2FudmFzIHBvcHVwIG1lbnVcclxuICAgIHBhdGNoT2JqZWN0UHJvdG90eXBlKHRoaXMucGx1Z2luLCBjYW52YXNWaWV3LmNhbnZhcy5tZW51LCB7XHJcbiAgICAgIHJlbmRlcjogKG5leHQ6IGFueSkgPT4gZnVuY3Rpb24gKC4uLmFyZ3M6IGFueSkge1xyXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IG5leHQuY2FsbCh0aGlzLCAuLi5hcmdzKVxyXG4gICAgICAgIHRoYXQudHJpZ2dlcldvcmtzcGFjZUV2ZW50KENhbnZhc0V2ZW50LlBvcHVwTWVudUNyZWF0ZWQsIHRoaXMuY2FudmFzKVxyXG4gICAgICAgIG5leHQuY2FsbCh0aGlzKSAvLyBSZS1DZW50ZXIgdGhlIHBvcHVwIG1lbnVcclxuICAgICAgICByZXR1cm4gcmVzdWx0XHJcbiAgICAgIH1cclxuICAgIH0pXHJcblxyXG4gICAgLy8gUGF0Y2ggaW50ZXJhY3Rpb24gbGF5ZXJcclxuICAgIHBhdGNoT2JqZWN0UHJvdG90eXBlKHRoaXMucGx1Z2luLCBjYW52YXNWaWV3LmNhbnZhcy5ub2RlSW50ZXJhY3Rpb25MYXllciwge1xyXG4gICAgICBzZXRUYXJnZXQ6IChuZXh0OiBhbnkpID0+IGZ1bmN0aW9uIChub2RlOiBDYW52YXNOb2RlKSB7XHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gbmV4dC5jYWxsKHRoaXMsIG5vZGUpXHJcbiAgICAgICAgdGhhdC50cmlnZ2VyV29ya3NwYWNlRXZlbnQoQ2FudmFzRXZlbnQuTm9kZUludGVyYWN0aW9uLCB0aGlzLmNhbnZhcywgbm9kZSlcclxuICAgICAgICByZXR1cm4gcmVzdWx0XHJcbiAgICAgIH1cclxuICAgIH0pXHJcblxyXG4gICAgLy8gQ2FudmFzIGlzIG5vdyBwYXRjaGVkIC0gdXBkYXRlIGFsbCBvcGVuIGNhbnZhcyB2aWV3c1xyXG4gICAgdGhpcy5wbHVnaW4uYXBwLndvcmtzcGFjZS5pdGVyYXRlQWxsTGVhdmVzKChsZWFmOiBXb3Jrc3BhY2VMZWFmKSA9PiB7XHJcbiAgICAgIGlmIChsZWFmLnZpZXcuZ2V0Vmlld1R5cGUoKSAhPT0gJ2NhbnZhcycpIHJldHVyblxyXG5cclxuICAgICAgY29uc3QgY2FudmFzVmlldyA9IGxlYWYudmlldyBhcyBDYW52YXNWaWV3XHJcbiAgICAgIC8vIEB0cy1pZ25vcmVcclxuICAgICAgY2FudmFzVmlldy5sZWFmLnJlYnVpbGRWaWV3KClcclxuICAgIH0pXHJcbiAgfVxyXG5cclxuICBwcml2YXRlIHBhdGNoTm9kZShub2RlOiBDYW52YXNOb2RlKSB7XHJcbiAgICBjb25zdCB0aGF0ID0gdGhpc1xyXG5cclxuICAgIHBhdGNoT2JqZWN0SW5zdGFuY2UodGhpcy5wbHVnaW4sIG5vZGUsIHtcclxuICAgICAgc2V0RGF0YTogKG5leHQ6IGFueSkgPT4gZnVuY3Rpb24gKC4uLmFyZ3M6IGFueSkge1xyXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IG5leHQuY2FsbCh0aGlzLCAuLi5hcmdzKVxyXG5cclxuICAgICAgICBpZiAobm9kZS5pbml0aWFsaXplZCAmJiAhbm9kZS5pc0RpcnR5KSB7XHJcbiAgICAgICAgICBub2RlLmlzRGlydHkgPSB0cnVlXHJcbiAgICAgICAgICB0aGF0LnRyaWdnZXJXb3Jrc3BhY2VFdmVudChDYW52YXNFdmVudC5Ob2RlQ2hhbmdlZCwgdGhpcy5jYW52YXMsIG5vZGUpXHJcbiAgICAgICAgICBkZWxldGUgbm9kZS5pc0RpcnR5XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyBTYXZlIHRoZSBkYXRhIHRvIHRoZSBmaWxlXHJcbiAgICAgICAgdGhpcy5jYW52YXMuZGF0YSA9IHRoaXMuY2FudmFzLmdldERhdGEoKVxyXG4gICAgICAgIHRoaXMuY2FudmFzLnZpZXcucmVxdWVzdFNhdmUoKVxyXG5cclxuICAgICAgICByZXR1cm4gcmVzdWx0XHJcbiAgICAgIH0sXHJcbiAgICAgIGdldEJCb3g6IChuZXh0OiBhbnkpID0+IGZ1bmN0aW9uICguLi5hcmdzOiBhbnkpIHtcclxuICAgICAgICBjb25zdCByZXN1bHQgPSBuZXh0LmNhbGwodGhpcywgLi4uYXJncylcclxuICAgICAgICB0aGF0LnRyaWdnZXJXb3Jrc3BhY2VFdmVudChDYW52YXNFdmVudC5Ob2RlQkJveFJlcXVlc3RlZCwgdGhpcy5jYW52YXMsIG5vZGUsIHJlc3VsdClcclxuICAgICAgICByZXR1cm4gcmVzdWx0XHJcbiAgICAgIH1cclxuICAgIH0pXHJcbiAgICBcclxuICAgIHRoaXMucnVuQWZ0ZXJJbml0aWFsaXplZChub2RlLCAoKSA9PiB7XHJcbiAgICAgIHRoaXMudHJpZ2dlcldvcmtzcGFjZUV2ZW50KENhbnZhc0V2ZW50Lk5vZGVBZGRlZCwgbm9kZS5jYW52YXMsIG5vZGUpXHJcbiAgICAgIHRoaXMudHJpZ2dlcldvcmtzcGFjZUV2ZW50KENhbnZhc0V2ZW50Lk5vZGVDaGFuZ2VkLCBub2RlLmNhbnZhcywgbm9kZSlcclxuICAgIH0pXHJcbiAgfVxyXG5cclxuICBwcml2YXRlIHBhdGNoRWRnZShlZGdlOiBDYW52YXNFZGdlKSB7XHJcbiAgICBjb25zdCB0aGF0ID0gdGhpc1xyXG5cclxuICAgIHBhdGNoT2JqZWN0SW5zdGFuY2UodGhpcy5wbHVnaW4sIGVkZ2UsIHtcclxuICAgICAgc2V0RGF0YTogKG5leHQ6IGFueSkgPT4gZnVuY3Rpb24gKC4uLmFyZ3M6IGFueSkge1xyXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IG5leHQuY2FsbCh0aGlzLCAuLi5hcmdzKVxyXG5cclxuICAgICAgICBpZiAoZWRnZS5pbml0aWFsaXplZCAmJiAhZWRnZS5pc0RpcnR5KSB7XHJcbiAgICAgICAgICBlZGdlLmlzRGlydHkgPSB0cnVlXHJcbiAgICAgICAgICB0aGF0LnRyaWdnZXJXb3Jrc3BhY2VFdmVudChDYW52YXNFdmVudC5FZGdlQ2hhbmdlZCwgdGhpcy5jYW52YXMsIGVkZ2UpXHJcbiAgICAgICAgICBkZWxldGUgZWRnZS5pc0RpcnR5XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyBTYXZlIHRoZSBkYXRhIHRvIHRoZSBmaWxlXHJcbiAgICAgICAgdGhpcy5jYW52YXMuZGF0YSA9IHRoaXMuY2FudmFzLmdldERhdGEoKVxyXG4gICAgICAgIHRoaXMuY2FudmFzLnZpZXcucmVxdWVzdFNhdmUoKVxyXG5cclxuICAgICAgICByZXR1cm4gcmVzdWx0XHJcbiAgICAgIH0sXHJcbiAgICAgIHJlbmRlcjogKG5leHQ6IGFueSkgPT4gZnVuY3Rpb24gKC4uLmFyZ3M6IGFueSkge1xyXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IG5leHQuY2FsbCh0aGlzLCAuLi5hcmdzKVxyXG4gICAgICAgIHRoYXQudHJpZ2dlcldvcmtzcGFjZUV2ZW50KENhbnZhc0V2ZW50LkVkZ2VDaGFuZ2VkLCB0aGlzLmNhbnZhcywgZWRnZSlcclxuICAgICAgICByZXR1cm4gcmVzdWx0XHJcbiAgICAgIH0sXHJcbiAgICAgIGdldENlbnRlcjogKG5leHQ6IGFueSkgPT4gZnVuY3Rpb24gKC4uLmFyZ3M6IGFueSkge1xyXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IG5leHQuY2FsbCh0aGlzLCAuLi5hcmdzKVxyXG4gICAgICAgIHRoYXQudHJpZ2dlcldvcmtzcGFjZUV2ZW50KENhbnZhc0V2ZW50LkVkZ2VDZW50ZXJSZXF1ZXN0ZWQsIHRoaXMuY2FudmFzLCBlZGdlLCByZXN1bHQpXHJcbiAgICAgICAgcmV0dXJuIHJlc3VsdFxyXG4gICAgICB9XHJcbiAgICB9KVxyXG4gICAgXHJcbiAgICB0aGlzLnJ1bkFmdGVySW5pdGlhbGl6ZWQoZWRnZSwgKCkgPT4ge1xyXG4gICAgICB0aGlzLnRyaWdnZXJXb3Jrc3BhY2VFdmVudChDYW52YXNFdmVudC5FZGdlQWRkZWQsIGVkZ2UuY2FudmFzLCBlZGdlKVxyXG4gICAgfSlcclxuICB9XHJcbiAgXHJcbiAgcHJpdmF0ZSBydW5BZnRlckluaXRpYWxpemVkKGNhbnZhc0VsZW1lbnQ6IENhbnZhc0VsZW1lbnQsIG9uUmVhZHk6ICgpID0+IHZvaWQpIHtcclxuICAgIGlmIChjYW52YXNFbGVtZW50LmluaXRpYWxpemVkKSB7XHJcbiAgICAgIG9uUmVhZHkoKVxyXG4gICAgICByZXR1cm5cclxuICAgIH1cclxuXHJcbiAgICBjb25zdCB0aGF0ID0gdGhpc1xyXG5cclxuICAgIC8vIFBhdGNoIENhbnZhc0VsZW1lbnQgb2JqZWN0XHJcbiAgICBjb25zdCB1bmluc3RhbGwgPSBhcm91bmQoY2FudmFzRWxlbWVudCwge1xyXG4gICAgICBpbml0aWFsaXplOiAobmV4dDogYW55KSA9PiBmdW5jdGlvbiAoLi4uYXJnczogYW55KSB7XHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gbmV4dC5jYWxsKHRoaXMsIC4uLmFyZ3MpXHJcblxyXG4gICAgICAgIG9uUmVhZHkoKVxyXG4gICAgICAgIHVuaW5zdGFsbCgpIC8vIFVuaW5zdGFsbCB0aGUgcGF0Y2hcclxuXHJcbiAgICAgICAgcmV0dXJuIHJlc3VsdFxyXG4gICAgICB9XHJcbiAgICB9KVxyXG5cclxuICAgIHRoYXQucGx1Z2luLnJlZ2lzdGVyKHVuaW5zdGFsbClcclxuICB9XHJcblxyXG4gIHByaXZhdGUgZW1pdEV2ZW50c0ZvclVua25vd25EYXRhQ2hhbmdlcyhjYW52YXM6IENhbnZhcykge1xyXG4gICAgLy8gSWYgbm9kZSBkYXRhIGNoYW5nZWRcclxuICAgIGNhbnZhcy5ub2Rlcy5mb3JFYWNoKChub2RlOiBDYW52YXNOb2RlKSA9PiB0aGlzLnJ1bkFmdGVySW5pdGlhbGl6ZWQobm9kZSwgKCkgPT4ge1xyXG4gICAgICB0aGlzLnRyaWdnZXJXb3Jrc3BhY2VFdmVudChDYW52YXNFdmVudC5Ob2RlQ2hhbmdlZCwgbm9kZS5jYW52YXMsIG5vZGUpXHJcbiAgICB9KSlcclxuXHJcbiAgICAvLyBJZiBlZGdlIGRhdGEgY2hhbmdlZFxyXG4gICAgY2FudmFzLmVkZ2VzLmZvckVhY2goKGVkZ2U6IENhbnZhc0VkZ2UpID0+IHRoaXMucnVuQWZ0ZXJJbml0aWFsaXplZChlZGdlLCAoKSA9PiB7XHJcbiAgICAgIHRoaXMudHJpZ2dlcldvcmtzcGFjZUV2ZW50KENhbnZhc0V2ZW50LkVkZ2VDaGFuZ2VkLCBlZGdlLmNhbnZhcywgZWRnZSlcclxuICAgIH0pKVxyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSB0cmlnZ2VyV29ya3NwYWNlRXZlbnQoZXZlbnQ6IHN0cmluZywgLi4uYXJnczogYW55KSB7XHJcbiAgICB0aGlzLnBsdWdpbi5hcHAud29ya3NwYWNlLnRyaWdnZXIoZXZlbnQsIC4uLmFyZ3MpXHJcbiAgfVxyXG59IiwgImltcG9ydCB7IENhbnZhcywgUG9zaXRpb24gfSBmcm9tIFwic3JjL0B0eXBlcy9DYW52YXNcIlxyXG5pbXBvcnQgKiBhcyBDYW52YXNIZWxwZXIgZnJvbSBcInNyYy91dGlscy9jYW52YXMtaGVscGVyXCJcclxuaW1wb3J0IEFkdmFuY2VkQ2FudmFzUGx1Z2luIGZyb20gXCJzcmMvbWFpblwiXHJcbmltcG9ydCB7IENhbnZhc0V2ZW50IH0gZnJvbSBcInNyYy9jb3JlL2V2ZW50c1wiXHJcblxyXG5jb25zdCBHUk9VUF9OT0RFX1NJWkUgPSB7IHdpZHRoOiAzMDAsIGhlaWdodDogMzAwIH1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEdyb3VwQ2FudmFzRXh0ZW5zaW9uIHtcclxuICBwbHVnaW46IEFkdmFuY2VkQ2FudmFzUGx1Z2luXHJcblxyXG4gIGNvbnN0cnVjdG9yKHBsdWdpbjogYW55KSB7XHJcbiAgICB0aGlzLnBsdWdpbiA9IHBsdWdpblxyXG5cclxuICAgIHRoaXMucGx1Z2luLnJlZ2lzdGVyRXZlbnQodGhpcy5wbHVnaW4uYXBwLndvcmtzcGFjZS5vbihcclxuICAgICAgQ2FudmFzRXZlbnQuQ2FudmFzQ2hhbmdlZCxcclxuICAgICAgKGNhbnZhczogQ2FudmFzKSA9PiB7XHJcbiAgICAgICAgQ2FudmFzSGVscGVyLmFkZENhcmRNZW51T3B0aW9uKFxyXG4gICAgICAgICAgY2FudmFzLFxyXG4gICAgICAgICAgQ2FudmFzSGVscGVyLmNyZWF0ZUNhcmRNZW51T3B0aW9uKFxyXG4gICAgICAgICAgICBjYW52YXMsXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICBpZDogJ2NyZWF0ZS1ncm91cCcsXHJcbiAgICAgICAgICAgICAgbGFiZWw6ICdEcmFnIHRvIGFkZCBncm91cCcsXHJcbiAgICAgICAgICAgICAgaWNvbjogJ2dyb3VwJ1xyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAoKSA9PiBHUk9VUF9OT0RFX1NJWkUsXHJcbiAgICAgICAgICAgIChjYW52YXM6IENhbnZhcywgcG9zOiBQb3NpdGlvbikgPT4ge1xyXG4gICAgICAgICAgICAgIGNhbnZhcy5jcmVhdGVHcm91cE5vZGUoe1xyXG4gICAgICAgICAgICAgICAgcG9zOiBwb3MsXHJcbiAgICAgICAgICAgICAgICBzaXplOiBHUk9VUF9OT0RFX1NJWkVcclxuICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICApXHJcbiAgICAgICAgKVxyXG4gICAgICB9XHJcbiAgICApKVxyXG4gIH1cclxufSIsICJpbXBvcnQgeyBNZW51LCBOb3RpY2UgfSBmcm9tICdvYnNpZGlhbidcclxuaW1wb3J0IHsgQkJveCwgQ2FudmFzLCBDYW52YXNFZGdlLCBDYW52YXNFbGVtZW50LCBDYW52YXNOb2RlLCBQb3NpdGlvbiwgU2l6ZSB9IGZyb20gJ3NyYy9AdHlwZXMvQ2FudmFzJ1xyXG5pbXBvcnQgQWR2YW5jZWRDYW52YXNQbHVnaW4gZnJvbSAnc3JjL21haW4nXHJcbmltcG9ydCB7IENhbnZhc0V2ZW50IH0gZnJvbSAnc3JjL2NvcmUvZXZlbnRzJ1xyXG5pbXBvcnQgKiBhcyBDYW52YXNIZWxwZXIgZnJvbSBcInNyYy91dGlscy9jYW52YXMtaGVscGVyXCJcclxuaW1wb3J0ICogYXMgQkJveEhlbHBlciBmcm9tIFwic3JjL3V0aWxzL2Jib3gtaGVscGVyXCJcclxuXHJcbmNvbnN0IFNUQVJUX1NMSURFX05BTUUgPSAnU3RhcnQgU2xpZGUnXHJcbmNvbnN0IERFRkFVTFRfU0xJREVfTkFNRSA9ICdOZXcgU2xpZGUnXHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQcmVzZW50YXRpb25DYW52YXNFeHRlbnNpb24ge1xyXG4gIHBsdWdpbjogQWR2YW5jZWRDYW52YXNQbHVnaW5cclxuICBzYXZlZFZpZXdwb3J0OiBhbnkgPSBudWxsXHJcbiAgaXNQcmVzZW50YXRpb25Nb2RlOiBib29sZWFuID0gZmFsc2VcclxuICB2aXNpdGVkTm9kZXM6IGFueVtdID0gW11cclxuXHJcbiAgY29uc3RydWN0b3IocGx1Z2luOiBhbnkpIHtcclxuICAgIHRoaXMucGx1Z2luID0gcGx1Z2luXHJcblxyXG4gICAgaWYgKCF0aGlzLnBsdWdpbi5zZXR0aW5ncy5nZXRTZXR0aW5nKCdwcmVzZW50YXRpb25GZWF0dXJlRW5hYmxlZCcpKSByZXR1cm5cclxuXHJcbiAgICAvKiBBZGQgd3JhcCBpbiBzbGlkZSBvcHRpb24gdG8gY29udGV4dCBtZW51ICovXHJcbiAgICB0aGlzLnBsdWdpbi5yZWdpc3RlckV2ZW50KHRoaXMucGx1Z2luLmFwcC53b3Jrc3BhY2Uub24oXHJcbiAgICAgICdjYW52YXM6c2VsZWN0aW9uLW1lbnUnLFxyXG4gICAgICAobWVudTogTWVudSwgY2FudmFzOiBDYW52YXMpID0+IHtcclxuICAgICAgICBtZW51LmFkZEl0ZW0oKGl0ZW0pID0+XHJcbiAgICAgICAgICBpdGVtXHJcbiAgICAgICAgICAgIC5zZXRUaXRsZSgnV3JhcCBpbiBzbGlkZScpXHJcbiAgICAgICAgICAgIC5zZXRJY29uKCdnYWxsZXJ5LXZlcnRpY2FsJylcclxuICAgICAgICAgICAgLm9uQ2xpY2soKCkgPT4gdGhpcy5hZGRTbGlkZShjYW52YXMsIHVuZGVmaW5lZCwgXHJcbiAgICAgICAgICAgICAgQkJveEhlbHBlci5lbmxhcmdlQkJveChCQm94SGVscGVyLmNvbWJpbmVCQm94ZXMoXHJcbiAgICAgICAgICAgICAgICBbLi4uY2FudmFzLnNlbGVjdGlvbi52YWx1ZXMoKV0ubWFwKChlbGVtZW50OiBDYW52YXNFbGVtZW50KSA9PiBlbGVtZW50LmdldEJCb3goKSlcclxuICAgICAgICAgICAgICApLCB0aGlzLnBsdWdpbi5zZXR0aW5ncy5nZXRTZXR0aW5nKCd3cmFwSW5TbGlkZVBhZGRpbmcnKSlcclxuICAgICAgICAgICAgKSlcclxuICAgICAgICApXHJcbiAgICAgIH1cclxuICAgICkpXHJcblxyXG4gICAgdGhpcy5wbHVnaW4uYWRkQ29tbWFuZCh7XHJcblx0XHRcdGlkOiAnY3JlYXRlLW5ldy1zbGlkZScsXHJcblx0XHRcdG5hbWU6ICdDcmVhdGUgbmV3IHNsaWRlJyxcclxuXHRcdFx0Y2hlY2tDYWxsYmFjazogQ2FudmFzSGVscGVyLmNhbnZhc0NvbW1hbmQoXHJcbiAgICAgICAgdGhpcy5wbHVnaW4sXHJcbiAgICAgICAgKGNhbnZhczogQ2FudmFzKSA9PiAhY2FudmFzLnJlYWRvbmx5ICYmICF0aGlzLmlzUHJlc2VudGF0aW9uTW9kZSxcclxuICAgICAgICAoY2FudmFzOiBDYW52YXMpID0+IHRoaXMuYWRkU2xpZGUoY2FudmFzKVxyXG4gICAgICApXHJcbiAgICB9KVxyXG5cclxuICAgIHRoaXMucGx1Z2luLmFkZENvbW1hbmQoe1xyXG5cdFx0XHRpZDogJ3N0YXJ0LXByZXNlbnRhdGlvbicsXHJcbiAgICAgIG5hbWU6ICdTdGFydCBwcmVzZW50YXRpb24nLFxyXG4gICAgICBjaGVja0NhbGxiYWNrOiBDYW52YXNIZWxwZXIuY2FudmFzQ29tbWFuZChcclxuICAgICAgICB0aGlzLnBsdWdpbixcclxuICAgICAgICAoX2NhbnZhczogQ2FudmFzKSA9PiAhdGhpcy5pc1ByZXNlbnRhdGlvbk1vZGUsXHJcbiAgICAgICAgKGNhbnZhczogQ2FudmFzKSA9PiB0aGlzLnN0YXJ0UHJlc2VudGF0aW9uKGNhbnZhcylcclxuICAgICAgKVxyXG4gICAgfSlcclxuXHJcbiAgICB0aGlzLnBsdWdpbi5hZGRDb21tYW5kKHtcclxuICAgICAgaWQ6ICdwcmV2aW91cy1ub2RlJyxcclxuICAgICAgbmFtZTogJ1ByZXZpb3VzIG5vZGUnLFxyXG4gICAgICBjaGVja0NhbGxiYWNrOiBDYW52YXNIZWxwZXIuY2FudmFzQ29tbWFuZChcclxuICAgICAgICB0aGlzLnBsdWdpbixcclxuICAgICAgICAoX2NhbnZhczogQ2FudmFzKSA9PiB0aGlzLmlzUHJlc2VudGF0aW9uTW9kZSxcclxuICAgICAgICAoY2FudmFzOiBDYW52YXMpID0+IHRoaXMucHJldmlvdXNOb2RlKGNhbnZhcylcclxuICAgICAgKVxyXG4gICAgfSlcclxuXHJcbiAgICB0aGlzLnBsdWdpbi5hZGRDb21tYW5kKHtcclxuXHRcdFx0aWQ6ICduZXh0LW5vZGUnLFxyXG4gICAgICBuYW1lOiAnTmV4dCBub2RlJyxcclxuICAgICAgY2hlY2tDYWxsYmFjazogQ2FudmFzSGVscGVyLmNhbnZhc0NvbW1hbmQoXHJcbiAgICAgICAgdGhpcy5wbHVnaW4sXHJcbiAgICAgICAgKF9jYW52YXM6IENhbnZhcykgPT4gdGhpcy5pc1ByZXNlbnRhdGlvbk1vZGUsXHJcbiAgICAgICAgKGNhbnZhczogQ2FudmFzKSA9PiB0aGlzLm5leHROb2RlKGNhbnZhcylcclxuICAgICAgKVxyXG4gICAgfSlcclxuXHJcbiAgICAvLyBSZWdpc3RlciBldmVudHNcclxuICAgIHRoaXMucGx1Z2luLnJlZ2lzdGVyRXZlbnQodGhpcy5wbHVnaW4uYXBwLndvcmtzcGFjZS5vbihcclxuICAgICAgQ2FudmFzRXZlbnQuQ2FudmFzQ2hhbmdlZCxcclxuICAgICAgKGNhbnZhczogQ2FudmFzKSA9PiB0aGlzLm9uQ2FudmFzQ2hhbmdlZChjYW52YXMpXHJcbiAgICApKVxyXG5cclxuICAgIHRoaXMucGx1Z2luLnJlZ2lzdGVyRXZlbnQodGhpcy5wbHVnaW4uYXBwLndvcmtzcGFjZS5vbihcclxuICAgICAgQ2FudmFzRXZlbnQuUG9wdXBNZW51Q3JlYXRlZCxcclxuICAgICAgKGNhbnZhczogQ2FudmFzKSA9PiB0aGlzLm9uUG9wdXBNZW51Q3JlYXRlZChjYW52YXMpXHJcbiAgICApKVxyXG5cclxuICAgIHRoaXMucGx1Z2luLnJlZ2lzdGVyRXZlbnQodGhpcy5wbHVnaW4uYXBwLndvcmtzcGFjZS5vbihcclxuICAgICAgQ2FudmFzRXZlbnQuTm9kZU1vdmVkLFxyXG4gICAgICAoY2FudmFzOiBDYW52YXMsIG5vZGU6IENhbnZhc05vZGUpID0+IHRoaXMub25Ob2RlTW92ZWQoY2FudmFzLCBub2RlKVxyXG4gICAgKSlcclxuICB9XHJcblxyXG4gIG9uQ2FudmFzQ2hhbmdlZChjYW52YXM6IENhbnZhcyk6IHZvaWQge1xyXG4gICAgQ2FudmFzSGVscGVyLmFkZENhcmRNZW51T3B0aW9uKFxyXG4gICAgICBjYW52YXMsXHJcbiAgICAgIENhbnZhc0hlbHBlci5jcmVhdGVDYXJkTWVudU9wdGlvbihcclxuICAgICAgICBjYW52YXMsXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgaWQ6ICduZXctc2xpZGUnLFxyXG4gICAgICAgICAgbGFiZWw6ICdEcmFnIHRvIGFkZCBzbGlkZScsXHJcbiAgICAgICAgICBpY29uOiAnZ2FsbGVyeS12ZXJ0aWNhbCdcclxuICAgICAgICB9LFxyXG4gICAgICAgICgpID0+IHRoaXMuZ2V0RGVmYXVsdFNsaWRlU2l6ZSgpLFxyXG4gICAgICAgIChjYW52YXM6IENhbnZhcywgcG9zOiBQb3NpdGlvbikgPT4gdGhpcy5hZGRTbGlkZShjYW52YXMsIHBvcylcclxuICAgICAgKVxyXG4gICAgKVxyXG4gIH1cclxuXHJcbiAgb25Qb3B1cE1lbnVDcmVhdGVkKGNhbnZhczogQ2FudmFzKTogdm9pZCB7XHJcbiAgICAvLyBJZiB0aGUgY2FudmFzIGlzIHJlYWRvbmx5IG9yIHRoZXJlIGFyZSBtdWx0aXBsZS9ubyBub2RlcyBzZWxlY3RlZCwgcmV0dXJuXHJcbiAgICBjb25zdCBzZWxlY3RlZE5vZGVzRGF0YSA9IGNhbnZhcy5nZXRTZWxlY3Rpb25EYXRhKCkubm9kZXNcclxuICAgIGlmIChjYW52YXMucmVhZG9ubHkgfHwgc2VsZWN0ZWROb2Rlc0RhdGEubGVuZ3RoICE9PSAxIHx8IGNhbnZhcy5zZWxlY3Rpb24uc2l6ZSA+IDEpIHJldHVyblxyXG4gICAgXHJcbiAgICBjb25zdCBzZWxlY3RlZE5vZGUgPSBjYW52YXMubm9kZXMuZ2V0KHNlbGVjdGVkTm9kZXNEYXRhWzBdLmlkKVxyXG4gICAgaWYgKCFzZWxlY3RlZE5vZGUpIHJldHVyblxyXG4gICAgXHJcbiAgICBDYW52YXNIZWxwZXIuYWRkUG9wdXBNZW51T3B0aW9uKFxyXG4gICAgICBjYW52YXMsXHJcbiAgICAgIENhbnZhc0hlbHBlci5jcmVhdGVQb3B1cE1lbnVPcHRpb24oe1xyXG4gICAgICAgIGlkOiAnc3RhcnQtbm9kZScsIFxyXG4gICAgICAgIGxhYmVsOiAnU2V0IGFzIHN0YXJ0IHNsaWRlJywgXHJcbiAgICAgICAgaWNvbjogJ3BsYXknLCBcclxuICAgICAgICBjYWxsYmFjazogKCkgPT4gdGhpcy5zZXRTdGFydE5vZGUoY2FudmFzLCBzZWxlY3RlZE5vZGUpXHJcbiAgICAgIH0pXHJcbiAgICApXHJcbiAgfVxyXG5cclxuICBwcml2YXRlIG9uTm9kZU1vdmVkKF9jYW52YXM6IENhbnZhcywgbm9kZTogQ2FudmFzTm9kZSkge1xyXG4gICAgY29uc3Qgbm9kZURhdGEgPSBub2RlLmdldERhdGEoKVxyXG4gICAgaWYgKCFub2RlRGF0YS5zaWRlUmF0aW8pIHJldHVyblxyXG5cclxuICAgIGNvbnN0IG5vZGVCQm94ID0gbm9kZS5nZXRCQm94KClcclxuICAgIGNvbnN0IG5vZGVTaXplID0ge1xyXG4gICAgICB3aWR0aDogbm9kZUJCb3gubWF4WCAtIG5vZGVCQm94Lm1pblgsXHJcbiAgICAgIGhlaWdodDogbm9kZUJCb3gubWF4WSAtIG5vZGVCQm94Lm1pbllcclxuICAgIH1cclxuICAgIGNvbnN0IG5vZGVBc3BlY3RSYXRpbyA9IG5vZGVTaXplLndpZHRoIC8gbm9kZVNpemUuaGVpZ2h0XHJcblxyXG4gICAgaWYgKG5vZGVBc3BlY3RSYXRpbyA8IG5vZGVEYXRhLnNpZGVSYXRpbylcclxuICAgICAgbm9kZVNpemUud2lkdGggPSBub2RlU2l6ZS5oZWlnaHQgKiBub2RlRGF0YS5zaWRlUmF0aW9cclxuICAgIGVsc2Ugbm9kZVNpemUuaGVpZ2h0ID0gbm9kZVNpemUud2lkdGggLyBub2RlRGF0YS5zaWRlUmF0aW9cclxuXHJcbiAgICBub2RlLnNldERhdGEoe1xyXG4gICAgICAuLi5ub2RlRGF0YSxcclxuICAgICAgd2lkdGg6IG5vZGVTaXplLndpZHRoLFxyXG4gICAgICBoZWlnaHQ6IG5vZGVTaXplLmhlaWdodFxyXG4gICAgfSlcclxuICB9XHJcbiAgXHJcbiAgcHJpdmF0ZSBnZXRTdGFydE5vZGUoY2FudmFzOiBDYW52YXMpOiBDYW52YXNOb2RlfHVuZGVmaW5lZCB7XHJcbiAgICBmb3IgKGNvbnN0IFtfLCBub2RlXSBvZiBjYW52YXMubm9kZXMpIHtcclxuICAgICAgaWYgKG5vZGUuZ2V0RGF0YSgpLmlzU3RhcnROb2RlKSByZXR1cm4gbm9kZVxyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiB1bmRlZmluZWRcclxuICB9XHJcblxyXG4gIHByaXZhdGUgc2V0U3RhcnROb2RlKGNhbnZhczogQ2FudmFzLCBub2RlOiBDYW52YXNOb2RlfHVuZGVmaW5lZCkge1xyXG4gICAgaWYgKCFub2RlKSByZXR1cm5cclxuXHJcbiAgICBjb25zdCBzdGFydE5vZGUgPSB0aGlzLmdldFN0YXJ0Tm9kZShjYW52YXMpXHJcbiAgICBpZiAoc3RhcnROb2RlKSBzdGFydE5vZGUuc2V0RGF0YSh7IC4uLnN0YXJ0Tm9kZS5nZXREYXRhKCksIGlzU3RhcnROb2RlOiBmYWxzZSB9KVxyXG5cclxuICAgIGlmIChub2RlICE9PSBzdGFydE5vZGUpIG5vZGUuc2V0RGF0YSh7IC4uLm5vZGUuZ2V0RGF0YSgpLCBpc1N0YXJ0Tm9kZTogdHJ1ZSB9KVxyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBnZXREZWZhdWx0U2xpZGVTaXplKCk6IFNpemUge1xyXG4gICAgY29uc3Qgc2xpZGVTaXplU3RyaW5nID0gdGhpcy5wbHVnaW4uc2V0dGluZ3MuZ2V0U2V0dGluZygnZGVmYXVsdFNsaWRlU2l6ZScpXHJcbiAgICBjb25zdCBzbGlkZVNpemVBcnJheSA9IHNsaWRlU2l6ZVN0cmluZy5zcGxpdCgneCcpLm1hcCgodmFsdWU6IHN0cmluZykgPT4gcGFyc2VJbnQodmFsdWUpKVxyXG4gICAgcmV0dXJuIHsgd2lkdGg6IHNsaWRlU2l6ZUFycmF5WzBdLCBoZWlnaHQ6IHNsaWRlU2l6ZUFycmF5WzFdIH1cclxuICB9XHJcblxyXG4gIHByaXZhdGUgZ2V0U2xpZGVBc3BlY3RSYXRpbygpOiBudW1iZXIge1xyXG4gICAgY29uc3Qgc2xpZGVTaXplID0gdGhpcy5nZXREZWZhdWx0U2xpZGVTaXplKClcclxuICAgIHJldHVybiBzbGlkZVNpemUud2lkdGggLyBzbGlkZVNpemUuaGVpZ2h0XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGFkZFNsaWRlKGNhbnZhczogQ2FudmFzLCBwb3M/OiBQb3NpdGlvbiwgYmJveD86IEJCb3gpIHtcclxuICAgIGNvbnN0IGlzU3RhcnROb2RlID0gdGhpcy5nZXRTdGFydE5vZGUoY2FudmFzKSA9PSBudWxsXHJcbiAgICBjb25zdCBzbGlkZVNpemUgPSB0aGlzLmdldERlZmF1bHRTbGlkZVNpemUoKVxyXG4gICAgY29uc3Qgc2xpZGVBc3BlY3RSYXRpbyA9IHRoaXMuZ2V0U2xpZGVBc3BlY3RSYXRpbygpXHJcblxyXG4gICAgaWYgKGJib3gpIHtcclxuICAgICAgY29uc3QgYmJveFdpZHRoID0gYmJveC5tYXhYIC0gYmJveC5taW5YXHJcbiAgICAgIGNvbnN0IGJib3hIZWlnaHQgPSBiYm94Lm1heFkgLSBiYm94Lm1pbllcclxuXHJcbiAgICAgIC8vIE1ha2Ugc3VyZSB0aGUgbm9kZXMgZml0IGluc2lkZSB0aGUgYm91bmRpbmcgYm94IHdoaWxlIGtlZXBpbmcgdGhlIGFzcGVjdCByYXRpb1xyXG4gICAgICBpZiAoYmJveFdpZHRoIC8gYmJveEhlaWdodCA+IHNsaWRlQXNwZWN0UmF0aW8pIHtcclxuICAgICAgICBzbGlkZVNpemUud2lkdGggPSBiYm94V2lkdGhcclxuICAgICAgICBzbGlkZVNpemUuaGVpZ2h0ID0gYmJveFdpZHRoIC8gc2xpZGVBc3BlY3RSYXRpb1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIHNsaWRlU2l6ZS5oZWlnaHQgPSBiYm94SGVpZ2h0XHJcbiAgICAgICAgc2xpZGVTaXplLndpZHRoID0gYmJveEhlaWdodCAqIHNsaWRlQXNwZWN0UmF0aW9cclxuICAgICAgfVxyXG4gICAgICBcclxuICAgICAgcG9zID0geyBcclxuICAgICAgICB4OiBiYm94Lm1pblgsXHJcbiAgICAgICAgeTogYmJveC5taW5ZXHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvLyBJZiBubyBwb3NpdGlvbiBpcyBwcm92aWRlZCwgdXNlIHRoZSBjZW50ZXIgb2YgdGhlIGNhbnZhc1xyXG4gICAgaWYgKCFwb3MpIHBvcyA9IENhbnZhc0hlbHBlci5nZXRDZW50ZXJDb29yZGluYXRlcyhjYW52YXMsIHRoaXMuZ2V0RGVmYXVsdFNsaWRlU2l6ZSgpKVxyXG5cclxuICAgIGNvbnN0IGdyb3VwTm9kZSA9IGNhbnZhcy5jcmVhdGVHcm91cE5vZGUoe1xyXG4gICAgICBwb3M6IHBvcyxcclxuICAgICAgc2l6ZTogc2xpZGVTaXplLFxyXG4gICAgICBsYWJlbDogaXNTdGFydE5vZGUgPyBTVEFSVF9TTElERV9OQU1FIDogREVGQVVMVF9TTElERV9OQU1FLFxyXG4gICAgICBmb2N1czogZmFsc2UsXHJcbiAgICB9KVxyXG5cclxuICAgIGdyb3VwTm9kZS5zZXREYXRhKHsgXHJcbiAgICAgIC4uLmdyb3VwTm9kZS5nZXREYXRhKCksIFxyXG4gICAgICBzaWRlUmF0aW86IHNsaWRlQXNwZWN0UmF0aW8sXHJcbiAgICAgIGlzU3RhcnROb2RlOiBpc1N0YXJ0Tm9kZSA/IHRydWUgOiB1bmRlZmluZWQsXHJcbiAgICB9KVxyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBhc3luYyBhbmltYXRlTm9kZVRyYW5zaXRpb24oY2FudmFzOiBDYW52YXMsIGZyb21Ob2RlOiBDYW52YXNOb2RlfHVuZGVmaW5lZCwgdG9Ob2RlOiBDYW52YXNOb2RlKSB7XHJcbiAgICBjb25zdCB1c2VDdXN0b21ab29tRnVuY3Rpb24gPSB0aGlzLnBsdWdpbi5zZXR0aW5ncy5nZXRTZXR0aW5nKCd6b29tVG9TbGlkZVdpdGhvdXRQYWRkaW5nJylcclxuICAgIGNvbnN0IGFuaW1hdGlvbkR1cmF0aW9uTXMgPSB0aGlzLnBsdWdpbi5zZXR0aW5ncy5nZXRTZXR0aW5nKCdzbGlkZVRyYW5zaXRpb25BbmltYXRpb25EdXJhdGlvbicpICogMTAwMFxyXG4gICAgXHJcbiAgICBpZiAoYW5pbWF0aW9uRHVyYXRpb25NcyA+IDAgJiYgZnJvbU5vZGUpIHtcclxuICAgICAgY29uc3QgYW5pbWF0aW9uSW50ZW5zaXR5ID0gdGhpcy5wbHVnaW4uc2V0dGluZ3MuZ2V0U2V0dGluZygnc2xpZGVUcmFuc2l0aW9uQW5pbWF0aW9uSW50ZW5zaXR5JylcclxuXHJcbiAgICAgIGNvbnN0IGN1cnJlbnROb2RlQkJveEVubGFyZ2VkID0gQkJveEhlbHBlci5zY2FsZUJCb3goZnJvbU5vZGUuZ2V0QkJveCgpLCBhbmltYXRpb25JbnRlbnNpdHkpXHJcbiAgICAgIGlmICh1c2VDdXN0b21ab29tRnVuY3Rpb24pIENhbnZhc0hlbHBlci56b29tVG9CQm94KGNhbnZhcywgY3VycmVudE5vZGVCQm94RW5sYXJnZWQpXHJcbiAgICAgIGVsc2UgY2FudmFzLnpvb21Ub0Jib3goY3VycmVudE5vZGVCQm94RW5sYXJnZWQpXHJcblxyXG4gICAgICBhd2FpdCBzbGVlcChhbmltYXRpb25EdXJhdGlvbk1zIC8gMilcclxuXHJcbiAgICAgIGNvbnN0IG5leHROb2RlQkJveEVubGFyZ2VkID0gQkJveEhlbHBlci5zY2FsZUJCb3godG9Ob2RlLmdldEJCb3goKSwgYW5pbWF0aW9uSW50ZW5zaXR5KVxyXG4gICAgICBpZiAodXNlQ3VzdG9tWm9vbUZ1bmN0aW9uKSBDYW52YXNIZWxwZXIuem9vbVRvQkJveChjYW52YXMsIG5leHROb2RlQkJveEVubGFyZ2VkKVxyXG4gICAgICBlbHNlIGNhbnZhcy56b29tVG9CYm94KG5leHROb2RlQkJveEVubGFyZ2VkKVxyXG5cclxuICAgICAgYXdhaXQgc2xlZXAoYW5pbWF0aW9uRHVyYXRpb25NcyAvIDIpXHJcbiAgICB9XHJcblxyXG4gICAgbGV0IG5vZGVCQm94ID0gdG9Ob2RlLmdldEJCb3goKVxyXG4gICAgaWYgKHVzZUN1c3RvbVpvb21GdW5jdGlvbikgQ2FudmFzSGVscGVyLnpvb21Ub0JCb3goY2FudmFzLCBub2RlQkJveClcclxuICAgIGVsc2UgY2FudmFzLnpvb21Ub0Jib3gobm9kZUJCb3gpXHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGFzeW5jIHN0YXJ0UHJlc2VudGF0aW9uKGNhbnZhczogQ2FudmFzKSB7XHJcbiAgICBjb25zdCBzdGFydE5vZGUgPSB0aGlzLmdldFN0YXJ0Tm9kZShjYW52YXMpXHJcbiAgICBpZiAoIXN0YXJ0Tm9kZSkge1xyXG4gICAgICBuZXcgTm90aWNlKCdObyBzdGFydCBub2RlIGZvdW5kLiBQbGVhc2UgbWFyayBhIG5vZGUgYXMgYSBzdGFydCBub2RlIHRyb3VnaCB0aGUgcG9wdXAgbWVudS4nKVxyXG4gICAgICByZXR1cm5cclxuICAgIH1cclxuXHJcbiAgICB0aGlzLnZpc2l0ZWROb2RlcyA9IFtdXHJcbiAgICB0aGlzLnNhdmVkVmlld3BvcnQgPSB7XHJcbiAgICAgIHg6IGNhbnZhcy50eCxcclxuICAgICAgeTogY2FudmFzLnR5LFxyXG4gICAgICB6b29tOiBjYW52YXMudFpvb20sXHJcbiAgICB9XHJcblxyXG4gICAgLy8gRW50ZXIgZnVsbHNjcmVlbiBtb2RlXHJcbiAgICBjYW52YXMud3JhcHBlckVsLmZvY3VzKClcclxuICAgIGNhbnZhcy53cmFwcGVyRWwucmVxdWVzdEZ1bGxzY3JlZW4oKVxyXG4gICAgY2FudmFzLndyYXBwZXJFbC5jbGFzc0xpc3QuYWRkKCdwcmVzZW50YXRpb24tbW9kZScpXHJcblxyXG4gICAgLy8gTG9jayBjYW52YXNcclxuICAgIGNhbnZhcy5zZXRSZWFkb25seSh0cnVlKVxyXG5cclxuICAgIC8vIFJlZ2lzdGVyIGV2ZW50IGhhbmRsZXIgZm9yIGtleWJvYXJkIG5hdmlnYXRpb25cclxuICAgIGlmICh0aGlzLnBsdWdpbi5zZXR0aW5ncy5nZXRTZXR0aW5nKCd1c2VBcnJvd0tleXNUb0NoYW5nZVNsaWRlcycpKSB7XHJcbiAgICAgIGNhbnZhcy53cmFwcGVyRWwub25rZXlkb3duID0gKGU6IGFueSkgPT4ge1xyXG4gICAgICAgIGlmIChlLmtleSA9PT0gJ0Fycm93UmlnaHQnKSB0aGlzLm5leHROb2RlKGNhbnZhcylcclxuICAgICAgICBlbHNlIGlmIChlLmtleSA9PT0gJ0Fycm93TGVmdCcpIHRoaXMucHJldmlvdXNOb2RlKGNhbnZhcylcclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8vIEtlZXAgbW9kYWxzIHdoaWxlIGluIGZ1bGxzY3JlZW4gbW9kZVxyXG4gICAgY29uc3QgZnVsbHNjcmVlbk1vZGFsT2JzZXJ2ZXIgPSBuZXcgTXV0YXRpb25PYnNlcnZlcigobXV0YXRpb25SZWNvcmRzKSA9PiB7XHJcbiAgICAgIG11dGF0aW9uUmVjb3Jkcy5mb3JFYWNoKChtdXRhdGlvblJlY29yZCkgPT4ge1xyXG4gICAgICAgIG11dGF0aW9uUmVjb3JkLmFkZGVkTm9kZXMuZm9yRWFjaCgobm9kZSkgPT4ge1xyXG4gICAgICAgICAgZG9jdW1lbnQuYm9keS5yZW1vdmVDaGlsZChub2RlKVxyXG4gICAgICAgICAgZG9jdW1lbnQuZnVsbHNjcmVlbkVsZW1lbnQ/LmFwcGVuZENoaWxkKG5vZGUpXHJcbiAgICAgICAgfSlcclxuICAgICAgfSlcclxuXHJcbiAgICAgIGNvbnN0IGlucHV0RmllbGQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb21wdC1pbnB1dFwiKSBhcyBIVE1MSW5wdXRFbGVtZW50fG51bGxcclxuICAgICAgaWYgKGlucHV0RmllbGQpIGlucHV0RmllbGQuZm9jdXMoKVxyXG4gICAgfSlcclxuICAgIGZ1bGxzY3JlZW5Nb2RhbE9ic2VydmVyLm9ic2VydmUoZG9jdW1lbnQuYm9keSwgeyBjaGlsZExpc3Q6IHRydWUgfSlcclxuXHJcbiAgICAvLyBSZWdpc3RlciBldmVudCBoYW5kbGVyIGZvciBleGl0aW5nIHByZXNlbnRhdGlvbiBtb2RlXHJcbiAgICBjYW52YXMud3JhcHBlckVsLm9uZnVsbHNjcmVlbmNoYW5nZSA9IChfZTogYW55KSA9PiB7XHJcbiAgICAgIGlmIChkb2N1bWVudC5mdWxsc2NyZWVuRWxlbWVudCkgcmV0dXJuXHJcblxyXG4gICAgICBmdWxsc2NyZWVuTW9kYWxPYnNlcnZlci5kaXNjb25uZWN0KClcclxuICAgICAgdGhpcy5lbmRQcmVzZW50YXRpb24oY2FudmFzKVxyXG4gICAgfVxyXG5cclxuICAgIHRoaXMuaXNQcmVzZW50YXRpb25Nb2RlID0gdHJ1ZVxyXG5cclxuICAgIC8vIFdhaXQgZm9yIGZ1bGxzY3JlZW4gdG8gYmUgZW5hYmxlZFxyXG4gICAgYXdhaXQgc2xlZXAoNTAwKVxyXG5cclxuICAgIC8vIFpvb20gdG8gZmlyc3Qgbm9kZVxyXG4gICAgdGhpcy52aXNpdGVkTm9kZXMucHVzaChzdGFydE5vZGUpXHJcbiAgICB0aGlzLmFuaW1hdGVOb2RlVHJhbnNpdGlvbihjYW52YXMsIHVuZGVmaW5lZCwgc3RhcnROb2RlKVxyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBlbmRQcmVzZW50YXRpb24oY2FudmFzOiBDYW52YXMpIHtcclxuICAgIC8vIFVucmVnaXN0ZXIgZXZlbnQgaGFuZGxlcnNcclxuICAgIGNhbnZhcy53cmFwcGVyRWwub25rZXlkb3duID0gbnVsbFxyXG4gICAgY2FudmFzLndyYXBwZXJFbC5vbmZ1bGxzY3JlZW5jaGFuZ2UgPSBudWxsXHJcblxyXG4gICAgLy8gVW5sb2NrIGNhbnZhc1xyXG4gICAgY2FudmFzLnNldFJlYWRvbmx5KGZhbHNlKVxyXG5cclxuICAgIC8vIEV4aXQgZnVsbHNjcmVlbiBtb2RlXHJcbiAgICBjYW52YXMud3JhcHBlckVsLmNsYXNzTGlzdC5yZW1vdmUoJ3ByZXNlbnRhdGlvbi1tb2RlJylcclxuICAgIGlmIChkb2N1bWVudC5mdWxsc2NyZWVuRWxlbWVudCkgZG9jdW1lbnQuZXhpdEZ1bGxzY3JlZW4oKVxyXG5cclxuICAgIC8vIFJlc2V0IHZpZXdwb3J0XHJcbiAgICBjYW52YXMuc2V0Vmlld3BvcnQodGhpcy5zYXZlZFZpZXdwb3J0LngsIHRoaXMuc2F2ZWRWaWV3cG9ydC55LCB0aGlzLnNhdmVkVmlld3BvcnQuem9vbSlcclxuICAgIHRoaXMuaXNQcmVzZW50YXRpb25Nb2RlID0gZmFsc2VcclxuICB9XHJcblxyXG4gIHByaXZhdGUgbmV4dE5vZGUoY2FudmFzOiBDYW52YXMpIHtcclxuICAgIGNvbnN0IGZyb21Ob2RlID0gdGhpcy52aXNpdGVkTm9kZXMubGFzdCgpXHJcbiAgICBpZiAoIWZyb21Ob2RlKSByZXR1cm5cclxuXHJcbiAgICBjb25zdCBvdXRnb2luZ0VkZ2VzID0gY2FudmFzLmdldEVkZ2VzRm9yTm9kZShmcm9tTm9kZSkuZmlsdGVyKChlZGdlOiBDYW52YXNFZGdlKSA9PiBlZGdlLmZyb20ubm9kZSA9PT0gZnJvbU5vZGUpXHJcbiAgICBsZXQgdG9Ob2RlID0gb3V0Z29pbmdFZGdlcy5maXJzdCgpPy50by5ub2RlXHJcblxyXG4gICAgLy8gSWYgdGhlcmUgYXJlIG11bHRpcGxlIG91dGdvaW5nIGVkZ2VzLCB3ZSBuZWVkIHRvIGxvb2sgYXQgdGhlIGVkZ2UgbGFiZWxcclxuICAgIGlmIChvdXRnb2luZ0VkZ2VzLmxlbmd0aCA+IDEpIHtcclxuICAgICAgLy8gQ3JlYXRlIG1hcCBvZiBlZGdlIGxhYmVscyB0byBub2Rlc1xyXG4gICAgICBjb25zdCBzb3J0ZWRFZGdlcyA9IG91dGdvaW5nRWRnZXNcclxuICAgICAgICAuc29ydCgoYTogQ2FudmFzRWRnZSwgYjogQ2FudmFzRWRnZSkgPT4ge1xyXG4gICAgICAgICAgaWYgKCFhLmxhYmVsKSByZXR1cm4gMVxyXG4gICAgICAgICAgaWYgKCFiLmxhYmVsKSByZXR1cm4gLTFcclxuXHJcbiAgICAgICAgICByZXR1cm4gYS5sYWJlbC5sb2NhbGVDb21wYXJlKGIubGFiZWwpXHJcbiAgICAgICAgfSlcclxuXHJcbiAgICAgIC8vIEZpbmQgd2hpY2ggZWRnZXMgYWxyZWFkeSBoYXZlIGJlZW4gdHJhdmVyc2VkXHJcbiAgICAgIGNvbnN0IHRyYXZlcnNlZEVkZ2VzQ291bnQgPSB0aGlzLnZpc2l0ZWROb2Rlc1xyXG4gICAgICAgIC5maWx0ZXIoKHZpc2l0ZWROb2RlOiBDYW52YXNOb2RlKSA9PiB2aXNpdGVkTm9kZSA9PSBmcm9tTm9kZSkubGVuZ3RoIC0gMVxyXG5cclxuICAgICAgLy8gU2VsZWN0IG5leHQgZWRnZVxyXG4gICAgICBjb25zdCBuZXh0RWRnZSA9IHNvcnRlZEVkZ2VzW3RyYXZlcnNlZEVkZ2VzQ291bnRdXHJcbiAgICAgIHRvTm9kZSA9IG5leHRFZGdlLnRvLm5vZGVcclxuICAgIH1cclxuXHJcbiAgICBpZiAodG9Ob2RlKSB7XHJcbiAgICAgIHRoaXMudmlzaXRlZE5vZGVzLnB1c2godG9Ob2RlKVxyXG4gICAgICB0aGlzLmFuaW1hdGVOb2RlVHJhbnNpdGlvbihjYW52YXMsIGZyb21Ob2RlLCB0b05vZGUpXHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAvLyBObyBtb3JlIG5vZGVzIGxlZnQsIGFuaW1hdGUgdG8gc2FtZSBub2RlXHJcbiAgICAgIHRoaXMuYW5pbWF0ZU5vZGVUcmFuc2l0aW9uKGNhbnZhcywgZnJvbU5vZGUsIGZyb21Ob2RlKVxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBwcmV2aW91c05vZGUoY2FudmFzOiBDYW52YXMpIHtcclxuICAgIGNvbnN0IGZyb21Ob2RlID0gdGhpcy52aXNpdGVkTm9kZXMucG9wKClcclxuICAgIGlmICghZnJvbU5vZGUpIHJldHVyblxyXG5cclxuICAgIGxldCB0b05vZGUgPSB0aGlzLnZpc2l0ZWROb2Rlcy5sYXN0KClcclxuXHJcbiAgICAvLyBGYWxsIGJhY2sgdG8gc2FtZSBub2RlIGlmIHRoZXJlIGFyZSBubyBtb3JlIG5vZGVzIGJlZm9yZVxyXG4gICAgaWYgKCF0b05vZGUpIHtcclxuICAgICAgdG9Ob2RlID0gZnJvbU5vZGVcclxuICAgICAgdGhpcy52aXNpdGVkTm9kZXMucHVzaChmcm9tTm9kZSlcclxuICAgIH1cclxuXHJcbiAgICB0aGlzLmFuaW1hdGVOb2RlVHJhbnNpdGlvbihjYW52YXMsIGZyb21Ob2RlLCB0b05vZGUpXHJcbiAgfVxyXG59IiwgImltcG9ydCB7IENhbnZhcywgQ2FudmFzTm9kZSwgQ2FudmFzTm9kZURhdGEgfSBmcm9tIFwic3JjL0B0eXBlcy9DYW52YXNcIlxyXG5pbXBvcnQgeyBDYW52YXNFdmVudCB9IGZyb20gXCJzcmMvY29yZS9ldmVudHNcIlxyXG5pbXBvcnQgQWR2YW5jZWRDYW52YXNQbHVnaW4gZnJvbSBcInNyYy9tYWluXCJcclxuaW1wb3J0IFNldHRpbmdzTWFuYWdlciBmcm9tIFwic3JjL3NldHRpbmdzXCJcclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBnZXRFeHBvc2VkTm9kZURhdGEoc2V0dGluZ3M6IFNldHRpbmdzTWFuYWdlcik6IChrZXlvZiBDYW52YXNOb2RlRGF0YSlbXSB7XHJcbiAgY29uc3QgZXhwb3NlZERhdGE6IChrZXlvZiBDYW52YXNOb2RlRGF0YSlbXSA9IFtdXHJcbiAgXHJcbiAgaWYgKHNldHRpbmdzLmdldFNldHRpbmcoJ3N0aWNrZXJzRmVhdHVyZUVuYWJsZWQnKSkgZXhwb3NlZERhdGEucHVzaCgnaXNTdGlja2VyJylcclxuICBpZiAoc2V0dGluZ3MuZ2V0U2V0dGluZygnc2hhcGVzRmVhdHVyZUVuYWJsZWQnKSkgZXhwb3NlZERhdGEucHVzaCgnc2hhcGUnKVxyXG4gIGlmIChzZXR0aW5ncy5nZXRTZXR0aW5nKCdjb2xsYXBzaWJsZUdyb3Vwc0ZlYXR1cmVFbmFibGVkJykpIGV4cG9zZWREYXRhLnB1c2goJ2lzQ29sbGFwc2VkJylcclxuICBpZiAoc2V0dGluZ3MuZ2V0U2V0dGluZygncHJlc2VudGF0aW9uRmVhdHVyZUVuYWJsZWQnKSkgZXhwb3NlZERhdGEucHVzaCgnaXNTdGFydE5vZGUnKVxyXG4gIGlmIChzZXR0aW5ncy5nZXRTZXR0aW5nKCdwb3J0YWxzRmVhdHVyZUVuYWJsZWQnKSkgZXhwb3NlZERhdGEucHVzaCgncG9ydGFsVG9GaWxlJywgJ3BvcnRhbElkJylcclxuXHJcbiAgcmV0dXJuIGV4cG9zZWREYXRhXHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIE5vZGVEYXRhVGFnZ2VyQ2FudmFzRXh0ZW5zaW9uIHtcclxuICBwbHVnaW46IEFkdmFuY2VkQ2FudmFzUGx1Z2luXHJcblxyXG4gIGNvbnN0cnVjdG9yKHBsdWdpbjogQWR2YW5jZWRDYW52YXNQbHVnaW4pIHtcclxuICAgIHRoaXMucGx1Z2luID0gcGx1Z2luXHJcblxyXG4gICAgdGhpcy5wbHVnaW4ucmVnaXN0ZXJFdmVudCh0aGlzLnBsdWdpbi5hcHAud29ya3NwYWNlLm9uKFxyXG4gICAgICBDYW52YXNFdmVudC5Ob2RlQ2hhbmdlZCxcclxuICAgICAgKF9jYW52YXM6IENhbnZhcywgbm9kZTogQ2FudmFzTm9kZSkgPT4ge1xyXG4gICAgICAgIGNvbnN0IG5vZGVEYXRhID0gbm9kZT8uZ2V0RGF0YSgpXHJcbiAgICAgICAgaWYgKCFub2RlRGF0YSkgcmV0dXJuXHJcblxyXG4gICAgICAgIGZvciAoY29uc3QgZGF0YUtleSBvZiBnZXRFeHBvc2VkTm9kZURhdGEodGhpcy5wbHVnaW4uc2V0dGluZ3MpKSB7XHJcbiAgICAgICAgICBjb25zdCBkYXRhVmFsdWUgPSBub2RlRGF0YVtkYXRhS2V5XVxyXG4gICAgICAgICAgXHJcbiAgICAgICAgICBpZiAoIWRhdGFWYWx1ZSkgZGVsZXRlIG5vZGUubm9kZUVsLmRhdGFzZXRbZGF0YUtleV1cclxuICAgICAgICAgIGVsc2Ugbm9kZS5ub2RlRWwuZGF0YXNldFtkYXRhS2V5XSA9IGRhdGFWYWx1ZVxyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgKSlcclxuICB9XHJcbn0iLCAiaW1wb3J0IHsgQ2FudmFzLCBDYW52YXNOb2RlIH0gZnJvbSBcInNyYy9AdHlwZXMvQ2FudmFzXCJcclxuaW1wb3J0IHsgZ2V0RXhwb3NlZE5vZGVEYXRhIH0gZnJvbSBcIi4vbm9kZS1kYXRhLXRhZ2dlci1jYW52YXMtZXh0ZW5zaW9uXCJcclxuaW1wb3J0IEFkdmFuY2VkQ2FudmFzUGx1Z2luIGZyb20gXCJzcmMvbWFpblwiXHJcbmltcG9ydCB7IENhbnZhc0V2ZW50IH0gZnJvbSBcInNyYy9jb3JlL2V2ZW50c1wiXHJcblxyXG5leHBvcnQgY29uc3QgVEFSR0VUX05PREVfREFUQVNFVF9QUkVGSVggPSBcInRhcmdldFwiXHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBJbnRlcmFjdGlvblRhZ2dlckNhbnZhc0V4dGVuc2lvbiB7XHJcbiAgcGx1Z2luOiBBZHZhbmNlZENhbnZhc1BsdWdpblxyXG5cclxuICBjb25zdHJ1Y3RvcihwbHVnaW46IEFkdmFuY2VkQ2FudmFzUGx1Z2luKSB7XHJcbiAgICB0aGlzLnBsdWdpbiA9IHBsdWdpblxyXG5cclxuICAgIC8vIFJlZ2lzdGVyIGV2ZW50c1xyXG4gICAgdGhpcy5wbHVnaW4ucmVnaXN0ZXJFdmVudCh0aGlzLnBsdWdpbi5hcHAud29ya3NwYWNlLm9uKFxyXG4gICAgICBDYW52YXNFdmVudC5Ob2RlSW50ZXJhY3Rpb24sXHJcbiAgICAgIChjYW52YXM6IENhbnZhcywgbm9kZTogQ2FudmFzTm9kZSkgPT4ge1xyXG4gICAgICAgIGNvbnN0IGludGVyYWN0aW9uRWwgPSBjYW52YXMubm9kZUludGVyYWN0aW9uTGF5ZXIuaW50ZXJhY3Rpb25FbFxyXG4gICAgICAgIGlmICghaW50ZXJhY3Rpb25FbCkgcmV0dXJuXHJcbiAgICBcclxuICAgICAgICBmb3IgKGNvbnN0IGRhdGFLZXkgb2YgZ2V0RXhwb3NlZE5vZGVEYXRhKHRoaXMucGx1Z2luLnNldHRpbmdzKSkge1xyXG4gICAgICAgICAgY29uc3QgZGF0YXNldEtleSA9IFRBUkdFVF9OT0RFX0RBVEFTRVRfUFJFRklYICsgZGF0YUtleS50b1N0cmluZygpLmNoYXJBdCgwKS50b1VwcGVyQ2FzZSgpICsgZGF0YUtleS50b1N0cmluZygpLnNsaWNlKDEpXHJcbiAgICBcclxuICAgICAgICAgIGNvbnN0IGRhdGFWYWx1ZSA9IG5vZGU/LmdldERhdGEoKVtkYXRhS2V5XVxyXG5cclxuICAgICAgICAgIGlmICghZGF0YVZhbHVlKSBkZWxldGUgaW50ZXJhY3Rpb25FbC5kYXRhc2V0W2RhdGFzZXRLZXldXHJcbiAgICAgICAgICBlbHNlIGludGVyYWN0aW9uRWwuZGF0YXNldFtkYXRhc2V0S2V5XSA9IGRhdGFWYWx1ZVxyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgKSlcclxuICB9XHJcbn0iLCAiaW1wb3J0IHsgQ2FudmFzIH0gZnJvbSBcInNyYy9AdHlwZXMvQ2FudmFzXCJcclxuaW1wb3J0ICogYXMgQ2FudmFzSGVscGVyIGZyb20gXCJzcmMvdXRpbHMvY2FudmFzLWhlbHBlclwiXHJcbmltcG9ydCBBZHZhbmNlZENhbnZhc1BsdWdpbiBmcm9tIFwic3JjL21haW5cIlxyXG5pbXBvcnQgeyBDYW52YXNFdmVudCB9IGZyb20gXCJzcmMvY29yZS9ldmVudHNcIlxyXG5pbXBvcnQgeyBBZHZhbmNlZENhbnZhc1BsdWdpblNldHRpbmdzIH0gZnJvbSBcInNyYy9zZXR0aW5nc1wiXHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBSZWFkb25seUNhbnZhc0V4dGVuc2lvbiB7XHJcbiAgcGx1Z2luOiBBZHZhbmNlZENhbnZhc1BsdWdpblxyXG5cclxuICBjb25zdHJ1Y3RvcihwbHVnaW46IGFueSkge1xyXG4gICAgdGhpcy5wbHVnaW4gPSBwbHVnaW5cclxuICAgIGNvbnN0IHRoYXQgPSB0aGlzXHJcblxyXG4gICAgaWYgKCF0aGlzLnBsdWdpbi5zZXR0aW5ncy5nZXRTZXR0aW5nKCdiZXR0ZXJSZWFkb25seUVuYWJsZWQnKSkgcmV0dXJuXHJcblxyXG4gICAgLyogUG9wdXAgbGlzdGVuZXIgKi9cclxuICAgIHRoaXMucGx1Z2luLnJlZ2lzdGVyRXZlbnQodGhpcy5wbHVnaW4uYXBwLndvcmtzcGFjZS5vbihcclxuICAgICAgQ2FudmFzRXZlbnQuUG9wdXBNZW51Q3JlYXRlZCxcclxuICAgICAgKGNhbnZhczogQ2FudmFzLCBfbm9kZTogYW55KSA9PiB0aGlzLnVwZGF0ZVBvcHVwTWVudShjYW52YXMpXHJcbiAgICApKVxyXG5cclxuICAgIC8qIFpvb20gYW5kIFBhbiBsaXN0ZW5lciAqL1xyXG4gICAgbGV0IG1vdmluZ1RvQkJveCA9IGZhbHNlXHJcblxyXG4gICAgdGhpcy5wbHVnaW4ucmVnaXN0ZXJFdmVudCh0aGlzLnBsdWdpbi5hcHAud29ya3NwYWNlLm9uKFxyXG4gICAgICBDYW52YXNFdmVudC5WaWV3cG9ydENoYW5nZWQuQmVmb3JlLFxyXG4gICAgICAoY2FudmFzOiBDYW52YXMpID0+IHtcclxuICAgICAgICAvLyBPbmx5IGFsbG93IHZpZXdwb3J0IGNoYW5nZSBvbmNlIHdoZW4gdXNpbmcgem9vbSB0byBiYm94XHJcbiAgICAgICAgaWYgKG1vdmluZ1RvQkJveCkge1xyXG4gICAgICAgICAgbW92aW5nVG9CQm94ID0gZmFsc2VcclxuXHJcbiAgICAgICAgICB0aGF0LnVwZGF0ZUxvY2tlZFpvb20oY2FudmFzKVxyXG4gICAgICAgICAgdGhhdC51cGRhdGVMb2NrZWRQYW4oY2FudmFzKVxyXG5cclxuICAgICAgICAgIHJldHVyblxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKCFjYW52YXMucmVhZG9ubHkpIHJldHVyblxyXG5cclxuICAgICAgICBpZiAodGhhdC5wbHVnaW4uc2V0dGluZ3MuZ2V0U2V0dGluZygnZGlzYWJsZVpvb20nKSkge1xyXG4gICAgICAgICAgY2FudmFzLnpvb20gPSBjYW52YXMubG9ja2VkWm9vbSA/PyBjYW52YXMuem9vbVxyXG4gICAgICAgICAgY2FudmFzLnRab29tID0gY2FudmFzLmxvY2tlZFpvb20gPz8gY2FudmFzLnRab29tXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAodGhhdC5wbHVnaW4uc2V0dGluZ3MuZ2V0U2V0dGluZygnZGlzYWJsZVBhbicpKSB7XHJcbiAgICAgICAgICBjYW52YXMueCA9IGNhbnZhcy5sb2NrZWRYID8/IGNhbnZhcy54XHJcbiAgICAgICAgICBjYW52YXMudHggPSBjYW52YXMubG9ja2VkWCA/PyBjYW52YXMudHhcclxuICAgICAgICAgIGNhbnZhcy55ID0gY2FudmFzLmxvY2tlZFkgPz8gY2FudmFzLnlcclxuICAgICAgICAgIGNhbnZhcy50eSA9IGNhbnZhcy5sb2NrZWRZID8/IGNhbnZhcy50eVxyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgKSlcclxuXHJcbiAgICAvLyBBbGxvdyB2aWV3cG9ydCBjaGFuZ2Ugd2hlbiB1c2luZyB6b29tIHRvIGJib3hcclxuICAgIHRoaXMucGx1Z2luLnJlZ2lzdGVyRXZlbnQodGhpcy5wbHVnaW4uYXBwLndvcmtzcGFjZS5vbihcclxuICAgICAgQ2FudmFzRXZlbnQuWm9vbVRvQmJveC5CZWZvcmUsXHJcbiAgICAgICgpID0+IG1vdmluZ1RvQkJveCA9IHRydWVcclxuICAgICkpXHJcblxyXG4gICAgLyogUmVhZG9ubHkgbGlzdGVuZXIgKi9cclxuICAgIHRoaXMucGx1Z2luLnJlZ2lzdGVyRXZlbnQodGhpcy5wbHVnaW4uYXBwLndvcmtzcGFjZS5vbihcclxuICAgICAgQ2FudmFzRXZlbnQuUmVhZG9ubHlDaGFuZ2VkLFxyXG4gICAgICAoY2FudmFzOiBDYW52YXMsIF9yZWFkb25seTogYm9vbGVhbikgPT4ge1xyXG4gICAgICAgIHRoaXMudXBkYXRlUG9wdXBNZW51KGNhbnZhcylcclxuICAgICAgICB0aGlzLnVwZGF0ZUxvY2tlZFpvb20oY2FudmFzKVxyXG4gICAgICAgIHRoaXMudXBkYXRlTG9ja2VkUGFuKGNhbnZhcylcclxuICAgICAgfVxyXG4gICAgKSlcclxuXHJcbiAgICAvKiBBZGQgc2V0dGluZ3MgKi9cclxuICAgIHRoaXMucGx1Z2luLnJlZ2lzdGVyRXZlbnQodGhpcy5wbHVnaW4uYXBwLndvcmtzcGFjZS5vbihcclxuICAgICAgQ2FudmFzRXZlbnQuQ2FudmFzQ2hhbmdlZCxcclxuICAgICAgKGNhbnZhczogQ2FudmFzKSA9PiB0aGlzLmFkZFF1aWNrU2V0dGluZ3MoY2FudmFzKVxyXG4gICAgKSlcclxuICB9XHJcblxyXG4gIGFkZFF1aWNrU2V0dGluZ3MoY2FudmFzOiBDYW52YXMpIHtcclxuICAgIGNvbnN0IHNldHRpbmdzQ29udGFpbmVyID0gY2FudmFzLnF1aWNrU2V0dGluZ3NCdXR0b24/LnBhcmVudEVsZW1lbnRcclxuICAgIGlmICghc2V0dGluZ3NDb250YWluZXIpIHJldHVyblxyXG5cclxuICAgIENhbnZhc0hlbHBlci5hZGRRdWlja1NldHRpbmdzQnV0dG9uKFxyXG4gICAgICBzZXR0aW5nc0NvbnRhaW5lcixcclxuICAgICAgdGhpcy5jcmVhdGVUb2dnbGUoe1xyXG4gICAgICAgIGlkOiAnZGlzYWJsZS1ub2RlLXBvcHVwJyxcclxuICAgICAgICBsYWJlbDogJ0Rpc2FibGUgbm9kZSBwb3B1cCcsXHJcbiAgICAgICAgaWNvbjogJ2Fycm93LXVwLXJpZ2h0LWZyb20tY2lyY2xlJyxcclxuICAgICAgICBjYWxsYmFjazogKCkgPT4gdGhpcy51cGRhdGVQb3B1cE1lbnUoY2FudmFzKVxyXG4gICAgICB9LCAnZGlzYWJsZU5vZGVQb3B1cCcpXHJcbiAgICApXHJcblxyXG4gICAgQ2FudmFzSGVscGVyLmFkZFF1aWNrU2V0dGluZ3NCdXR0b24oXHJcbiAgICAgIHNldHRpbmdzQ29udGFpbmVyLFxyXG4gICAgICB0aGlzLmNyZWF0ZVRvZ2dsZSh7XHJcbiAgICAgICAgaWQ6ICdkaXNhYmxlLXpvb20nLFxyXG4gICAgICAgIGxhYmVsOiAnRGlzYWJsZSB6b29tJyxcclxuICAgICAgICBpY29uOiAnem9vbS1pbicsXHJcbiAgICAgICAgY2FsbGJhY2s6ICgpID0+IHRoaXMudXBkYXRlTG9ja2VkWm9vbShjYW52YXMpXHJcbiAgICAgIH0sICdkaXNhYmxlWm9vbScpXHJcbiAgICApXHJcblxyXG4gICAgQ2FudmFzSGVscGVyLmFkZFF1aWNrU2V0dGluZ3NCdXR0b24oXHJcbiAgICAgIHNldHRpbmdzQ29udGFpbmVyLFxyXG4gICAgICB0aGlzLmNyZWF0ZVRvZ2dsZSh7XHJcbiAgICAgICAgaWQ6ICdkaXNhYmxlLXBhbicsXHJcbiAgICAgICAgbGFiZWw6ICdEaXNhYmxlIHBhbicsXHJcbiAgICAgICAgaWNvbjogJ21vdmUnLFxyXG4gICAgICAgIGNhbGxiYWNrOiAoKSA9PiB0aGlzLnVwZGF0ZUxvY2tlZFBhbihjYW52YXMpXHJcbiAgICAgIH0sICdkaXNhYmxlUGFuJylcclxuICAgIClcclxuICB9XHJcblxyXG4gIHByaXZhdGUgY3JlYXRlVG9nZ2xlKG1lbnVPcHRpb246IENhbnZhc0hlbHBlci5NZW51T3B0aW9uLCBzZXR0aW5nS2V5OiBrZXlvZiBBZHZhbmNlZENhbnZhc1BsdWdpblNldHRpbmdzKTogSFRNTEVsZW1lbnQge1xyXG4gICAgY29uc3QgdG9nZ2xlID0gQ2FudmFzSGVscGVyLmNyZWF0ZVF1aWNrU2V0dGluZ3NCdXR0b24oe1xyXG4gICAgICAuLi5tZW51T3B0aW9uLFxyXG4gICAgICBjYWxsYmFjazogKCkgPT4gKGFzeW5jICgpID0+IHtcclxuICAgICAgICBjb25zdCBuZXdWYWx1ZSA9ICF0aGlzLnBsdWdpbi5zZXR0aW5ncy5nZXRTZXR0aW5nKHNldHRpbmdLZXkpXHJcbiAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2V0dGluZ3Muc2V0U2V0dGluZyh7IFtzZXR0aW5nS2V5XTogbmV3VmFsdWUgfSlcclxuXHJcbiAgICAgICAgdG9nZ2xlLmRhdGFzZXQudG9nZ2xlZCA9IHRoaXMucGx1Z2luLnNldHRpbmdzLmdldFNldHRpbmcoc2V0dGluZ0tleSkudG9TdHJpbmcoKVxyXG4gICAgICAgIG1lbnVPcHRpb24uY2FsbGJhY2s/LmNhbGwodGhpcylcclxuICAgICAgfSkoKVxyXG4gICAgfSlcclxuICAgIHRvZ2dsZS5jbGFzc0xpc3QuYWRkKCdzaG93LXdoaWxlLXJlYWRvbmx5JylcclxuXHJcbiAgICB0b2dnbGUuZGF0YXNldC50b2dnbGVkID0gdGhpcy5wbHVnaW4uc2V0dGluZ3MuZ2V0U2V0dGluZyhzZXR0aW5nS2V5KS50b1N0cmluZygpXHJcblxyXG4gICAgcmV0dXJuIHRvZ2dsZVxyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSB1cGRhdGVQb3B1cE1lbnUoY2FudmFzOiBDYW52YXMpIHtcclxuICAgIGNvbnN0IGhpZGRlbiA9IGNhbnZhcy5yZWFkb25seSAmJiB0aGlzLnBsdWdpbi5zZXR0aW5ncy5nZXRTZXR0aW5nKCdkaXNhYmxlTm9kZVBvcHVwJylcclxuICAgIGNhbnZhcy5tZW51Lm1lbnVFbC5zdHlsZS52aXNpYmlsaXR5ID0gaGlkZGVuID8gJ2hpZGRlbicgOiAndmlzaWJsZSdcclxuICB9XHJcblxyXG4gIHByaXZhdGUgdXBkYXRlTG9ja2VkWm9vbShjYW52YXM6IENhbnZhcykge1xyXG4gICAgY2FudmFzLmxvY2tlZFpvb20gPSBjYW52YXMudFpvb21cclxuICB9XHJcblxyXG4gIHByaXZhdGUgdXBkYXRlTG9ja2VkUGFuKGNhbnZhczogQ2FudmFzKSB7XHJcbiAgICBjYW52YXMubG9ja2VkWCA9IGNhbnZhcy50eFxyXG4gICAgY2FudmFzLmxvY2tlZFkgPSBjYW52YXMudHlcclxuICB9XHJcbn0iLCAiaW1wb3J0IEFwcCwgeyBTdWdnZXN0TW9kYWwsIFRGaWxlIH0gZnJvbSAnb2JzaWRpYW4nXHJcbmltcG9ydCAqIGFzIFBhdGhIZWxwZXIgZnJvbSAnc3JjL3V0aWxzL3BhdGgtaGVscGVyJ1xyXG5cclxuZXhwb3J0IGNsYXNzIEZpbGVOYW1lTW9kYWwgZXh0ZW5kcyBTdWdnZXN0TW9kYWw8c3RyaW5nPiB7XHJcbiAgcGFyZW50UGF0aDogc3RyaW5nXHJcbiAgZmlsZUV4dGVuc2lvbjogc3RyaW5nXHJcblxyXG4gIGNvbnN0cnVjdG9yKGFwcDogQXBwLCBwYXJlbnRQYXRoOiBzdHJpbmcsIGZpbGVFeHRlbnNpb246IHN0cmluZykge1xyXG4gICAgc3VwZXIoYXBwKVxyXG5cclxuICAgIHRoaXMucGFyZW50UGF0aCA9IHBhcmVudFBhdGhcclxuICAgIHRoaXMuZmlsZUV4dGVuc2lvbiA9IGZpbGVFeHRlbnNpb25cclxuICB9XHJcblxyXG4gIGdldFN1Z2dlc3Rpb25zKHF1ZXJ5OiBzdHJpbmcpOiBzdHJpbmdbXSB7XHJcbiAgICBjb25zdCBxdWVyeVdpdGhvdXRFeHRlbnNpb24gPSBxdWVyeS5yZXBsYWNlKG5ldyBSZWdFeHAoYFxcXFwuJHt0aGlzLmZpbGVFeHRlbnNpb259JGApLCAnJylcclxuICAgIGlmIChxdWVyeVdpdGhvdXRFeHRlbnNpb24gPT09ICcnKSByZXR1cm4gW11cclxuXHJcbiAgICBjb25zdCBxdWVyeVdpdGhFeHRlbnNpb24gPSBxdWVyeVdpdGhvdXRFeHRlbnNpb24gKyAnLicgKyB0aGlzLmZpbGVFeHRlbnNpb25cclxuICAgIGNvbnN0IHN1Z2dlc3Rpb25zID0gW2Ake3RoaXMucGFyZW50UGF0aH0vJHtxdWVyeVdpdGhFeHRlbnNpb259YCwgcXVlcnlXaXRoRXh0ZW5zaW9uXVxyXG4gICAgICAvLyBGaWx0ZXIgb3V0IHN1Z2dlc3Rpb25zIGZvciBmaWxlcyB0aGF0IGFscmVhZHkgZXhpc3RcclxuICAgICAgLmZpbHRlcihzID0+IHRoaXMuYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChzKSA9PT0gbnVsbClcclxuXHJcbiAgICByZXR1cm4gc3VnZ2VzdGlvbnNcclxuICB9XHJcblxyXG4gIHJlbmRlclN1Z2dlc3Rpb24odGV4dDogc3RyaW5nLCBlbDogSFRNTEVsZW1lbnQpIHtcclxuICAgIGVsLnNldFRleHQodGV4dClcclxuICB9XHJcblxyXG4gIG9uQ2hvb3NlU3VnZ2VzdGlvbihfdGV4dDogc3RyaW5nLCBfZXZ0OiBNb3VzZUV2ZW50IHwgS2V5Ym9hcmRFdmVudCkge31cclxuXHJcbiAgYXdhaXRJbnB1dCgpOiBQcm9taXNlPHN0cmluZz4ge1xyXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCBfcmVqZWN0KSA9PiB7XHJcbiAgICAgIHRoaXMub25DaG9vc2VTdWdnZXN0aW9uID0gKHRleHQ6IHN0cmluZykgPT4geyByZXNvbHZlKHRleHQpIH1cclxuICAgICAgdGhpcy5vcGVuKClcclxuICAgIH0pXHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgY2xhc3MgRmlsZVNlbGVjdE1vZGFsIGV4dGVuZHMgU3VnZ2VzdE1vZGFsPHN0cmluZz4ge1xyXG4gIGZpbGVzOiBzdHJpbmdbXVxyXG4gIHN1Z2dlc3ROZXdGaWxlOiBib29sZWFuXHJcblxyXG4gIGNvbnN0cnVjdG9yKGFwcDogQXBwLCBleHRlbnNpb25zUmVnZXg/OiBSZWdFeHAsIHN1Z2dlc3ROZXdGaWxlOiBib29sZWFuID0gZmFsc2UpIHtcclxuICAgIHN1cGVyKGFwcClcclxuXHJcbiAgICB0aGlzLmZpbGVzID0gdGhpcy5hcHAudmF1bHQuZ2V0RmlsZXMoKVxyXG4gICAgICAubWFwKGZpbGUgPT4gZmlsZS5wYXRoKVxyXG4gICAgICAuZmlsdGVyKHBhdGggPT4gUGF0aEhlbHBlci5leHRlbnNpb24ocGF0aCk/Lm1hdGNoKGV4dGVuc2lvbnNSZWdleCA/PyAvLiovKSlcclxuICAgIHRoaXMuc3VnZ2VzdE5ld0ZpbGUgPSBzdWdnZXN0TmV3RmlsZVxyXG5cclxuICAgIHRoaXMuc2V0UGxhY2Vob2xkZXIoJ1R5cGUgdG8gc2VhcmNoLi4uJylcclxuICAgIHRoaXMuc2V0SW5zdHJ1Y3Rpb25zKFt7XHJcbiAgICAgICAgY29tbWFuZDogJ1x1MjE5MVx1MjE5MycsXHJcbiAgICAgICAgcHVycG9zZTogJ3RvIG5hdmlnYXRlJ1xyXG4gICAgfSwge1xyXG4gICAgICAgIGNvbW1hbmQ6ICdcdTIxQjUnLFxyXG4gICAgICAgIHB1cnBvc2U6ICd0byBvcGVuJ1xyXG4gICAgfSwge1xyXG4gICAgICAgIGNvbW1hbmQ6ICdzaGlmdCBcdTIxQjUnLFxyXG4gICAgICAgIHB1cnBvc2U6ICd0byBjcmVhdGUnXHJcbiAgICB9LCB7XHJcbiAgICAgICAgY29tbWFuZDogJ2VzYycsXHJcbiAgICAgICAgcHVycG9zZTogJ3RvIGRpc21pc3MnXHJcbiAgICB9XSlcclxuXHJcbiAgICB0aGlzLnNjb3BlLnJlZ2lzdGVyKFsnU2hpZnQnXSwgJ0VudGVyJywgKChlKSA9PiB7XHJcbiAgICAgIHRoaXMub25DaG9vc2VTdWdnZXN0aW9uKHRoaXMuaW5wdXRFbC52YWx1ZSwgZSlcclxuICAgICAgdGhpcy5jbG9zZSgpXHJcbiAgICB9KSlcclxuICB9XHJcblxyXG4gIGdldFN1Z2dlc3Rpb25zKHF1ZXJ5OiBzdHJpbmcpOiBzdHJpbmdbXSB7XHJcbiAgICBjb25zdCBzdWdnZXN0aW9ucyA9IHRoaXMuZmlsZXMuZmlsdGVyKHBhdGggPT4gcGF0aC50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKHF1ZXJ5LnRvTG93ZXJDYXNlKCkpKVxyXG4gICAgaWYgKHN1Z2dlc3Rpb25zLmxlbmd0aCA9PT0gMCAmJiB0aGlzLnN1Z2dlc3ROZXdGaWxlKSBzdWdnZXN0aW9ucy5wdXNoKHF1ZXJ5KVxyXG5cclxuICAgIHJldHVybiBzdWdnZXN0aW9uc1xyXG4gIH1cclxuXHJcbiAgcmVuZGVyU3VnZ2VzdGlvbihwYXRoOiBzdHJpbmcsIGVsOiBIVE1MRWxlbWVudCkge1xyXG4gICAgY29uc3Qgc2ltcGxpZmllZFBhdGggPSBwYXRoLnJlcGxhY2UoL1xcLm1kJC8sICcnKVxyXG4gICAgZWwuc2V0VGV4dChzaW1wbGlmaWVkUGF0aClcclxuICB9XHJcblxyXG4gIG9uQ2hvb3NlU3VnZ2VzdGlvbihfcGF0aDogc3RyaW5nLCBfZXZ0OiBNb3VzZUV2ZW50IHwgS2V5Ym9hcmRFdmVudCkge31cclxuXHJcbiAgYXdhaXRJbnB1dCgpOiBQcm9taXNlPFRGaWxlPiB7XHJcbiAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIF9yZWplY3QpID0+IHtcclxuICAgICAgdGhpcy5vbkNob29zZVN1Z2dlc3Rpb24gPSAocGF0aDogc3RyaW5nLCBfZXZ0OiBNb3VzZUV2ZW50IHwgS2V5Ym9hcmRFdmVudCkgPT4ge1xyXG4gICAgICAgIGNvbnN0IGZpbGUgPSB0aGlzLmFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgocGF0aClcclxuXHJcbiAgICAgICAgaWYgKGZpbGUgaW5zdGFuY2VvZiBURmlsZSkge1xyXG4gICAgICAgICAgcmVzb2x2ZShmaWxlKVxyXG4gICAgICAgICAgcmV0dXJuXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAoIXRoaXMuc3VnZ2VzdE5ld0ZpbGUpIHJldHVyblxyXG5cclxuICAgICAgICBpZiAoUGF0aEhlbHBlci5leHRlbnNpb24ocGF0aCkgPT09IHVuZGVmaW5lZCkgcGF0aCArPSAnLm1kJ1xyXG4gICAgICAgIGNvbnN0IG5ld0ZpbGUgPSB0aGlzLmFwcC52YXVsdC5jcmVhdGUocGF0aCwgJycpXHJcbiAgICAgICAgcmVzb2x2ZShuZXdGaWxlKVxyXG4gICAgICB9XHJcblxyXG4gICAgICB0aGlzLm9wZW4oKVxyXG4gICAgfSlcclxuICB9XHJcbn0iLCAiZXhwb3J0IGZ1bmN0aW9uIGV4dGVuc2lvbihwYXRoOiBzdHJpbmcpOiBzdHJpbmcgfCB1bmRlZmluZWQge1xyXG4gIHJldHVybiBwYXRoLmluY2x1ZGVzKCcuJykgPyBwYXRoLnNwbGl0KCcuJykucG9wKCkgOiB1bmRlZmluZWRcclxufSIsICJpbXBvcnQgeyBNZW51IH0gZnJvbSBcIm9ic2lkaWFuXCJcclxuaW1wb3J0IHsgQ2FudmFzIH0gZnJvbSBcInNyYy9AdHlwZXMvQ2FudmFzXCJcclxuaW1wb3J0IEFkdmFuY2VkQ2FudmFzUGx1Z2luIGZyb20gXCJzcmMvbWFpblwiXHJcbmltcG9ydCB7IEZpbGVOYW1lTW9kYWwgfSBmcm9tIFwic3JjL3V0aWxzL21vZGFsLWhlbHBlclwiXHJcbmltcG9ydCAqIGFzIENhbnZhc0hlbHBlciBmcm9tIFwic3JjL3V0aWxzL2NhbnZhcy1oZWxwZXJcIlxyXG5cclxuY29uc3QgRU5DQVBTVUxBVEVEX0ZJTEVfTk9ERV9TSVpFID0geyB3aWR0aDogMzAwLCBoZWlnaHQ6IDMwMCB9XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBFbmNhcHN1bGF0ZUNhbnZhc0V4dGVuc2lvbiB7XHJcbiAgcGx1Z2luOiBBZHZhbmNlZENhbnZhc1BsdWdpblxyXG5cclxuICBjb25zdHJ1Y3RvcihwbHVnaW46IEFkdmFuY2VkQ2FudmFzUGx1Z2luKSB7XHJcbiAgICB0aGlzLnBsdWdpbiA9IHBsdWdpblxyXG5cclxuICAgIGlmICghdGhpcy5wbHVnaW4uc2V0dGluZ3MuZ2V0U2V0dGluZygnY2FudmFzRW5jYXBzdWxhdGlvbkVuYWJsZWQnKSkgcmV0dXJuXHJcblxyXG4gICAgLyogQWRkIGNvbW1hbmQgdG8gZW5jYXBzdWxhdGUgc2VsZWN0aW9uICovXHJcbiAgICB0aGlzLnBsdWdpbi5hZGRDb21tYW5kKHtcclxuICAgICAgaWQ6ICdlbmNhcHN1bGF0ZS1zZWxlY3Rpb24nLFxyXG4gICAgICBuYW1lOiAnRW5jYXBzdWxhdGUgc2VsZWN0aW9uJyxcclxuICAgICAgY2hlY2tDYWxsYmFjazogQ2FudmFzSGVscGVyLmNhbnZhc0NvbW1hbmQoXHJcbiAgICAgICAgdGhpcy5wbHVnaW4sXHJcbiAgICAgICAgKGNhbnZhczogQ2FudmFzKSA9PiAhY2FudmFzLnJlYWRvbmx5ICYmIGNhbnZhcy5zZWxlY3Rpb24uc2l6ZSA+IDAsXHJcbiAgICAgICAgKGNhbnZhczogQ2FudmFzKSA9PiB0aGlzLmVuY2Fwc3VsYXRlU2VsZWN0aW9uKGNhbnZhcylcclxuICAgICAgKVxyXG4gICAgfSlcclxuXHJcbiAgICAvKiBBZGQgZW5jYXBzdWxhdGUgb3B0aW9uIHRvIGNvbnRleHQgbWVudSAqL1xyXG4gICAgdGhpcy5wbHVnaW4ucmVnaXN0ZXJFdmVudCh0aGlzLnBsdWdpbi5hcHAud29ya3NwYWNlLm9uKFxyXG4gICAgICAnY2FudmFzOnNlbGVjdGlvbi1tZW51JyxcclxuICAgICAgKG1lbnU6IE1lbnUsIGNhbnZhczogQ2FudmFzKSA9PiB7XHJcbiAgICAgICAgbWVudS5hZGRJdGVtKChpdGVtKSA9PlxyXG4gICAgICAgICAgaXRlbVxyXG4gICAgICAgICAgICAuc2V0VGl0bGUoJ0VuY2Fwc3VsYXRlJylcclxuICAgICAgICAgICAgLnNldEljb24oJ2ZpbGUtcGx1cycpXHJcbiAgICAgICAgICAgIC5vbkNsaWNrKCgpID0+IHRoaXMuZW5jYXBzdWxhdGVTZWxlY3Rpb24oY2FudmFzKSlcclxuICAgICAgICApXHJcbiAgICAgIH1cclxuICAgICkpXHJcbiAgfVxyXG5cclxuICBhc3luYyBlbmNhcHN1bGF0ZVNlbGVjdGlvbihjYW52YXM6IENhbnZhcykge1xyXG4gICAgY29uc3Qgc2VsZWN0aW9uID0gY2FudmFzLmdldFNlbGVjdGlvbkRhdGEoKVxyXG5cclxuICAgIC8vIENyZWF0ZSBuZXcgZmlsZVxyXG4gICAgY29uc3Qgc291cmNlRmlsZUZvbGRlciA9IGNhbnZhcy52aWV3LmZpbGUucGFyZW50Py5wYXRoXHJcbiAgICBpZiAoIXNvdXJjZUZpbGVGb2xkZXIpIHJldHVybiAvLyBTaG91bGQgbmV2ZXIgaGFwcGVuXHJcblxyXG4gICAgY29uc3QgdGFyZ2V0RmlsZVBhdGggPSBhd2FpdCBuZXcgRmlsZU5hbWVNb2RhbChcclxuICAgICAgdGhpcy5wbHVnaW4uYXBwLFxyXG4gICAgICBzb3VyY2VGaWxlRm9sZGVyLFxyXG4gICAgICAnY2FudmFzJ1xyXG4gICAgKS5hd2FpdElucHV0KClcclxuXHJcbiAgICBjb25zdCBuZXdGaWxlRGF0YSA9IHsgbm9kZXM6IHNlbGVjdGlvbi5ub2RlcywgZWRnZXM6IHNlbGVjdGlvbi5lZGdlcyB9XHJcbiAgICBjb25zdCBmaWxlID0gYXdhaXQgdGhpcy5wbHVnaW4uYXBwLnZhdWx0LmNyZWF0ZSh0YXJnZXRGaWxlUGF0aCwgSlNPTi5zdHJpbmdpZnkobmV3RmlsZURhdGEsIG51bGwsIDIpKVxyXG5cclxuICAgIC8vIFJlbW92ZSBmcm9tIGN1cnJlbnQgY2FudmFzXHJcbiAgICBmb3IgKGNvbnN0IG5vZGVEYXRhIG9mIHNlbGVjdGlvbi5ub2Rlcykge1xyXG4gICAgICBjb25zdCBub2RlID0gY2FudmFzLm5vZGVzLmdldChub2RlRGF0YS5pZClcclxuICAgICAgaWYgKG5vZGUpIGNhbnZhcy5yZW1vdmVOb2RlKG5vZGUpXHJcbiAgICB9XHJcblxyXG4gICAgLy8gQWRkIGxpbmsgdG8gbmV3IGZpbGUgaW4gY3VycmVudCBjYW52YXNcclxuICAgIGNhbnZhcy5jcmVhdGVGaWxlTm9kZSh7XHJcbiAgICAgIHBvczoge1xyXG4gICAgICAgIHg6IHNlbGVjdGlvbi5jZW50ZXIueCAtIEVOQ0FQU1VMQVRFRF9GSUxFX05PREVfU0laRS53aWR0aCAvIDIsXHJcbiAgICAgICAgeTogc2VsZWN0aW9uLmNlbnRlci55IC0gRU5DQVBTVUxBVEVEX0ZJTEVfTk9ERV9TSVpFLmhlaWdodCAvIDJcclxuICAgICAgfSxcclxuICAgICAgc2l6ZTogRU5DQVBTVUxBVEVEX0ZJTEVfTk9ERV9TSVpFLFxyXG4gICAgICBmaWxlOiBmaWxlXHJcbiAgICB9KVxyXG4gIH1cclxufSIsICJpbXBvcnQgeyBDYW52YXMgfSBmcm9tIFwic3JjL0B0eXBlcy9DYW52YXNcIlxyXG5pbXBvcnQgQWR2YW5jZWRDYW52YXNQbHVnaW4gZnJvbSBcInNyYy9tYWluXCJcclxuaW1wb3J0ICogYXMgQ2FudmFzSGVscGVyIGZyb20gXCJzcmMvdXRpbHMvY2FudmFzLWhlbHBlclwiXHJcbmltcG9ydCB7IEZpbGVTZWxlY3RNb2RhbCB9IGZyb20gXCJzcmMvdXRpbHMvbW9kYWwtaGVscGVyXCJcclxuXHJcbnR5cGUgRGlyZWN0aW9uID0gJ3VwJyB8ICdkb3duJyB8ICdsZWZ0JyB8ICdyaWdodCdcclxuY29uc3QgRElSRUNUSU9OUyA9IFsndXAnLCAnZG93bicsICdsZWZ0JywgJ3JpZ2h0J10gYXMgRGlyZWN0aW9uW11cclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIENvbW1hbmRzQ2FudmFzRXh0ZW5zaW9uIHtcclxuICBwbHVnaW46IEFkdmFuY2VkQ2FudmFzUGx1Z2luXHJcblxyXG4gIGNvbnN0cnVjdG9yKHBsdWdpbjogQWR2YW5jZWRDYW52YXNQbHVnaW4pIHtcclxuICAgIHRoaXMucGx1Z2luID0gcGx1Z2luXHJcblxyXG4gICAgaWYgKCF0aGlzLnBsdWdpbi5zZXR0aW5ncy5nZXRTZXR0aW5nKCdjb21tYW5kc0ZlYXR1cmVFbmFibGVkJykpIHJldHVyblxyXG5cclxuICAgIHRoaXMucGx1Z2luLmFkZENvbW1hbmQoe1xyXG4gICAgICBpZDogJ2NyZWF0ZS10ZXh0LW5vZGUnLFxyXG4gICAgICBuYW1lOiAnQ3JlYXRlIHRleHQgbm9kZScsXHJcbiAgICAgIGNoZWNrQ2FsbGJhY2s6IENhbnZhc0hlbHBlci5jYW52YXNDb21tYW5kKFxyXG4gICAgICAgIHRoaXMucGx1Z2luLFxyXG4gICAgICAgIChjYW52YXM6IENhbnZhcykgPT4gIWNhbnZhcy5yZWFkb25seSxcclxuICAgICAgICAoY2FudmFzOiBDYW52YXMpID0+IHRoaXMuY3JlYXRlVGV4dE5vZGUoY2FudmFzKVxyXG4gICAgICApXHJcbiAgICB9KVxyXG5cclxuICAgIHRoaXMucGx1Z2luLmFkZENvbW1hbmQoe1xyXG4gICAgICBpZDogJ2NyZWF0ZS1maWxlLW5vZGUnLFxyXG4gICAgICBuYW1lOiAnQ3JlYXRlIGZpbGUgbm9kZScsXHJcbiAgICAgIGNoZWNrQ2FsbGJhY2s6IENhbnZhc0hlbHBlci5jYW52YXNDb21tYW5kKFxyXG4gICAgICAgIHRoaXMucGx1Z2luLFxyXG4gICAgICAgIChjYW52YXM6IENhbnZhcykgPT4gIWNhbnZhcy5yZWFkb25seSxcclxuICAgICAgICAoY2FudmFzOiBDYW52YXMpID0+IHRoaXMuY3JlYXRlRmlsZU5vZGUoY2FudmFzKVxyXG4gICAgICApXHJcbiAgICB9KVxyXG5cclxuICAgIHRoaXMucGx1Z2luLmFkZENvbW1hbmQoe1xyXG4gICAgICBpZDogJ3NlbGVjdC1hbGwtZWRnZXMnLFxyXG4gICAgICBuYW1lOiAnU2VsZWN0IGFsbCBlZGdlcycsXHJcbiAgICAgIGNoZWNrQ2FsbGJhY2s6IENhbnZhc0hlbHBlci5jYW52YXNDb21tYW5kKFxyXG4gICAgICAgIHRoaXMucGx1Z2luLFxyXG4gICAgICAgIChfY2FudmFzOiBDYW52YXMpID0+IHRydWUsXHJcbiAgICAgICAgKGNhbnZhczogQ2FudmFzKSA9PiBjYW52YXMudXBkYXRlU2VsZWN0aW9uKCgpID0+IFxyXG4gICAgICAgICAgY2FudmFzLnNlbGVjdGlvbiA9IG5ldyBTZXQoY2FudmFzLmVkZ2VzLnZhbHVlcygpKVxyXG4gICAgICAgIClcclxuICAgICAgKVxyXG4gICAgfSlcclxuXHJcbiAgICB0aGlzLnBsdWdpbi5hZGRDb21tYW5kKHtcclxuICAgICAgaWQ6ICd6b29tLXRvLXNlbGVjdGlvbicsXHJcbiAgICAgIG5hbWU6ICdab29tIHRvIHNlbGVjdGlvbicsXHJcbiAgICAgIGNoZWNrQ2FsbGJhY2s6IENhbnZhc0hlbHBlci5jYW52YXNDb21tYW5kKFxyXG4gICAgICAgIHRoaXMucGx1Z2luLFxyXG4gICAgICAgIChjYW52YXM6IENhbnZhcykgPT4gY2FudmFzLnNlbGVjdGlvbi5zaXplID4gMCxcclxuICAgICAgICAoY2FudmFzOiBDYW52YXMpID0+IGNhbnZhcy56b29tVG9TZWxlY3Rpb24oKVxyXG4gICAgICApXHJcbiAgICB9KVxyXG5cclxuICAgIGZvciAoY29uc3QgZGlyZWN0aW9uIG9mIERJUkVDVElPTlMpIHtcclxuICAgICAgdGhpcy5wbHVnaW4uYWRkQ29tbWFuZCh7XHJcbiAgICAgICAgaWQ6IGBjbG9uZS1ub2RlLSR7ZGlyZWN0aW9ufWAsXHJcbiAgICAgICAgbmFtZTogYENsb25lIG5vZGUgJHtkaXJlY3Rpb259YCxcclxuICAgICAgICBjaGVja0NhbGxiYWNrOiBDYW52YXNIZWxwZXIuY2FudmFzQ29tbWFuZChcclxuICAgICAgICAgIHRoaXMucGx1Z2luLFxyXG4gICAgICAgICAgKGNhbnZhczogQ2FudmFzKSA9PiAhY2FudmFzLnJlYWRvbmx5ICYmIGNhbnZhcy5zZWxlY3Rpb24uc2l6ZSA9PT0gMSAmJiBjYW52YXMuc2VsZWN0aW9uLnZhbHVlcygpLm5leHQoKS52YWx1ZT8uZ2V0RGF0YSgpLnR5cGUgPT09ICd0ZXh0JyxcclxuICAgICAgICAgIChjYW52YXM6IENhbnZhcykgPT4gdGhpcy5jbG9uZU5vZGUoY2FudmFzLCBkaXJlY3Rpb24pXHJcbiAgICAgICAgKVxyXG4gICAgICB9KVxyXG5cclxuICAgICAgdGhpcy5wbHVnaW4uYWRkQ29tbWFuZCh7XHJcbiAgICAgICAgaWQ6IGBleHBhbmQtbm9kZS0ke2RpcmVjdGlvbn1gLFxyXG4gICAgICAgIG5hbWU6IGBFeHBhbmQgbm9kZSAke2RpcmVjdGlvbn1gLFxyXG4gICAgICAgIGNoZWNrQ2FsbGJhY2s6IENhbnZhc0hlbHBlci5jYW52YXNDb21tYW5kKFxyXG4gICAgICAgICAgdGhpcy5wbHVnaW4sXHJcbiAgICAgICAgICAoY2FudmFzOiBDYW52YXMpID0+ICFjYW52YXMucmVhZG9ubHkgJiYgY2FudmFzLnNlbGVjdGlvbi5zaXplID09PSAxLFxyXG4gICAgICAgICAgKGNhbnZhczogQ2FudmFzKSA9PiB0aGlzLmV4cGFuZE5vZGUoY2FudmFzLCBkaXJlY3Rpb24pXHJcbiAgICAgICAgKVxyXG4gICAgICB9KVxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBjcmVhdGVUZXh0Tm9kZShjYW52YXM6IENhbnZhcykge1xyXG4gICAgY29uc3Qgc2l6ZSA9IGNhbnZhcy5jb25maWcuZGVmYXVsdFRleHROb2RlRGltZW5zaW9uc1xyXG4gICAgY29uc3QgcG9zID0gQ2FudmFzSGVscGVyLmdldENlbnRlckNvb3JkaW5hdGVzKGNhbnZhcywgc2l6ZSlcclxuXHJcbiAgICBjYW52YXMuY3JlYXRlVGV4dE5vZGUoeyBwb3M6IHBvcywgc2l6ZTogc2l6ZSB9KVxyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBhc3luYyBjcmVhdGVGaWxlTm9kZShjYW52YXM6IENhbnZhcykge1xyXG4gICAgY29uc3Qgc2l6ZSA9IGNhbnZhcy5jb25maWcuZGVmYXVsdEZpbGVOb2RlRGltZW5zaW9uc1xyXG4gICAgY29uc3QgcG9zID0gQ2FudmFzSGVscGVyLmdldENlbnRlckNvb3JkaW5hdGVzKGNhbnZhcywgc2l6ZSlcclxuICAgIGNvbnN0IGZpbGUgPSBhd2FpdCBuZXcgRmlsZVNlbGVjdE1vZGFsKHRoaXMucGx1Z2luLmFwcCwgdW5kZWZpbmVkLCB0cnVlKS5hd2FpdElucHV0KClcclxuXHJcbiAgICBjYW52YXMuY3JlYXRlRmlsZU5vZGUoeyBwb3M6IHBvcywgc2l6ZTogc2l6ZSwgZmlsZTogZmlsZSB9KVxyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBjbG9uZU5vZGUoY2FudmFzOiBDYW52YXMsIGNsb25lRGlyZWN0aW9uOiBEaXJlY3Rpb24pIHtcclxuICAgIGNvbnN0IHNvdXJjZU5vZGUgPSBjYW52YXMuc2VsZWN0aW9uLnZhbHVlcygpLm5leHQoKS52YWx1ZVxyXG4gICAgaWYgKCFzb3VyY2VOb2RlKSByZXR1cm5cclxuICAgIGNvbnN0IHNvdXJjZU5vZGVEYXRhID0gc291cmNlTm9kZS5nZXREYXRhKClcclxuXHJcbiAgICBjb25zdCBub2RlTWFyZ2luID0gdGhpcy5wbHVnaW4uc2V0dGluZ3MuZ2V0U2V0dGluZygnY2xvbmVOb2RlTWFyZ2luJylcclxuICAgIGNvbnN0IG9mZnNldCA9IHsgXHJcbiAgICAgIHg6IChzb3VyY2VOb2RlLndpZHRoICsgbm9kZU1hcmdpbikgKiAoY2xvbmVEaXJlY3Rpb24gPT09ICdsZWZ0JyA/IC0xIDogKGNsb25lRGlyZWN0aW9uID09PSAncmlnaHQnID8gMSA6IDApKSxcclxuICAgICAgeTogKHNvdXJjZU5vZGUuaGVpZ2h0ICsgbm9kZU1hcmdpbikgKiAoY2xvbmVEaXJlY3Rpb24gPT09ICd1cCcgPyAtMSA6IChjbG9uZURpcmVjdGlvbiA9PT0gJ2Rvd24nID8gMSA6IDApKVxyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IGNsb25lZE5vZGUgPSBjYW52YXMuY3JlYXRlVGV4dE5vZGUoe1xyXG4gICAgICBwb3M6IHtcclxuICAgICAgICB4OiBzb3VyY2VOb2RlLnggKyBvZmZzZXQueCxcclxuICAgICAgICB5OiBzb3VyY2VOb2RlLnkgKyBvZmZzZXQueVxyXG4gICAgICB9LFxyXG4gICAgICBzaXplOiB7XHJcbiAgICAgICAgd2lkdGg6IHNvdXJjZU5vZGUud2lkdGgsXHJcbiAgICAgICAgaGVpZ2h0OiBzb3VyY2VOb2RlLmhlaWdodFxyXG4gICAgICB9XHJcbiAgICB9KVxyXG5cclxuICAgIGNsb25lZE5vZGUuc2V0RGF0YSh7IFxyXG4gICAgICAuLi5jbG9uZWROb2RlLmdldERhdGEoKSwgXHJcbiAgICAgIGNvbG9yOiBzb3VyY2VOb2RlRGF0YS5jb2xvcixcclxuICAgICAgc2hhcGU6IHNvdXJjZU5vZGVEYXRhLnNoYXBlIFxyXG4gICAgfSlcclxuXHJcbiAgICBpZiAodGhpcy5wbHVnaW4uc2V0dGluZ3MuZ2V0U2V0dGluZygnem9vbVRvQ2xvbmVkTm9kZScpKVxyXG4gICAgICBjYW52YXMuem9vbVRvQmJveChjbG9uZWROb2RlLmdldEJCb3goKSlcclxuICB9XHJcblxyXG4gIHByaXZhdGUgZXhwYW5kTm9kZShjYW52YXM6IENhbnZhcywgZXhwYW5kRGlyZWN0aW9uOiBEaXJlY3Rpb24pIHtcclxuICAgIGNvbnN0IG5vZGUgPSBjYW52YXMuc2VsZWN0aW9uLnZhbHVlcygpLm5leHQoKS52YWx1ZVxyXG4gICAgaWYgKCFub2RlKSByZXR1cm5cclxuXHJcbiAgICBjb25zdCBleHBhbmROb2RlU3RlcFNpemUgPSB0aGlzLnBsdWdpbi5zZXR0aW5ncy5nZXRTZXR0aW5nKCdleHBhbmROb2RlU3RlcFNpemUnKVxyXG4gICAgY29uc3QgZXhwYW5kID0ge1xyXG4gICAgICB4OiBleHBhbmREaXJlY3Rpb24gPT09ICdsZWZ0JyA/IC0xIDogKGV4cGFuZERpcmVjdGlvbiA9PT0gJ3JpZ2h0JyA/IDEgOiAwKSxcclxuICAgICAgeTogZXhwYW5kRGlyZWN0aW9uID09PSAndXAnID8gLTEgOiAoZXhwYW5kRGlyZWN0aW9uID09PSAnZG93bicgPyAxIDogMClcclxuICAgIH1cclxuXHJcbiAgICBub2RlLnNldERhdGEoe1xyXG4gICAgICAuLi5ub2RlLmdldERhdGEoKSxcclxuICAgICAgd2lkdGg6IG5vZGUud2lkdGggKyBleHBhbmQueCAqIGV4cGFuZE5vZGVTdGVwU2l6ZSxcclxuICAgICAgaGVpZ2h0OiBub2RlLmhlaWdodCArIGV4cGFuZC55ICogZXhwYW5kTm9kZVN0ZXBTaXplXHJcbiAgICB9KVxyXG4gIH1cclxufSIsICJpbXBvcnQgeyBURmlsZSB9IGZyb20gXCJvYnNpZGlhblwiXHJcbmltcG9ydCB7IEJCb3gsIENhbnZhcywgQ2FudmFzRGF0YSwgQ2FudmFzRWRnZSwgQ2FudmFzRWxlbWVudCwgQ2FudmFzTm9kZSwgQ2FudmFzTm9kZURhdGEgfSBmcm9tIFwic3JjL0B0eXBlcy9DYW52YXNcIlxyXG5pbXBvcnQgeyBDYW52YXNFdmVudCB9IGZyb20gXCJzcmMvY29yZS9ldmVudHNcIlxyXG5pbXBvcnQgQWR2YW5jZWRDYW52YXNQbHVnaW4gZnJvbSBcInNyYy9tYWluXCJcclxuaW1wb3J0ICogYXMgQ2FudmFzSGVscGVyIGZyb20gXCJzcmMvdXRpbHMvY2FudmFzLWhlbHBlclwiXHJcblxyXG5jb25zdCBQT1JUQUxfUEFERElORyA9IDUwXHJcbmNvbnN0IE1JTl9PUEVOX1BPUlRBTF9TSVpFID0geyB3aWR0aDogMjAwLCBoZWlnaHQ6IDIwMCB9XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3J0YWxzQ2FudmFzRXh0ZW5zaW9uIHtcclxuICBwbHVnaW46IEFkdmFuY2VkQ2FudmFzUGx1Z2luXHJcblxyXG4gIGNvbnN0cnVjdG9yKHBsdWdpbjogQWR2YW5jZWRDYW52YXNQbHVnaW4pIHtcclxuICAgIHRoaXMucGx1Z2luID0gcGx1Z2luXHJcblxyXG4gICAgaWYgKCF0aGlzLnBsdWdpbi5zZXR0aW5ncy5nZXRTZXR0aW5nKCdwb3J0YWxzRmVhdHVyZUVuYWJsZWQnKSkgcmV0dXJuXHJcblxyXG4gICAgdGhpcy5wbHVnaW4ucmVnaXN0ZXJFdmVudCh0aGlzLnBsdWdpbi5hcHAud29ya3NwYWNlLm9uKFxyXG4gICAgICBDYW52YXNFdmVudC5Qb3B1cE1lbnVDcmVhdGVkLFxyXG4gICAgICAoY2FudmFzOiBDYW52YXMpID0+IHRoaXMudXBkYXRlUG9wdXBNZW51KGNhbnZhcylcclxuICAgICkpXHJcblxyXG4gICAgdGhpcy5wbHVnaW4ucmVnaXN0ZXJFdmVudCh0aGlzLnBsdWdpbi5hcHAud29ya3NwYWNlLm9uKFxyXG4gICAgICBDYW52YXNFdmVudC5Ob2RlUmVtb3ZlZCxcclxuICAgICAgKGNhbnZhczogQ2FudmFzLCBub2RlOiBDYW52YXNOb2RlKSA9PiB0aGlzLm9uTm9kZVJlbW92ZWQoY2FudmFzLCBub2RlKVxyXG4gICAgKSlcclxuXHJcbiAgICB0aGlzLnBsdWdpbi5yZWdpc3RlckV2ZW50KHRoaXMucGx1Z2luLmFwcC53b3Jrc3BhY2Uub24oXHJcbiAgICAgIENhbnZhc0V2ZW50Lk5vZGVNb3ZlZCxcclxuICAgICAgKGNhbnZhczogQ2FudmFzLCBub2RlOiBDYW52YXNOb2RlKSA9PiB0aGlzLm9uTm9kZU1vdmVkKGNhbnZhcywgbm9kZSlcclxuICAgICkpXHJcblxyXG4gICAgdGhpcy5wbHVnaW4ucmVnaXN0ZXJFdmVudCh0aGlzLnBsdWdpbi5hcHAud29ya3NwYWNlLm9uKFxyXG4gICAgICBDYW52YXNFdmVudC5EcmFnZ2luZ1N0YXRlQ2hhbmdlZCxcclxuICAgICAgKGNhbnZhczogQ2FudmFzLCBzdGFydGVkRHJhZ2dpbmc6IGJvb2xlYW4pID0+IHRoaXMub25EcmFnZ2luZ1N0YXRlQ2hhbmdlZChjYW52YXMsIHN0YXJ0ZWREcmFnZ2luZylcclxuICAgICkpXHJcblxyXG4gICAgdGhpcy5wbHVnaW4ucmVnaXN0ZXJFdmVudCh0aGlzLnBsdWdpbi5hcHAud29ya3NwYWNlLm9uKFxyXG4gICAgICBDYW52YXNFdmVudC5Db250YWluaW5nTm9kZXNSZXF1ZXN0ZWQsXHJcbiAgICAgIChjYW52YXM6IENhbnZhcywgYmJveDogQkJveCwgbm9kZXM6IENhbnZhc05vZGVbXSkgPT4gdGhpcy5vbkNvbnRhaW5pbmdOb2Rlc1JlcXVlc3RlZChjYW52YXMsIGJib3gsIG5vZGVzKVxyXG4gICAgKSlcclxuXHJcbiAgICB0aGlzLnBsdWdpbi5yZWdpc3RlckV2ZW50KHRoaXMucGx1Z2luLmFwcC53b3Jrc3BhY2Uub24oXHJcbiAgICAgIENhbnZhc0V2ZW50LlNlbGVjdGlvbkNoYW5nZWQsXHJcbiAgICAgIChjYW52YXM6IENhbnZhcywgb2xkU2VsZWN0aW9uOiBTZXQ8Q2FudmFzRWxlbWVudD4sIHVwZGF0ZVNlbGVjdGlvbjogKHVwZGF0ZTogKCkgPT4gdm9pZCkgPT4gdm9pZCkgPT4gdGhpcy5vblNlbGVjdGlvbkNoYW5nZWQoY2FudmFzLCBvbGRTZWxlY3Rpb24sIHVwZGF0ZVNlbGVjdGlvbilcclxuICAgICkpXHJcblxyXG4gICAgdGhpcy5wbHVnaW4ucmVnaXN0ZXJFdmVudCh0aGlzLnBsdWdpbi5hcHAud29ya3NwYWNlLm9uKFxyXG4gICAgICBDYW52YXNFdmVudC5FZGdlQ2hhbmdlZCxcclxuICAgICAgKGNhbnZhczogQ2FudmFzLCBlZGdlOiBDYW52YXNFZGdlKSA9PiB0aGlzLm9uRWRnZUNoYW5nZWQoY2FudmFzLCBlZGdlKVxyXG4gICAgKSlcclxuXHJcbiAgICB0aGlzLnBsdWdpbi5yZWdpc3RlckV2ZW50KHRoaXMucGx1Z2luLmFwcC53b3Jrc3BhY2Uub24oXHJcbiAgICAgIENhbnZhc0V2ZW50LkRhdGFSZXF1ZXN0ZWQsXHJcbiAgICAgIChjYW52YXM6IENhbnZhcywgZGF0YTogQ2FudmFzRGF0YSkgPT4gdGhpcy5yZW1vdmVQb3J0YWxDYW52YXNEYXRhKGNhbnZhcywgZGF0YSlcclxuICAgICkpXHJcblxyXG4gICAgdGhpcy5wbHVnaW4ucmVnaXN0ZXJFdmVudCh0aGlzLnBsdWdpbi5hcHAud29ya3NwYWNlLm9uKFxyXG4gICAgICBDYW52YXNFdmVudC5Mb2FkRGF0YSxcclxuICAgICAgKGNhbnZhczogQ2FudmFzLCBkYXRhOiBDYW52YXNEYXRhLCBzZXREYXRhOiAoZGF0YTogQ2FudmFzRGF0YSkgPT4gdm9pZCkgPT4ge1xyXG4gICAgICAgIHRoaXMuZ2V0Q2FudmFzRGF0YVdpdGhQb3J0YWxzKGNhbnZhcywgZGF0YSlcclxuICAgICAgICAgIC50aGVuKChuZXdEYXRhOiBDYW52YXNEYXRhKSA9PiB7XHJcbiAgICAgICAgICAgIC8vIFNraXAgaWYgdGhlIGRhdGEgZGlkbid0IGNoYW5nZVxyXG4gICAgICAgICAgICBpZiAobmV3RGF0YS5ub2Rlcy5sZW5ndGggPT09IGRhdGEubm9kZXMubGVuZ3RoICYmIG5ld0RhdGEuZWRnZXMubGVuZ3RoID09PSBkYXRhLmVkZ2VzLmxlbmd0aCkgcmV0dXJuXHJcbiAgICAgICAgICAgIHNldERhdGEobmV3RGF0YSlcclxuICAgICAgICAgIH0pXHJcbiAgICAgIH1cclxuICAgICkpXHJcbiAgfVxyXG5cclxuICBwcml2YXRlIHVwZGF0ZVBvcHVwTWVudShjYW52YXM6IENhbnZhcykge1xyXG4gICAgaWYgKGNhbnZhcy5yZWFkb25seSkgcmV0dXJuXHJcblxyXG4gICAgLy8gT25seSBzZWFyY2ggZm9yIHZhbGlkIG5vZGVzXHJcbiAgICBjb25zdCBzZWxlY3RlZEZpbGVOb2RlcyA9IGNhbnZhcy5nZXRTZWxlY3Rpb25EYXRhKCkubm9kZXMubWFwKG5vZGVEYXRhID0+IHtcclxuICAgICAgY29uc3Qgbm9kZSA9IGNhbnZhcy5ub2Rlcy5nZXQobm9kZURhdGEuaWQpXHJcbiAgICAgIGlmICghbm9kZSkgcmV0dXJuIG51bGxcclxuXHJcbiAgICAgIGlmIChub2RlRGF0YS50eXBlICE9PSAnZmlsZScpIHJldHVybiBudWxsXHJcbiAgICAgIGlmIChub2RlLmZpbGU/LmV4dGVuc2lvbiA9PT0gJ2NhbnZhcycpIHJldHVybiBub2RlXHJcbiAgICAgIFxyXG4gICAgICAvLyBDbG9zZSBwb3J0YWwgb2Ygbm9uLWNhbnZhcyBmaWxlXHJcbiAgICAgIGlmIChub2RlRGF0YS5wb3J0YWxUb0ZpbGUpIHRoaXMuc2V0UG9ydGFsT3BlbihjYW52YXMsIG5vZGUsIGZhbHNlKVxyXG5cclxuICAgICAgcmV0dXJuIG51bGxcclxuICAgIH0pLmZpbHRlcihub2RlID0+IG5vZGUgIT09IG51bGwpIGFzIENhbnZhc05vZGVbXVxyXG4gICAgXHJcbiAgICBpZiAoc2VsZWN0ZWRGaWxlTm9kZXMubGVuZ3RoICE9PSAxKSByZXR1cm5cclxuXHJcbiAgICBjb25zdCBwb3J0YWxOb2RlID0gc2VsZWN0ZWRGaWxlTm9kZXNbMF1cclxuICAgIGNvbnN0IHBvcnRhbE5vZGVEYXRhID0gcG9ydGFsTm9kZS5nZXREYXRhKClcclxuXHJcbiAgICAvLyBJZiBmaWxlIGNoYW5nZWRcclxuICAgIGlmIChwb3J0YWxOb2RlRGF0YS5wb3J0YWxUb0ZpbGUgJiYgcG9ydGFsTm9kZURhdGEuZmlsZSAhPT0gcG9ydGFsTm9kZURhdGEucG9ydGFsVG9GaWxlKSB7XHJcbiAgICAgIHRoaXMuc2V0UG9ydGFsT3BlbihjYW52YXMsIHBvcnRhbE5vZGUsIHRydWUpXHJcbiAgICB9XHJcblxyXG4gICAgQ2FudmFzSGVscGVyLmFkZFBvcHVwTWVudU9wdGlvbihcclxuICAgICAgY2FudmFzLFxyXG4gICAgICBDYW52YXNIZWxwZXIuY3JlYXRlUG9wdXBNZW51T3B0aW9uKHtcclxuICAgICAgICBpZDogJ3RvZ2dsZS1wb3J0YWwnLFxyXG4gICAgICAgIGxhYmVsOiBwb3J0YWxOb2RlRGF0YS5wb3J0YWxUb0ZpbGUgPyAnQ2xvc2UgcG9ydGFsJyA6ICdPcGVuIHBvcnRhbCcsXHJcbiAgICAgICAgaWNvbjogcG9ydGFsTm9kZURhdGEucG9ydGFsVG9GaWxlID8gJ2Rvb3Itb3BlbicgOiAnZG9vci1jbG9zZWQnLFxyXG4gICAgICAgIGNhbGxiYWNrOiAoKSA9PiB7XHJcbiAgICAgICAgICB0aGlzLnNldFBvcnRhbE9wZW4oY2FudmFzLCBwb3J0YWxOb2RlLCBwb3J0YWxOb2RlRGF0YS5wb3J0YWxUb0ZpbGUgPT09IHVuZGVmaW5lZClcclxuICAgICAgICAgIHRoaXMudXBkYXRlUG9wdXBNZW51KGNhbnZhcylcclxuICAgICAgICB9XHJcbiAgICAgIH0pXHJcbiAgICApXHJcbiAgfVxyXG5cclxuICBwcml2YXRlIHNldFBvcnRhbE9wZW4oY2FudmFzOiBDYW52YXMsIHBvcnRhbE5vZGU6IENhbnZhc05vZGUsIG9wZW46IGJvb2xlYW4pIHtcclxuICAgIGNvbnN0IHBvcnRhbE5vZGVEYXRhID0gcG9ydGFsTm9kZS5nZXREYXRhKClcclxuICAgIHBvcnRhbE5vZGUuc2V0RGF0YSh7XHJcbiAgICAgIC4uLnBvcnRhbE5vZGVEYXRhLFxyXG4gICAgICBwb3J0YWxUb0ZpbGU6IG9wZW4gPyBwb3J0YWxOb2RlRGF0YS5maWxlIDogdW5kZWZpbmVkXHJcbiAgICB9KVxyXG5cclxuICAgIC8vIFVwZGF0ZSB3aG9sZSBjYW52YXMgZGF0YVxyXG4gICAgY2FudmFzLnNldERhdGEoY2FudmFzLmdldERhdGEoKSlcclxuICB9XHJcblxyXG4gIHByaXZhdGUgb25Ob2RlUmVtb3ZlZChjYW52YXM6IENhbnZhcywgbm9kZTogQ2FudmFzTm9kZSkge1xyXG4gICAgY29uc3Qgbm9kZURhdGEgPSBub2RlLmdldERhdGEoKVxyXG4gICAgaWYgKG5vZGVEYXRhLnR5cGUgIT09ICdmaWxlJyB8fCAhbm9kZURhdGEucG9ydGFsVG9GaWxlKSByZXR1cm5cclxuXHJcbiAgICAvLyBSZW1vdmUgbmVzdGVkIG5vZGVzIGFuZCBlZGdlc1xyXG4gICAgT2JqZWN0LmtleXMobm9kZURhdGEucG9ydGFsSWRNYXBzPy5ub2RlSWRNYXAgPz8ge30pLm1hcChyZWZOb2RlSWQgPT4gY2FudmFzLm5vZGVzLmdldChyZWZOb2RlSWQpKVxyXG4gICAgICAuZmlsdGVyKG5vZGUgPT4gbm9kZSAhPT0gdW5kZWZpbmVkKVxyXG4gICAgICAuZm9yRWFjaChub2RlID0+IGNhbnZhcy5yZW1vdmVOb2RlKG5vZGUhKSlcclxuXHJcbiAgICBPYmplY3Qua2V5cyhub2RlRGF0YS5wb3J0YWxJZE1hcHM/LmVkZ2VJZE1hcCA/PyB7fSkubWFwKHJlZkVkZ2VJZCA9PiBjYW52YXMuZWRnZXMuZ2V0KHJlZkVkZ2VJZCkpXHJcbiAgICAgIC5maWx0ZXIoZWRnZSA9PiBlZGdlICE9PSB1bmRlZmluZWQpXHJcbiAgICAgIC5mb3JFYWNoKGVkZ2UgPT4gY2FudmFzLnJlbW92ZUVkZ2UoZWRnZSEpKVxyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBvbkVkZ2VDaGFuZ2VkKF9jYW52YXM6IENhbnZhcywgZWRnZTogQ2FudmFzRWRnZSkge1xyXG4gICAgY29uc3QgaXNVbnNhdmVkID0gKGVkZ2UuZnJvbS5ub2RlICE9PSB1bmRlZmluZWQgJiYgZWRnZS50by5ub2RlICE9PSB1bmRlZmluZWQpICYmIC8vIEVkZ2Ugbm90IGZ1bGx5IGNvbm5lY3RlZFxyXG4gICAgICAoZWRnZS5mcm9tLm5vZGUuZ2V0RGF0YSgpLnBvcnRhbElkICE9PSB1bmRlZmluZWQgJiYgZWRnZS50by5ub2RlLmdldERhdGEoKS5wb3J0YWxJZCAhPT0gdW5kZWZpbmVkKSAmJiAvLyBCb3RoIG5vZGVzIGFyZSBmcm9tIHBvcnRhbFxyXG4gICAgICBlZGdlLmdldERhdGEoKS5wb3J0YWxJZCA9PT0gdW5kZWZpbmVkIC8vIEVkZ2UgaXMgbm90IGZyb20gcG9ydGFsXHJcblxyXG4gICAgZWRnZS5zZXREYXRhKHtcclxuICAgICAgLi4uZWRnZS5nZXREYXRhKCksIFxyXG4gICAgICBpc1Vuc2F2ZWQ6IGlzVW5zYXZlZCA/IHRydWUgOiB1bmRlZmluZWRcclxuICAgIH0pXHJcbiAgfVxyXG5cclxuICBwcml2YXRlIG9uQ29udGFpbmluZ05vZGVzUmVxdWVzdGVkKF9jYW52YXM6IENhbnZhcywgX2Jib3g6IEJCb3gsIG5vZGVzOiBDYW52YXNOb2RlW10pIHtcclxuICAgIC8vIFJlbW92ZSBub2RlcyBmcm9tIHBvcnRhbHMgZnJvbSB0aGUgbGlzdFxyXG4gICAgbm9kZXMuc3BsaWNlKDAsIG5vZGVzLmxlbmd0aCwgLi4ubm9kZXMuZmlsdGVyKG5vZGUgPT4gbm9kZS5nZXREYXRhKCkucG9ydGFsSWQgPT09IHVuZGVmaW5lZCkpXHJcbiAgfVxyXG5cclxuICBwcml2YXRlIG9uU2VsZWN0aW9uQ2hhbmdlZChjYW52YXM6IENhbnZhcywgb2xkU2VsZWN0aW9uOiBTZXQ8Q2FudmFzRWxlbWVudD4sIHVwZGF0ZVNlbGVjdGlvbjogKHVwZGF0ZTogKCkgPT4gdm9pZCkgPT4gdm9pZCkge1xyXG4gICAgLy8gVW5zZWxlY3Qgbm9kZXMgZnJvbSBwb3J0YWxzXHJcbiAgICB1cGRhdGVTZWxlY3Rpb24oKCkgPT4ge1xyXG4gICAgICBjb25zdCB1cGRhdGVkU2VsZWN0aW9uID0gQXJyYXkuZnJvbShjYW52YXMuc2VsZWN0aW9uKVxyXG4gICAgICAgIC5maWx0ZXIobm9kZSA9PiBub2RlLmdldERhdGEoKS5wb3J0YWxJZCA9PT0gdW5kZWZpbmVkKVxyXG4gICAgICBjYW52YXMuc2VsZWN0aW9uID0gbmV3IFNldCh1cGRhdGVkU2VsZWN0aW9uKVxyXG4gICAgfSlcclxuXHJcbiAgICAvLyBNb3ZlIHByZXZpb3VzbHkgc2VsZWN0ZWQgcG9ydGFscyB0byB0aGUgYmFja1xyXG4gICAgY29uc3QgcHJldmlvdXNseVNlbGVjdGVkUG9ydGFsTm9kZXNJZHMgPSBBcnJheS5mcm9tKG9sZFNlbGVjdGlvbilcclxuICAgICAgLmZpbHRlcihub2RlID0+IChub2RlLmdldERhdGEoKSBhcyBhbnkpLnBvcnRhbFRvRmlsZSAhPT0gdW5kZWZpbmVkKVxyXG4gICAgICAuZmxhdE1hcChub2RlID0+IHtcclxuICAgICAgICBjb25zdCBwb3J0YWxOb2RlRGF0YSA9IG5vZGUuZ2V0RGF0YSgpXHJcbiAgICAgICAgY29uc3QgbmVzdGVkUG9ydGFsc0lkcyA9IHRoaXMuZ2V0TmVzdGVkUG9ydGFsc0lkcyhjYW52YXMsIHBvcnRhbE5vZGVEYXRhLmlkKVxyXG5cclxuICAgICAgICByZXR1cm4gW3BvcnRhbE5vZGVEYXRhLmlkLCAuLi5uZXN0ZWRQb3J0YWxzSWRzXVxyXG4gICAgICB9KVxyXG5cclxuICAgIGZvciAoY29uc3Qgbm9kZSBvZiBjYW52YXMubm9kZXMudmFsdWVzKCkpIHtcclxuICAgICAgY29uc3Qgbm9kZURhdGEgPSBub2RlLmdldERhdGEoKVxyXG5cclxuICAgICAgLy8gTm90IGZyb20gdW5zZWxlY3RlZCBwb3J0YWxcclxuICAgICAgaWYgKG5vZGVEYXRhLnBvcnRhbElkID09PSB1bmRlZmluZWQgfHwgIXByZXZpb3VzbHlTZWxlY3RlZFBvcnRhbE5vZGVzSWRzLmluY2x1ZGVzKG5vZGVEYXRhLnBvcnRhbElkKSkgY29udGludWVcclxuXHJcbiAgICAgIC8vIE1vdmUgdG8gZnJvbnRcclxuICAgICAgbm9kZS51cGRhdGVaSW5kZXgoKVxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBnZXROZXN0ZWRQb3J0YWxzSWRzKGNhbnZhczogQ2FudmFzLCBwb3J0YWxJZDogc3RyaW5nKTogc3RyaW5nW10ge1xyXG4gICAgY29uc3QgbmVzdGVkUG9ydGFsc0lkczogc3RyaW5nW10gPSBbXVxyXG5cclxuICAgIGZvciAoY29uc3Qgbm9kZSBvZiBjYW52YXMubm9kZXMudmFsdWVzKCkpIHtcclxuICAgICAgY29uc3Qgbm9kZURhdGEgPSBub2RlLmdldERhdGEoKVxyXG5cclxuICAgICAgaWYgKG5vZGVEYXRhLnBvcnRhbElkID09PSBwb3J0YWxJZCkge1xyXG4gICAgICAgIG5lc3RlZFBvcnRhbHNJZHMucHVzaChub2RlRGF0YS5pZClcclxuICAgICAgICBuZXN0ZWRQb3J0YWxzSWRzLnB1c2goLi4udGhpcy5nZXROZXN0ZWRQb3J0YWxzSWRzKGNhbnZhcywgbm9kZURhdGEuaWQpKVxyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIG5lc3RlZFBvcnRhbHNJZHNcclxuICB9XHJcblxyXG4gIHJlc3RvcmVPYmplY3RTbmFwcGluZ1N0YXRlOiAoKSA9PiB2b2lkXHJcbiAgcHJpdmF0ZSBvbkRyYWdnaW5nU3RhdGVDaGFuZ2VkKGNhbnZhczogQ2FudmFzLCBzdGFydGVkRHJhZ2dpbmc6IGJvb2xlYW4pIHtcclxuICAgIC8vIElmIG5vIG9wZW4gcG9ydGFsIGdldHMgZHJhZ2dlZCwgcmV0dXJuXHJcbiAgICBpZiAoIWNhbnZhcy5nZXRTZWxlY3Rpb25EYXRhKCkubm9kZXMuc29tZShub2RlID0+IG5vZGUudHlwZSA9PT0gJ2ZpbGUnICYmIG5vZGUucG9ydGFsVG9GaWxlKSkgcmV0dXJuXHJcblxyXG4gICAgLy8gRGlzYWJsZSBvYmplY3Qgc25hcHBpbmcgdG8gZml4IHNlbGYtYWxpZ25pbmdcclxuICAgIGlmIChzdGFydGVkRHJhZ2dpbmcpIHtcclxuICAgICAgY29uc3Qgb2JqZWN0U25hcHBpbmdFbmFibGVkID0gY2FudmFzLm9wdGlvbnMuc25hcFRvT2JqZWN0c1xyXG4gICAgICB0aGlzLnJlc3RvcmVPYmplY3RTbmFwcGluZ1N0YXRlID0gKCkgPT4gY2FudmFzLnRvZ2dsZU9iamVjdFNuYXBwaW5nKG9iamVjdFNuYXBwaW5nRW5hYmxlZClcclxuXHJcbiAgICAgIGlmIChvYmplY3RTbmFwcGluZ0VuYWJsZWQpIGNhbnZhcy50b2dnbGVPYmplY3RTbmFwcGluZyhmYWxzZSlcclxuICAgIH0gZWxzZSB0aGlzLnJlc3RvcmVPYmplY3RTbmFwcGluZ1N0YXRlPy4oKVxyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBvbk5vZGVNb3ZlZChjYW52YXM6IENhbnZhcywgbm9kZTogQ2FudmFzTm9kZSkge1xyXG4gICAgY29uc3Qgbm9kZURhdGEgPSBub2RlLmdldERhdGEoKVxyXG4gICAgaWYgKG5vZGVEYXRhLnR5cGUgIT09ICdmaWxlJyB8fCAhbm9kZURhdGEucG9ydGFsVG9GaWxlKSByZXR1cm5cclxuXHJcbiAgICB0aGlzLm9uT3BlblBvcnRhbE1vdmVkKGNhbnZhcywgbm9kZSlcclxuICB9XHJcblxyXG4gIHByaXZhdGUgb25PcGVuUG9ydGFsTW92ZWQoY2FudmFzOiBDYW52YXMsIHBvcnRhbE5vZGU6IENhbnZhc05vZGUpIHtcclxuICAgIGxldCBwb3J0YWxOb2RlRGF0YSA9IHBvcnRhbE5vZGUuZ2V0RGF0YSgpXHJcblxyXG4gICAgLy8gVXBkYXRlIG5lc3RlZCBub2RlcyBwb3NpdGlvbnNcclxuICAgIGNvbnN0IG5lc3RlZE5vZGVzSWRNYXAgPSBwb3J0YWxOb2RlLmdldERhdGEoKS5wb3J0YWxJZE1hcHM/Lm5vZGVJZE1hcFxyXG4gICAgaWYgKCFuZXN0ZWROb2Rlc0lkTWFwKSByZXR1cm5cclxuXHJcbiAgICBjb25zdCBuZXN0ZWROb2RlcyA9IE9iamVjdC5rZXlzKG5lc3RlZE5vZGVzSWRNYXApLm1hcChyZWZOb2RlSWQgPT4gY2FudmFzLm5vZGVzLmdldChyZWZOb2RlSWQpKVxyXG4gICAgICAuZmlsdGVyKG5vZGUgPT4gbm9kZSAhPT0gdW5kZWZpbmVkKSBhcyBDYW52YXNOb2RlW11cclxuICAgIGNvbnN0IHNvdXJjZUJCb3ggPSBDYW52YXNIZWxwZXIuZ2V0QkJveChuZXN0ZWROb2RlcylcclxuXHJcbiAgICAvLyBSZXNpemUgcG9ydGFsXHJcbiAgICBjb25zdCB0YXJnZXRTaXplID0gdGhpcy5nZXRQb3J0YWxTaXplKHNvdXJjZUJCb3gpXHJcbiAgICBpZiAocG9ydGFsTm9kZURhdGEud2lkdGggIT09IHRhcmdldFNpemUud2lkdGggfHwgcG9ydGFsTm9kZURhdGEuaGVpZ2h0ICE9PSB0YXJnZXRTaXplLmhlaWdodCkge1xyXG4gICAgICBwb3J0YWxOb2RlLnNldERhdGEoe1xyXG4gICAgICAgIC4uLnBvcnRhbE5vZGVEYXRhLFxyXG4gICAgICAgIHdpZHRoOiB0YXJnZXRTaXplLndpZHRoLFxyXG4gICAgICAgIGhlaWdodDogdGFyZ2V0U2l6ZS5oZWlnaHRcclxuICAgICAgfSlcclxuXHJcbiAgICAgIHJldHVyblxyXG4gICAgfVxyXG5cclxuICAgIC8vIE1vdmUgbmVzdGVkIG5vZGVzXHJcbiAgICBjb25zdCBwb3J0YWxPZmZzZXQgPSB7XHJcbiAgICAgIHg6IHBvcnRhbE5vZGVEYXRhLnggLSBzb3VyY2VCQm94Lm1pblggKyBQT1JUQUxfUEFERElORyxcclxuICAgICAgeTogcG9ydGFsTm9kZURhdGEueSAtIHNvdXJjZUJCb3gubWluWSArIFBPUlRBTF9QQURESU5HXHJcbiAgICB9XHJcblxyXG4gICAgZm9yIChjb25zdCBuZXN0ZWROb2RlIG9mIG5lc3RlZE5vZGVzKSB7XHJcbiAgICAgIGNvbnN0IG5lc3RlZE5vZGVEYXRhID0gbmVzdGVkTm9kZS5nZXREYXRhKClcclxuXHJcbiAgICAgIG5lc3RlZE5vZGUuc2V0RGF0YSh7XHJcbiAgICAgICAgLi4ubmVzdGVkTm9kZURhdGEsXHJcbiAgICAgICAgeDogbmVzdGVkTm9kZURhdGEueCArIHBvcnRhbE9mZnNldC54LFxyXG4gICAgICAgIHk6IG5lc3RlZE5vZGVEYXRhLnkgKyBwb3J0YWxPZmZzZXQueVxyXG4gICAgICB9KVxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSByZW1vdmVQb3J0YWxDYW52YXNEYXRhKF9jYW52YXM6IENhbnZhcywgZGF0YTogQ2FudmFzRGF0YSkge1xyXG4gICAgZGF0YS5lZGdlcyA9IGRhdGEuZWRnZXMuZmlsdGVyKGVkZ2VEYXRhID0+IHtcclxuICAgICAgaWYgKGVkZ2VEYXRhLnBvcnRhbElkICE9PSB1bmRlZmluZWQpIHJldHVybiBmYWxzZVxyXG5cclxuICAgICAgY29uc3QgZnJvbU5vZGVEYXRhID0gZGF0YS5ub2Rlcy5maW5kKG5vZGVEYXRhID0+IG5vZGVEYXRhLmlkID09PSBlZGdlRGF0YS5mcm9tTm9kZSlcclxuICAgICAgY29uc3QgdG9Ob2RlRGF0YSA9IGRhdGEubm9kZXMuZmluZChub2RlRGF0YSA9PiBub2RlRGF0YS5pZCA9PT0gZWRnZURhdGEudG9Ob2RlKVxyXG4gICAgICBpZiAoIWZyb21Ob2RlRGF0YSB8fCAhdG9Ob2RlRGF0YSkgcmV0dXJuIHRydWVcclxuXHJcbiAgICAgIGlmIChmcm9tTm9kZURhdGEucG9ydGFsSWQgPT09IHVuZGVmaW5lZCAmJiB0b05vZGVEYXRhLnBvcnRhbElkID09PSB1bmRlZmluZWQpIHsgLy8gTm9ybWFsIGVkZ2VcclxuICAgICAgICByZXR1cm4gdHJ1ZSBcclxuICAgICAgfSBlbHNlIGlmIChmcm9tTm9kZURhdGEucG9ydGFsSWQgIT09IHVuZGVmaW5lZCAmJiB0b05vZGVEYXRhLnBvcnRhbElkICE9PSB1bmRlZmluZWQpIHsgLy8gQ29tcGxldGVseSBmcm9tIHBvcnRhbFxyXG4gICAgICAgIC8vIFNhdmUgdG8gcG9ydGFsIGZpbGU/IE9SIGRlbGV0ZSFcclxuICAgICAgICByZXR1cm4gZmFsc2VcclxuICAgICAgfSBlbHNlIHsgLy8gUGFydGlhbGx5IGZyb20gcG9ydGFsXHJcbiAgICAgICAgY29uc3QgZnJvbVBvcnRhbE5vZGVEYXRhID0gZnJvbU5vZGVEYXRhLnBvcnRhbElkICE9PSB1bmRlZmluZWQgPyBmcm9tTm9kZURhdGEgOiB0b05vZGVEYXRhXHJcbiAgICAgICAgY29uc3Qgbm90RnJvbVBvcnRhbE5vZGVEYXRhID0gZnJvbU5vZGVEYXRhLnBvcnRhbElkICE9PSB1bmRlZmluZWQgPyB0b05vZGVEYXRhIDogZnJvbU5vZGVEYXRhXHJcblxyXG4gICAgICAgIG5vdEZyb21Qb3J0YWxOb2RlRGF0YS5lZGdlc1RvTm9kZUZyb21Qb3J0YWwgPSBub3RGcm9tUG9ydGFsTm9kZURhdGEuZWRnZXNUb05vZGVGcm9tUG9ydGFsID8/IHt9XHJcbiAgICAgICAgbm90RnJvbVBvcnRhbE5vZGVEYXRhLmVkZ2VzVG9Ob2RlRnJvbVBvcnRhbFtmcm9tUG9ydGFsTm9kZURhdGEucG9ydGFsSWQhXSA9IG5vdEZyb21Qb3J0YWxOb2RlRGF0YS5lZGdlc1RvTm9kZUZyb21Qb3J0YWxbZnJvbVBvcnRhbE5vZGVEYXRhLnBvcnRhbElkIV0gPz8gW11cclxuICAgICAgICBub3RGcm9tUG9ydGFsTm9kZURhdGEuZWRnZXNUb05vZGVGcm9tUG9ydGFsW2Zyb21Qb3J0YWxOb2RlRGF0YS5wb3J0YWxJZCFdLnB1c2goZWRnZURhdGEpXHJcblxyXG4gICAgICAgIHJldHVybiBmYWxzZVxyXG4gICAgICB9XHJcbiAgICB9KVxyXG5cclxuICAgIGRhdGEubm9kZXMgPSBkYXRhLm5vZGVzLmZpbHRlcihub2RlRGF0YSA9PiBub2RlRGF0YS5wb3J0YWxJZCA9PT0gdW5kZWZpbmVkKVxyXG5cclxuICAgIGZvciAoY29uc3QgcG9ydGFsTm9kZURhdGEgb2YgZGF0YS5ub2Rlcykge1xyXG4gICAgICBpZiAocG9ydGFsTm9kZURhdGEudHlwZSAhPT0gJ2ZpbGUnKSBjb250aW51ZVxyXG5cclxuICAgICAgLy8gUmVzZXQgcG9ydGFsIHNpemVcclxuICAgICAgaWYgKHRoaXMucGx1Z2luLnNldHRpbmdzLmdldFNldHRpbmcoJ21haW50YWluQ2xvc2VkUG9ydGFsU2l6ZScpKSB7XHJcbiAgICAgICAgcG9ydGFsTm9kZURhdGEud2lkdGggPSBwb3J0YWxOb2RlRGF0YS5jbG9zZWRQb3J0YWxXaWR0aCA/PyBwb3J0YWxOb2RlRGF0YS53aWR0aFxyXG4gICAgICAgIHBvcnRhbE5vZGVEYXRhLmhlaWdodCA9IHBvcnRhbE5vZGVEYXRhLmNsb3NlZFBvcnRhbEhlaWdodCA/PyBwb3J0YWxOb2RlRGF0YS5oZWlnaHRcclxuICAgICAgfVxyXG5cclxuICAgICAgLy8gUmVtb3ZlIHJlZmVyZW5jZXMgdG8gcG9ydGFsIG5vZGVzIGFuZCBlZGdlc1xyXG4gICAgICBkZWxldGUgcG9ydGFsTm9kZURhdGEuY2xvc2VkUG9ydGFsV2lkdGhcclxuICAgICAgZGVsZXRlIHBvcnRhbE5vZGVEYXRhLmNsb3NlZFBvcnRhbEhlaWdodFxyXG4gICAgICBkZWxldGUgcG9ydGFsTm9kZURhdGEucG9ydGFsSWRNYXBzXHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGFzeW5jIGdldENhbnZhc0RhdGFXaXRoUG9ydGFscyhjYW52YXM6IENhbnZhcywgZGF0YVJlZjogQ2FudmFzRGF0YSk6IFByb21pc2U8Q2FudmFzRGF0YT4ge1xyXG4gICAgLy8gRGVlcCBjb3B5IGRhdGEgLSBJZiBhbm90aGVyIGZpbGUgZ2V0cyBvcGVuZWQgaW4gdGhlIHNhbWUgdmlldywgdGhlIGRhdGEgd291bGQgZ2V0IG92ZXJ3cml0dGVuXHJcbiAgICBjb25zdCBkYXRhID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShkYXRhUmVmKSkgYXMgQ2FudmFzRGF0YVxyXG5cclxuICAgIC8vIE9wZW4gcG9ydGFsc1xyXG4gICAgY29uc3QgYWRkZWREYXRhID0gYXdhaXQgUHJvbWlzZS5hbGwoZGF0YS5ub2Rlcy5tYXAobm9kZURhdGEgPT4gdGhpcy50cnlPcGVuUG9ydGFsKGNhbnZhcywgbm9kZURhdGEpKSlcclxuICAgIGZvciAoY29uc3QgbmV3RGF0YSBvZiBhZGRlZERhdGEpIHtcclxuICAgICAgZGF0YS5ub2Rlcy5wdXNoKC4uLm5ld0RhdGEubm9kZXMpXHJcbiAgICAgIGRhdGEuZWRnZXMucHVzaCguLi5uZXdEYXRhLmVkZ2VzKVxyXG4gICAgfVxyXG5cclxuICAgIC8vIEFkZCBjcm9zcy1wb3J0YWwgZWRnZXNcclxuICAgIGZvciAoY29uc3Qgb3JpZ2luTm9kZURhdGEgb2YgZGF0YS5ub2Rlcykge1xyXG4gICAgICBpZiAob3JpZ2luTm9kZURhdGEuZWRnZXNUb05vZGVGcm9tUG9ydGFsID09PSB1bmRlZmluZWQpIGNvbnRpbnVlXHJcblxyXG4gICAgICBmb3IgKGNvbnN0IFtyZWxhdGl2ZVBvcnRhbElkLCBlZGdlc10gb2YgT2JqZWN0LmVudHJpZXMob3JpZ2luTm9kZURhdGEuZWRnZXNUb05vZGVGcm9tUG9ydGFsKSkge1xyXG4gICAgICAgIGNvbnN0IGlkUHJlZml4ID0gb3JpZ2luTm9kZURhdGEucG9ydGFsSWQgPyBgJHtvcmlnaW5Ob2RlRGF0YS5wb3J0YWxJZH0tYCA6ICcnXHJcblxyXG4gICAgICAgIGNvbnN0IHBvcnRhbElkID0gYCR7aWRQcmVmaXh9JHtyZWxhdGl2ZVBvcnRhbElkfWBcclxuICAgICAgICBjb25zdCB0YXJnZXRQb3J0YWxEYXRhID0gZGF0YS5ub2Rlcy5maW5kKG5vZGVEYXRhID0+IG5vZGVEYXRhLmlkID09PSBwb3J0YWxJZClcclxuXHJcbiAgICAgICAgLy8gSWYgdGFyZ2V0IHBvcnRhbCBpcyBkZWxldGVkLCByZW1vdmUgZWRnZXNcclxuICAgICAgICBpZiAoIXRhcmdldFBvcnRhbERhdGEpIHtcclxuICAgICAgICAgIGRlbGV0ZSBvcmlnaW5Ob2RlRGF0YS5lZGdlc1RvTm9kZUZyb21Qb3J0YWwhW3BvcnRhbElkXVxyXG4gICAgICAgICAgY29udGludWVcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIElmIHBvcnRhbCBpcyBvcGVuLCBhZGQgZWRnZXNcclxuICAgICAgICBpZiAodGFyZ2V0UG9ydGFsRGF0YS5wb3J0YWxUb0ZpbGUpIHtcclxuICAgICAgICAgIC8vIFB1c2ggZWRnZXMgd2l0aCB1cGRhdGVkIGZyb20gYW5kIHRvIGlkc1xyXG4gICAgICAgICAgZGF0YS5lZGdlcy5wdXNoKC4uLmVkZ2VzLm1hcChlZGdlID0+ICh7XHJcbiAgICAgICAgICAgIC4uLmVkZ2UsXHJcbiAgICAgICAgICAgIHBvcnRhbElkOiBvcmlnaW5Ob2RlRGF0YS5wb3J0YWxJZCxcclxuICAgICAgICAgICAgZnJvbU5vZGU6IGAke2lkUHJlZml4fSR7ZWRnZS5mcm9tTm9kZX1gLFxyXG4gICAgICAgICAgICB0b05vZGU6IGAke2lkUHJlZml4fSR7ZWRnZS50b05vZGV9YFxyXG4gICAgICAgICAgfSkpKVxyXG5cclxuICAgICAgICAgIGRlbGV0ZSBvcmlnaW5Ob2RlRGF0YS5lZGdlc1RvTm9kZUZyb21Qb3J0YWwhW3BvcnRhbElkXVxyXG4gICAgICAgIH0gZWxzZSBpZiAodGhpcy5wbHVnaW4uc2V0dGluZ3MuZ2V0U2V0dGluZygnc2hvd0VkZ2VzSW50b0Rpc2FibGVkUG9ydGFscycpKSB7XHJcbiAgICAgICAgICAvLyBJZiBwb3J0YWwgaXMgY2xvc2VkLCBhZGQgYWx0ZXJuYXRpdmUgZWRnZXMgZGlyZWN0bHkgdG8gcG9ydGFsXHJcbiAgICAgICAgICAvLyBCdXQgZG9uJ3QgZGVsZXRlIHRoZSBlZGdlc1xyXG5cclxuICAgICAgICAgIGRhdGEuZWRnZXMucHVzaCguLi5lZGdlcy5tYXAoZWRnZSA9PiB7XHJcbiAgICAgICAgICAgIC8vIFdoaWNoIGVuZCBpcyBmcm9tIHBvcnRhbD9cclxuICAgICAgICAgICAgY29uc3QgZnJvbU5vZGVJZCA9IGAke2lkUHJlZml4fSR7ZWRnZS5mcm9tTm9kZX1gXHJcbiAgICAgICAgICAgIGNvbnN0IGZyb21Ob2RlID0gZGF0YS5ub2Rlcy5maW5kKG5vZGVEYXRhID0+IG5vZGVEYXRhLmlkID09PSBmcm9tTm9kZUlkKVxyXG4gICAgICAgICAgICBjb25zdCB0b05vZGVJZCA9IGAke2lkUHJlZml4fSR7ZWRnZS50b05vZGV9YFxyXG5cclxuICAgICAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgICAuLi5lZGdlLFxyXG4gICAgICAgICAgICAgIGZyb21Ob2RlOiBmcm9tTm9kZSA/IGZyb21Ob2RlSWQgOiBwb3J0YWxJZCxcclxuICAgICAgICAgICAgICB0b05vZGU6IGZyb21Ob2RlID8gcG9ydGFsSWQgOiB0b05vZGVJZCxcclxuICAgICAgICAgICAgICBwb3J0YWxJZDogcG9ydGFsSWQgLy8gTWFyayBpdCBhcyB0ZW1wb3JhcnlcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfSkpXHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcblxyXG4gICAgICAvLyBJZiBubyBtb3JlIGVkZ2VzLCBkZWxldGUgdGhlIHByb3BlcnR5XHJcbiAgICAgIGlmIChPYmplY3Qua2V5cyhvcmlnaW5Ob2RlRGF0YS5lZGdlc1RvTm9kZUZyb21Qb3J0YWwhKS5sZW5ndGggPT09IDApXHJcbiAgICAgICAgZGVsZXRlIG9yaWdpbk5vZGVEYXRhLmVkZ2VzVG9Ob2RlRnJvbVBvcnRhbFxyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiBkYXRhXHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGFzeW5jIHRyeU9wZW5Qb3J0YWwoY2FudmFzOiBDYW52YXMsIHBvcnRhbE5vZGVEYXRhOiBDYW52YXNOb2RlRGF0YSk6IFByb21pc2U8Q2FudmFzRGF0YT4ge1xyXG4gICAgY29uc3QgYWRkZWREYXRhOiBDYW52YXNEYXRhID0geyBub2RlczogW10sIGVkZ2VzOiBbXSB9XHJcbiAgICBpZiAocG9ydGFsTm9kZURhdGEudHlwZSAhPT0gJ2ZpbGUnIHx8ICFwb3J0YWxOb2RlRGF0YS5wb3J0YWxUb0ZpbGUpIHJldHVybiBhZGRlZERhdGFcclxuXHJcbiAgICAvLyBVcGRhdGUgcG9ydGFsIGZpbGVcclxuICAgIHBvcnRhbE5vZGVEYXRhLnBvcnRhbFRvRmlsZSA9IHBvcnRhbE5vZGVEYXRhLmZpbGVcclxuXHJcbiAgICAvLyBGaXggcmVjdXJzaXZlIHBvcnRhbHNcclxuICAgIGlmIChwb3J0YWxOb2RlRGF0YS5wb3J0YWxUb0ZpbGUgPT09IGNhbnZhcy52aWV3LmZpbGUucGF0aCkge1xyXG4gICAgICBwb3J0YWxOb2RlRGF0YS5wb3J0YWxUb0ZpbGUgPSB1bmRlZmluZWRcclxuICAgICAgcmV0dXJuIGFkZGVkRGF0YVxyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IHBvcnRhbEZpbGUgPSB0aGlzLnBsdWdpbi5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKHBvcnRhbE5vZGVEYXRhLmZpbGUhKVxyXG4gICAgaWYgKCEocG9ydGFsRmlsZSBpbnN0YW5jZW9mIFRGaWxlKSB8fCBwb3J0YWxGaWxlLmV4dGVuc2lvbiAhPT0gJ2NhbnZhcycpIHtcclxuICAgICAgcG9ydGFsTm9kZURhdGEucG9ydGFsVG9GaWxlID0gdW5kZWZpbmVkXHJcbiAgICAgIHJldHVybiBhZGRlZERhdGFcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCBwb3J0YWxGaWxlRGF0YSA9IEpTT04ucGFyc2UoYXdhaXQgdGhpcy5wbHVnaW4uYXBwLnZhdWx0LmNhY2hlZFJlYWQocG9ydGFsRmlsZSkpXHJcbiAgICBpZiAoIXBvcnRhbEZpbGVEYXRhKSB7XHJcbiAgICAgIHBvcnRhbE5vZGVEYXRhLnBvcnRhbFRvRmlsZSA9IHVuZGVmaW5lZFxyXG4gICAgICByZXR1cm4gYWRkZWREYXRhXHJcbiAgICB9XHJcblxyXG4gICAgLy8gQWRkIHBvcnRhbCBub2RlcyBhbmQgZWRnZXMgaWQgbWFwXHJcbiAgICBwb3J0YWxOb2RlRGF0YS5wb3J0YWxJZE1hcHMgPSB7XHJcbiAgICAgIG5vZGVJZE1hcDoge30sXHJcbiAgICAgIGVkZ2VJZE1hcDoge31cclxuICAgIH1cclxuXHJcbiAgICAvLyBDYWxjdWxhdGUgbmVzdGVkIG5vZGUgb2Zmc2V0XHJcbiAgICBjb25zdCBzb3VyY2VNaW5Db29yZGluYXRlcyA9IENhbnZhc0hlbHBlci5nZXRCQm94KHBvcnRhbEZpbGVEYXRhLm5vZGVzKVxyXG4gICAgY29uc3QgcG9ydGFsT2Zmc2V0ID0ge1xyXG4gICAgICB4OiBwb3J0YWxOb2RlRGF0YS54IC0gc291cmNlTWluQ29vcmRpbmF0ZXMubWluWCArIFBPUlRBTF9QQURESU5HLFxyXG4gICAgICB5OiBwb3J0YWxOb2RlRGF0YS55IC0gc291cmNlTWluQ29vcmRpbmF0ZXMubWluWSArIFBPUlRBTF9QQURESU5HXHJcbiAgICB9XHJcblxyXG4gICAgLy8gQWRkIG5vZGVzIGZyb20gcG9ydGFsXHJcbiAgICBmb3IgKGNvbnN0IG5vZGVEYXRhRnJvbVBvcnRhbCBvZiBwb3J0YWxGaWxlRGF0YS5ub2Rlcykge1xyXG4gICAgICBjb25zdCByZWZOb2RlSWQgPSBgJHtwb3J0YWxOb2RlRGF0YS5pZH0tJHtub2RlRGF0YUZyb21Qb3J0YWwuaWR9YFxyXG4gICAgICBwb3J0YWxOb2RlRGF0YS5wb3J0YWxJZE1hcHMubm9kZUlkTWFwW3JlZk5vZGVJZF0gPSBub2RlRGF0YUZyb21Qb3J0YWwuaWRcclxuICAgICAgXHJcbiAgICAgIGNvbnN0IGFkZGVkTm9kZSA9IHtcclxuICAgICAgICAuLi5ub2RlRGF0YUZyb21Qb3J0YWwsXHJcbiAgICAgICAgaWQ6IHJlZk5vZGVJZCxcclxuICAgICAgICB4OiBub2RlRGF0YUZyb21Qb3J0YWwueCArIHBvcnRhbE9mZnNldC54LFxyXG4gICAgICAgIHk6IG5vZGVEYXRhRnJvbVBvcnRhbC55ICsgcG9ydGFsT2Zmc2V0LnksXHJcbiAgICAgICAgcG9ydGFsSWQ6IHBvcnRhbE5vZGVEYXRhLmlkXHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGFkZGVkRGF0YS5ub2Rlcy5wdXNoKGFkZGVkTm9kZSlcclxuXHJcbiAgICAgIGNvbnN0IG5lc3RlZE5vZGVzID0gYXdhaXQgdGhpcy50cnlPcGVuUG9ydGFsKGNhbnZhcywgYWRkZWROb2RlKVxyXG4gICAgICBhZGRlZERhdGEubm9kZXMucHVzaCguLi5uZXN0ZWROb2Rlcy5ub2RlcylcclxuICAgICAgYWRkZWREYXRhLmVkZ2VzLnB1c2goLi4ubmVzdGVkTm9kZXMuZWRnZXMpXHJcbiAgICB9XHJcblxyXG4gICAgLy8gQWRkIGVkZ2VzIGZyb20gcG9ydGFsXHJcbiAgICBmb3IgKGNvbnN0IGVkZ2VEYXRhRnJvbVBvcnRhbCBvZiBwb3J0YWxGaWxlRGF0YS5lZGdlcykge1xyXG4gICAgICBjb25zdCByZWZFZGdlSWQgPSBgJHtwb3J0YWxOb2RlRGF0YS5pZH0tJHtlZGdlRGF0YUZyb21Qb3J0YWwuaWR9YFxyXG4gICAgICBwb3J0YWxOb2RlRGF0YS5wb3J0YWxJZE1hcHMuZWRnZUlkTWFwW3JlZkVkZ2VJZF0gPSBlZGdlRGF0YUZyb21Qb3J0YWwuaWRcclxuXHJcbiAgICAgIGNvbnN0IGZyb21SZWZOb2RlID0gT2JqZWN0LmVudHJpZXMocG9ydGFsTm9kZURhdGEucG9ydGFsSWRNYXBzLm5vZGVJZE1hcClcclxuICAgICAgICAuZmluZCgoW19yZWZOb2RlSWQsIG5vZGVJZF0pID0+IG5vZGVJZCA9PT0gZWRnZURhdGFGcm9tUG9ydGFsLmZyb21Ob2RlKT8uWzBdXHJcbiAgICAgIGNvbnN0IHRvUmVmTm9kZSA9IE9iamVjdC5lbnRyaWVzKHBvcnRhbE5vZGVEYXRhLnBvcnRhbElkTWFwcy5ub2RlSWRNYXApXHJcbiAgICAgICAgLmZpbmQoKFtfcmVmTm9kZUlkLCBub2RlSWRdKSA9PiBub2RlSWQgPT09IGVkZ2VEYXRhRnJvbVBvcnRhbC50b05vZGUpPy5bMF1cclxuXHJcbiAgICAgIGFkZGVkRGF0YS5lZGdlcy5wdXNoKHtcclxuICAgICAgICAuLi5lZGdlRGF0YUZyb21Qb3J0YWwsXHJcbiAgICAgICAgaWQ6IHJlZkVkZ2VJZCxcclxuICAgICAgICBmcm9tTm9kZTogZnJvbVJlZk5vZGUsXHJcbiAgICAgICAgdG9Ob2RlOiB0b1JlZk5vZGUsXHJcbiAgICAgICAgcG9ydGFsSWQ6IHBvcnRhbE5vZGVEYXRhLmlkXHJcbiAgICAgIH0pXHJcbiAgICB9XHJcblxyXG4gICAgLy8gUmVzaXplIHBvcnRhbFxyXG4gICAgY29uc3QgbmVzdGVkTm9kZXNCQm94ID0gQ2FudmFzSGVscGVyLmdldEJCb3goYWRkZWREYXRhLm5vZGVzKVxyXG4gICAgY29uc3QgdGFyZ2V0U2l6ZSA9IHRoaXMuZ2V0UG9ydGFsU2l6ZShuZXN0ZWROb2Rlc0JCb3gpXHJcblxyXG4gICAgLy8gU2F2ZSBjbG9zZWQgcG9ydGFsIHNpemVcclxuICAgIHBvcnRhbE5vZGVEYXRhLmNsb3NlZFBvcnRhbFdpZHRoID0gcG9ydGFsTm9kZURhdGEud2lkdGhcclxuICAgIHBvcnRhbE5vZGVEYXRhLmNsb3NlZFBvcnRhbEhlaWdodCA9IHBvcnRhbE5vZGVEYXRhLmhlaWdodFxyXG5cclxuICAgIC8vIFNldCBvcGVuIHBvcnRhbCBzaXplXHJcbiAgICBwb3J0YWxOb2RlRGF0YS53aWR0aCA9IHRhcmdldFNpemUud2lkdGhcclxuICAgIHBvcnRhbE5vZGVEYXRhLmhlaWdodCA9IHRhcmdldFNpemUuaGVpZ2h0XHJcblxyXG4gICAgcmV0dXJuIGFkZGVkRGF0YVxyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBnZXRQb3J0YWxTaXplKHNvdXJjZUJCb3g6IEJCb3gpIHtcclxuICAgIGNvbnN0IHNvdXJjZVNpemUgPSB7XHJcbiAgICAgIHdpZHRoOiBzb3VyY2VCQm94Lm1heFggLSBzb3VyY2VCQm94Lm1pblgsXHJcbiAgICAgIGhlaWdodDogc291cmNlQkJveC5tYXhZIC0gc291cmNlQkJveC5taW5ZXHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgdGFyZ2V0U2l6ZSA9IHtcclxuICAgICAgd2lkdGg6IE1hdGgubWF4KHNvdXJjZVNpemUud2lkdGggKyBQT1JUQUxfUEFERElORyAqIDIsIE1JTl9PUEVOX1BPUlRBTF9TSVpFLndpZHRoKSxcclxuICAgICAgaGVpZ2h0OiBNYXRoLm1heChzb3VyY2VTaXplLmhlaWdodCArIFBPUlRBTF9QQURESU5HICogMiwgTUlOX09QRU5fUE9SVEFMX1NJWkUuaGVpZ2h0KVxyXG4gICAgfVxyXG5cclxuICAgIGlmICghTnVtYmVyLmlzRmluaXRlKHRhcmdldFNpemUud2lkdGgpKSB0YXJnZXRTaXplLndpZHRoID0gTUlOX09QRU5fUE9SVEFMX1NJWkUud2lkdGhcclxuICAgIGlmICghTnVtYmVyLmlzRmluaXRlKHRhcmdldFNpemUuaGVpZ2h0KSkgdGFyZ2V0U2l6ZS5oZWlnaHQgPSBNSU5fT1BFTl9QT1JUQUxfU0laRS5oZWlnaHRcclxuXHJcbiAgICByZXR1cm4gdGFyZ2V0U2l6ZVxyXG4gIH1cclxufSIsICJpbXBvcnQgeyBhZGRJY29uIH0gZnJvbSBcIm9ic2lkaWFuXCJcclxuXHJcbmNvbnN0IENVU1RPTV9JQ09OUyA9IHtcclxuICAnb3ZhbCc6IGA8cmVjdCByeD1cIjMxLjI1XCIgaGVpZ2h0PVwiNjIuNVwiIHdpZHRoPVwiOTMuNzVcIiB5PVwiMTguNzVcIiB4PVwiMy4xMjVcIiBzdHJva2Utd2lkdGg9XCI4LjMzM1wiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIGZpbGw9XCJ0cmFuc3BhcmVudFwiLz5gLFxyXG4gICdwYXJhbGxlbG9ncmFtJzogYDxyZWN0IHRyYW5zZm9ybT1cInNrZXdYKC0yMClcIiByeD1cIjVcIiBoZWlnaHQ9XCI1MFwiIHdpZHRoPVwiNzBcIiB5PVwiMjVcIiB4PVwiMzVcIiBzdHJva2Utd2lkdGg9XCI4LjMzM1wiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIGZpbGw9XCJ0cmFuc3BhcmVudFwiLz5gLFxyXG4gICdwcmVkZWZpbmVkLXByb2Nlc3MnOiBgXHJcbiAgICA8ZyBzdHJva2Utd2lkdGg9XCIyXCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgZmlsbD1cIm5vbmVcIiB0cmFuc2Zvcm09XCJtYXRyaXgoNC4xNjY2NjcsMCwwLDQuMTY2NjY3LDAsMClcIj5cclxuICAgICAgPHBhdGggZD1cIk0gNC45OTk2ODcgMyBMIDE5LjAwMDMxMiAzIEMgMjAuMTA0Njg4IDMgMjEgMy44OTUzMTIgMjEgNC45OTk2ODcgTCAyMSAxOS4wMDAzMTIgQyAyMSAyMC4xMDQ2ODggMjAuMTA0Njg4IDIxIDE5LjAwMDMxMiAyMSBMIDQuOTk5Njg3IDIxIEMgMy44OTUzMTIgMjEgMyAyMC4xMDQ2ODggMyAxOS4wMDAzMTIgTCAzIDQuOTk5Njg3IEMgMyAzLjg5NTMxMiAzLjg5NTMxMiAzIDQuOTk5Njg3IDMgWiBNIDQuOTk5Njg3IDMgXCIvPlxyXG4gICAgICA8cGF0aCBkPVwiTSA3IDMgTCA3IDIxIFwiLz5cclxuICAgICAgPHBhdGggZD1cIk0gMTcgMyBMIDE3IDIxIFwiLz5cclxuICAgIDwvZz5cclxuICBgLFxyXG4gICdkb2N1bWVudCc6IGA8cGF0aCB0cmFuc2Zvcm09XCJ0cmFuc2xhdGUoMCwgNSlcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBmaWxsPVwibm9uZVwiIHN0cm9rZS13aWR0aD1cIjguMzMzXCIgZD1cIk04My43NSAyNUM4NS44MiAyNSA4Ny41IDI2LjY4IDg3LjUgMjguNzVMODcuNSA2NC4zNzVRNjguNzUgNTQuMjUgNTAgNjQuMzc1IDMxLjI1IDc0LjUgMTIuNSA2NC4zNzVMMTIuNSAzMC42MjUgMTIuNSAyOC43NUMxMi41IDI2LjY4IDE0LjE4IDI1IDE2LjI1IDI1WlwiLz5gLFxyXG4gICdkYXRhYmFzZS1zaGFwZSc6IGBcclxuICAgIDxnIHRyYW5zZm9ybT1cInRyYW5zbGF0ZSgyMCwgMjApXCIgc3Ryb2tlLXdpZHRoPVwiOC4zMzNcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBmaWxsPVwibm9uZVwiPlxyXG4gICAgICA8cGF0aCBkPVwiTSAxIDUxIEwgMSAxMSBDIDEgNS40OCAxNC40MyAxIDMxIDEgQyA0Ny41NyAxIDYxIDUuNDggNjEgMTEgTCA2MSA1MSBDIDYxIDU2LjUyIDQ3LjU3IDYxIDMxIDYxIEMgMTQuNDMgNjEgMSA1Ni41MiAxIDUxIFpcIi8+XHJcbiAgICAgIDxwYXRoIGQ9XCJNIDEgMTEgQyAxIDE2LjUyIDE0LjQzIDIxIDMxIDIxIEMgNDcuNTcgMjEgNjEgMTYuNTIgNjEgMTFcIi8+XHJcbiAgICA8L2c+XHJcbiAgYCxcclxuICAnZG90dGVkLWxpbmUnOiBgPHBhdGggc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgZmlsbD1cIm5vbmVcIiBzdHJva2Utd2lkdGg9XCI4LjVcIiBzdHJva2UtZGFzaGFycmF5PVwiOC41XCIgZD1cIk0yMC44NSA1MGg1OC41XCIvPmAsXHJcbiAgJ3Nob3J0LWRhc2hlZC1saW5lJzogYDxwYXRoIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIGZpbGw9XCJub25lXCIgc3Ryb2tlLXdpZHRoPVwiOC41XCIgc3Ryb2tlLWRhc2hhcnJheT1cIjEwXCIgZD1cIk0yMC44NSA1MGg1OC41XCIvPmAsXHJcbiAgJ2xvbmctZGFzaGVkLWxpbmUnOiBgPHBhdGggc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgZmlsbD1cIm5vbmVcIiBzdHJva2Utd2lkdGg9XCI4LjVcIiBzdHJva2UtZGFzaGFycmF5PVwiMjBcIiBkPVwiTTIwLjg1IDUwaDU4LjVcIi8+YFxyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBJY29uc0hlbHBlciB7XHJcbiAgc3RhdGljIGFkZEljb25zKCkge1xyXG4gICAgZm9yIChjb25zdCBbaWQsIHN2Z10gb2YgT2JqZWN0LmVudHJpZXMoQ1VTVE9NX0lDT05TKSkge1xyXG4gICAgICBhZGRJY29uKGlkLCBzdmcpXHJcbiAgICB9XHJcbiAgfVxyXG59IiwgImltcG9ydCB7IENhbnZhcywgQ2FudmFzRWRnZSwgQ2FudmFzTm9kZSB9IGZyb20gXCJzcmMvQHR5cGVzL0NhbnZhc1wiXHJcbmltcG9ydCBBZHZhbmNlZENhbnZhc1BsdWdpbiBmcm9tIFwic3JjL21haW5cIlxyXG5pbXBvcnQgKiBhcyBDYW52YXNIZWxwZXIgZnJvbSBcInNyYy91dGlscy9jYW52YXMtaGVscGVyXCJcclxuaW1wb3J0IHsgQ2FudmFzRXZlbnQgfSBmcm9tIFwic3JjL2NvcmUvZXZlbnRzXCJcclxuXHJcbmNvbnN0IElNQUdFX0ZJTEVfRVhURU5TSU9OUyA9IFtcImJtcFwiLCBcInBuZ1wiLCBcImpwZ1wiLCBcImpwZWdcIiwgXCJnaWZcIiwgXCJzdmdcIiwgXCJ3ZWJwXCIsIFwiYXZpZlwiXVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgU3RpY2tlcnNDYW52YXNFeHRlbnNpb24ge1xyXG4gIHBsdWdpbjogQWR2YW5jZWRDYW52YXNQbHVnaW5cclxuXHJcbiAgY29uc3RydWN0b3IocGx1Z2luOiBBZHZhbmNlZENhbnZhc1BsdWdpbikge1xyXG4gICAgdGhpcy5wbHVnaW4gPSBwbHVnaW5cclxuXHJcbiAgICBpZiAoIXRoaXMucGx1Z2luLnNldHRpbmdzLmdldFNldHRpbmcoJ3N0aWNrZXJzRmVhdHVyZUVuYWJsZWQnKSkgcmV0dXJuXHJcblxyXG4gICAgdGhpcy5wbHVnaW4ucmVnaXN0ZXJFdmVudCh0aGlzLnBsdWdpbi5hcHAud29ya3NwYWNlLm9uKFxyXG4gICAgICBDYW52YXNFdmVudC5Qb3B1cE1lbnVDcmVhdGVkLFxyXG4gICAgICAoY2FudmFzOiBDYW52YXMpID0+IHRoaXMub25Qb3B1cE1lbnVDcmVhdGVkKGNhbnZhcylcclxuICAgICkpXHJcbiAgfVxyXG5cclxuICBvblBvcHVwTWVudUNyZWF0ZWQoY2FudmFzOiBDYW52YXMpOiB2b2lkIHtcclxuICAgIC8vIElmIHRoZSBjYW52YXMgaXMgcmVhZG9ubHkgb3IgdGhlcmUgaXMgbm8gdmFsaWQgc2hhcGUgaW4gdGhlIHNlbGVjdGlvbiwgcmV0dXJuXHJcbiAgICBpZiAoY2FudmFzLnJlYWRvbmx5IHx8ICF0aGlzLmhhc1ZhbGlkTm9kZUluU2VsZWN0aW9uKGNhbnZhcykpXHJcbiAgICAgIHJldHVyblxyXG5cclxuICAgIENhbnZhc0hlbHBlci5hZGRQb3B1cE1lbnVPcHRpb24oXHJcbiAgICAgIGNhbnZhcyxcclxuICAgICAgQ2FudmFzSGVscGVyLmNyZWF0ZVBvcHVwTWVudU9wdGlvbih7XHJcbiAgICAgICAgaWQ6ICdzdGlja2VyLW9wdGlvbicsXHJcbiAgICAgICAgbGFiZWw6ICdUb2dnbGUgc3RpY2tlcicsXHJcbiAgICAgICAgaWNvbjogJ2JhZGdlJywgXHJcbiAgICAgICAgY2FsbGJhY2s6ICgpID0+IHRoaXMudG9nZ2xlU3RpY2tlckZvclNlbGVjdGlvbihjYW52YXMpXHJcbiAgICAgIH0pXHJcbiAgICApXHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGhhc1ZhbGlkTm9kZUluU2VsZWN0aW9uKGNhbnZhczogQ2FudmFzKTogYm9vbGVhbiB7XHJcbiAgICBjb25zdCBzZWxlY3RlZE5vZGVzRGF0YSA9IGNhbnZhcy5nZXRTZWxlY3Rpb25EYXRhKCkubm9kZXNcclxuXHJcbiAgICBmb3IgKGNvbnN0IG5vZGVEYXRhIG9mIHNlbGVjdGVkTm9kZXNEYXRhKSB7XHJcbiAgICAgIGlmIChub2RlRGF0YS50eXBlICE9PSAnZmlsZScpIGNvbnRpbnVlXHJcbiAgICAgIFxyXG4gICAgICBjb25zdCBub2RlRmlsZUV4dGVuc2lvbiA9IG5vZGVEYXRhLmZpbGU/LnNwbGl0KCcuJykucG9wKCk/LnRvTG93ZXJDYXNlKClcclxuICAgICAgaWYgKCFub2RlRmlsZUV4dGVuc2lvbikgY29udGludWVcclxuICAgICAgaWYgKCFJTUFHRV9GSUxFX0VYVEVOU0lPTlMuaW5jbHVkZXMobm9kZUZpbGVFeHRlbnNpb24pKSBjb250aW51ZVxyXG5cclxuICAgICAgcmV0dXJuIHRydWVcclxuICAgIH1cclxuICAgIFxyXG4gICAgcmV0dXJuIGZhbHNlXHJcbiAgfVxyXG5cclxuICBwcml2YXRlIHRvZ2dsZVN0aWNrZXJGb3JTZWxlY3Rpb24oY2FudmFzOiBDYW52YXMpOiB2b2lkIHtcclxuICAgIGNvbnN0IHNlbGVjdGVkTm9kZXNEYXRhID0gY2FudmFzLmdldFNlbGVjdGlvbkRhdGEoKS5ub2Rlc1xyXG5cclxuICAgIGZvciAoY29uc3Qgbm9kZURhdGEgb2Ygc2VsZWN0ZWROb2Rlc0RhdGEpIHtcclxuICAgICAgaWYgKG5vZGVEYXRhLnR5cGUgIT09ICdmaWxlJykgY29udGludWVcclxuXHJcbiAgICAgIGNvbnN0IG5vZGUgPSBjYW52YXMubm9kZXMuZ2V0KG5vZGVEYXRhLmlkKVxyXG4gICAgICBpZiAoIW5vZGUpIGNvbnRpbnVlXHJcbiAgICAgIFxyXG4gICAgICBjb25zdCB3YXNTdGlja2VyID0gbm9kZS5nZXREYXRhKCkuaXNTdGlja2VyXHJcbiAgICAgIG5vZGUuc2V0RGF0YSh7IC4uLm5vZGVEYXRhLCBpc1N0aWNrZXI6IHdhc1N0aWNrZXIgPyB1bmRlZmluZWQgOiB0cnVlIH0pXHJcbiAgICB9XHJcbiAgfVxyXG59IiwgImltcG9ydCB7IEJCb3gsIFBvc2l0aW9uLCBTaWRlIH0gZnJvbSBcInNyYy9AdHlwZXMvQ2FudmFzXCJcclxuaW1wb3J0ICogYXMgQkJveEhlbHBlciBmcm9tIFwic3JjL3V0aWxzL2Jib3gtaGVscGVyXCJcclxuXHJcbmNvbnN0IERJUkVDVElPTlMgPSBbXHJcbiAgeyBkeDogMSwgZHk6IDAgfSwgeyBkeDogLTEsIGR5OiAwIH0sIHsgZHg6IDAsIGR5OiAxIH0sIHsgZHg6IDAsIGR5OiAtMSB9LFxyXG4gIHsgZHg6IDEsIGR5OiAxIH0sIHsgZHg6IC0xLCBkeTogMSB9LCB7IGR4OiAxLCBkeTogLTEgfSwgeyBkeDogLTEsIGR5OiAtMSB9LFxyXG5dIGFzIGNvbnN0XHJcbmNvbnN0IERJQUdPTkFMX0NPU1QgPSBNYXRoLnNxcnQoMilcclxuXHJcbmNsYXNzIE5vZGUge1xyXG4gIHg6IG51bWJlclxyXG4gIHk6IG51bWJlclxyXG4gIGdDb3N0OiBudW1iZXJcclxuICBoQ29zdDogbnVtYmVyXHJcbiAgZkNvc3Q6IG51bWJlclxyXG4gIHBhcmVudDogTm9kZXxudWxsXHJcblxyXG4gIGNvbnN0cnVjdG9yKHg6IG51bWJlciwgeTogbnVtYmVyKSB7XHJcbiAgICB0aGlzLnggPSB4XHJcbiAgICB0aGlzLnkgPSB5XHJcblxyXG4gICAgdGhpcy5nQ29zdCA9IDBcclxuICAgIHRoaXMuaENvc3QgPSAwXHJcbiAgICB0aGlzLmZDb3N0ID0gMFxyXG4gICAgdGhpcy5wYXJlbnQgPSBudWxsXHJcbiAgfVxyXG5cclxuICAvLyBPbmx5IGNoZWNrIGZvciB4IGFuZCB5LCBub3QgZ0Nvc3QsIGhDb3N0LCBmQ29zdCwgb3IgcGFyZW50XHJcbiAgaW5MaXN0KG5vZGVzOiBOb2RlW10pOiBib29sZWFuIHtcclxuICAgIHJldHVybiBub2Rlcy5zb21lKG4gPT4gbi54ID09PSB0aGlzLnggJiYgbi55ID09PSB0aGlzLnkpXHJcbiAgfVxyXG59XHJcblxyXG4vLyBNYW5oYXR0YW4gZGlzdGFuY2VcclxuZnVuY3Rpb24gaGV1cmlzdGljKG5vZGU6IE5vZGUsIGVuZDogTm9kZSk6IG51bWJlciB7XHJcbiAgcmV0dXJuIE1hdGguYWJzKG5vZGUueCAtIGVuZC54KSArIE1hdGguYWJzKG5vZGUueSAtIGVuZC55KVxyXG59XHJcblxyXG4vLyBEZWZpbmUgYSBmdW5jdGlvbiB0byBjaGVjayBpZiBhIHBvc2l0aW9uIGlzbid0IGluc2lkZSBhbnkgb2JzdGFjbGVcclxuZnVuY3Rpb24gaXNUb3VjaGluZ09ic3RhY2xlKG5vZGU6IFBvc2l0aW9uLCBvYnN0YWNsZXM6IEJCb3hbXSk6IGJvb2xlYW4ge1xyXG4gIHJldHVybiBvYnN0YWNsZXMuc29tZShvYnN0YWNsZSA9PiBCQm94SGVscGVyLmluc2lkZUJCb3gobm9kZSwgb2JzdGFjbGUsIHRydWUpKVxyXG59XHJcblxyXG5mdW5jdGlvbiBpc0luc2lkZU9ic3RhY2xlKG5vZGU6IFBvc2l0aW9uLCBvYnN0YWNsZXM6IEJCb3hbXSk6IGJvb2xlYW4ge1xyXG4gIHJldHVybiBvYnN0YWNsZXMuc29tZShvYnN0YWNsZSA9PiBCQm94SGVscGVyLmluc2lkZUJCb3gobm9kZSwgb2JzdGFjbGUsIGZhbHNlKSlcclxufVxyXG5cclxuLy8gRGVmaW5lIGEgZnVuY3Rpb24gdG8gY2FsY3VsYXRlIG1vdmVtZW50IGNvc3QgYmFzZWQgb24gZGlyZWN0aW9uXHJcbmZ1bmN0aW9uIGdldE1vdmVtZW50Q29zdChkaXJlY3Rpb246IHsgZHg6IG51bWJlcjsgZHk6IG51bWJlciB9KTogbnVtYmVyIHtcclxuICByZXR1cm4gZGlyZWN0aW9uLmR4ICE9PSAwICYmIGRpcmVjdGlvbi5keSAhPT0gMCA/IERJQUdPTkFMX0NPU1QgOiAxXHJcbn1cclxuXHJcbmZ1bmN0aW9uIGdldFBvc3NpYmxlTmVpZ2hib3JzKG5vZGU6IE5vZGUsIG9ic3RhY2xlczogQkJveFtdLCBncmlkUmVzb2x1dGlvbjogbnVtYmVyKTogTm9kZVtdIHtcclxuICBjb25zdCBuZWlnaGJvcnM6IE5vZGVbXSA9IFtdXHJcbiAgXHJcbiAgZm9yIChjb25zdCBkaXJlY3Rpb24gb2YgRElSRUNUSU9OUykge1xyXG4gICAgY29uc3QgbmVpZ2hib3IgPSBuZXcgTm9kZShcclxuICAgICAgbm9kZS54ICsgZGlyZWN0aW9uLmR4ICogZ3JpZFJlc29sdXRpb24sIFxyXG4gICAgICBub2RlLnkgKyBkaXJlY3Rpb24uZHkgKiBncmlkUmVzb2x1dGlvblxyXG4gICAgKVxyXG4gICAgbmVpZ2hib3IuZ0Nvc3QgPSBub2RlLmdDb3N0ICsgZ2V0TW92ZW1lbnRDb3N0KGRpcmVjdGlvbilcclxuXHJcbiAgICBpZiAoaXNJbnNpZGVPYnN0YWNsZShuZWlnaGJvciwgb2JzdGFjbGVzKSkgY29udGludWVcclxuXHJcbiAgICBuZWlnaGJvcnMucHVzaChuZWlnaGJvcilcclxuICB9XHJcblxyXG4gIHJldHVybiBuZWlnaGJvcnNcclxufVxyXG5cclxuZnVuY3Rpb24gcmVjb25zdHJ1Y3RQYXRoKG5vZGU6IE5vZGUpOiBOb2RlW10ge1xyXG4gIGNvbnN0IHBhdGg6IE5vZGVbXSA9IFtdXHJcbiAgd2hpbGUgKG5vZGUpIHtcclxuICAgIHBhdGgucHVzaChub2RlKVxyXG4gICAgbm9kZSA9IG5vZGUucGFyZW50IVxyXG4gIH1cclxuICByZXR1cm4gcGF0aC5yZXZlcnNlKClcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGFTdGFyKGZyb21Qb3M6IFBvc2l0aW9uLCBmcm9tU2lkZTogU2lkZSwgdG9Qb3M6IFBvc2l0aW9uLCB0b1NpZGU6IFNpZGUsIG9ic3RhY2xlczogQkJveFtdLCBncmlkUmVzb2x1dGlvbjogbnVtYmVyKTogUG9zaXRpb25bXSB8IG51bGwge1xyXG4gIGNvbnN0IHN0YXJ0OiBOb2RlID0gbmV3IE5vZGUoXHJcbiAgICBNYXRoLmZsb29yKGZyb21Qb3MueCAvIGdyaWRSZXNvbHV0aW9uKSAqIGdyaWRSZXNvbHV0aW9uLFxyXG4gICAgTWF0aC5mbG9vcihmcm9tUG9zLnkgLyBncmlkUmVzb2x1dGlvbikgKiBncmlkUmVzb2x1dGlvblxyXG4gIClcclxuICAvLyBSb3VuZCBzdGFydCBhbmQgZW5kIHBvc2l0aW9ucyB0byB0aGUgbmVhcmVzdCBncmlkIGNlbGwgb3V0c2lkZSBvZiB0aGUgbm9kZXMgdG8gY29ubmVjdFxyXG4gIGlmIChmcm9tU2lkZSA9PT0gJ3JpZ2h0JyAmJiBmcm9tUG9zLnggIT09IHN0YXJ0LngpIHN0YXJ0LnggKz0gZ3JpZFJlc29sdXRpb25cclxuICBpZiAoZnJvbVNpZGUgPT09ICdib3R0b20nICYmIGZyb21Qb3MueSAhPT0gc3RhcnQueSkgc3RhcnQueSArPSBncmlkUmVzb2x1dGlvblxyXG5cclxuICBjb25zdCBlbmQ6IE5vZGUgPSBuZXcgTm9kZShcclxuICAgIE1hdGguZmxvb3IodG9Qb3MueCAvIGdyaWRSZXNvbHV0aW9uKSAqIGdyaWRSZXNvbHV0aW9uLFxyXG4gICAgTWF0aC5mbG9vcih0b1Bvcy55IC8gZ3JpZFJlc29sdXRpb24pICogZ3JpZFJlc29sdXRpb25cclxuICApXHJcbiAgLy8gUm91bmQgc3RhcnQgYW5kIGVuZCBwb3NpdGlvbnMgdG8gdGhlIG5lYXJlc3QgZ3JpZCBjZWxsIG91dHNpZGUgb2YgdGhlIG5vZGVzIHRvIGNvbm5lY3RcclxuICBpZiAodG9TaWRlID09PSAncmlnaHQnICYmIHRvUG9zLnggIT09IGVuZC54KSBlbmQueCArPSBncmlkUmVzb2x1dGlvblxyXG4gIGlmICh0b1NpZGUgPT09ICdib3R0b20nICYmIHRvUG9zLnkgIT09IGVuZC55KSBlbmQueSArPSBncmlkUmVzb2x1dGlvblxyXG4gIFxyXG4gIC8vIENoZWNrIGlmIHN0YXJ0IGFuZCBlbmQgcG9zaXRpb25zIGFyZSB2YWxpZFxyXG4gIGlmIChpc0luc2lkZU9ic3RhY2xlKHN0YXJ0LCBvYnN0YWNsZXMpIHx8IGlzSW5zaWRlT2JzdGFjbGUoZW5kLCBvYnN0YWNsZXMpKSByZXR1cm4gbnVsbFxyXG5cclxuICBjb25zdCBvcGVuU2V0OiBOb2RlW10gPSBbc3RhcnRdXHJcbiAgY29uc3QgY2xvc2VkU2V0OiBOb2RlW10gPSBbXVxyXG5cclxuICB3aGlsZSAob3BlblNldC5sZW5ndGggPiAwKSB7XHJcbiAgICAvLyBGaW5kIHRoZSBub2RlIHdpdGggdGhlIGxvd2VzdCBmQ29zdCBpbiB0aGUgb3BlbiBzZXRcclxuICAgIGxldCBjdXJyZW50OiBOb2RlfG51bGwgPSBudWxsXHJcbiAgICBsZXQgbG93ZXN0RkNvc3QgPSBJbmZpbml0eVxyXG5cclxuICAgIGZvciAoY29uc3Qgbm9kZSBvZiBvcGVuU2V0KSB7XHJcbiAgICAgIGlmIChub2RlLmZDb3N0IDwgbG93ZXN0RkNvc3QpIHtcclxuICAgICAgICBjdXJyZW50ID0gbm9kZVxyXG4gICAgICAgIGxvd2VzdEZDb3N0ID0gbm9kZS5mQ29zdFxyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLy8gTm8gcGF0aCBmb3VuZFxyXG4gICAgaWYgKCFjdXJyZW50KSByZXR1cm4gbnVsbFxyXG5cclxuICAgIC8vIFJlbW92ZSB0aGUgY3VycmVudCBub2RlIGZyb20gdGhlIG9wZW4gc2V0IGFuZCBhZGQgaXQgdG8gdGhlIGNsb3NlZCBzZXRcclxuICAgIG9wZW5TZXQuc3BsaWNlKG9wZW5TZXQuaW5kZXhPZihjdXJyZW50KSwgMSlcclxuICAgIGNsb3NlZFNldC5wdXNoKGN1cnJlbnQpXHJcblxyXG4gICAgLy8gQ2hlY2sgaWYgd2UgaGF2ZSByZWFjaGVkIHRoZSBlbmRcclxuICAgIGlmIChjdXJyZW50LnggPT09IGVuZC54ICYmIGN1cnJlbnQueSA9PT0gZW5kLnkpIHtcclxuICAgICAgcmV0dXJuIFtmcm9tUG9zLCAuLi5yZWNvbnN0cnVjdFBhdGgoY3VycmVudCksIHRvUG9zXS5tYXAobm9kZSA9PiAoeyB4OiBub2RlLngsIHk6IG5vZGUueSB9KSlcclxuICAgIH1cclxuXHJcbiAgICAvLyBMb2NhdGlvbiBpcyBub3Qgc3RhcnQgb3IgZW5kLCBhbGwgdG91Y2hpbmcgcG9zaXRpb25zIGFyZSBpbnZhbGlkXHJcbiAgICBpZiAoIShjdXJyZW50LnggPT09IHN0YXJ0LnggJiYgY3VycmVudC55ID09PSBzdGFydC55KSAmJiBpc1RvdWNoaW5nT2JzdGFjbGUoY3VycmVudCwgb2JzdGFjbGVzKSkgY29udGludWVcclxuXHJcbiAgICAvLyBFeHBhbmQgbmVpZ2hib3JzXHJcbiAgICBmb3IgKGNvbnN0IG5laWdoYm9yIG9mIGdldFBvc3NpYmxlTmVpZ2hib3JzKGN1cnJlbnQsIG9ic3RhY2xlcywgZ3JpZFJlc29sdXRpb24pKSB7XHJcbiAgICAgIGlmIChuZWlnaGJvci5pbkxpc3QoY2xvc2VkU2V0KSkgY29udGludWVcclxuXHJcbiAgICAgIC8vIENhbGN1bGF0ZSB0ZW50YXRpdmUgZ0Nvc3RcclxuICAgICAgY29uc3QgdGVudGF0aXZlR0Nvc3QgPSBjdXJyZW50LmdDb3N0ICsgZ2V0TW92ZW1lbnRDb3N0KHtcclxuICAgICAgICBkeDogbmVpZ2hib3IueCAtIGN1cnJlbnQueCxcclxuICAgICAgICBkeTogbmVpZ2hib3IueSAtIGN1cnJlbnQueSxcclxuICAgICAgfSlcclxuXHJcbiAgICAgIC8vIENoZWNrIGlmIG5laWdoYm9yIGlzIG5vdCBhbHJlYWR5IGluIHRoZSBvcGVuIHNldCBvciBpZiB0aGUgbmV3IGdDb3N0IGlzIGxvd2VyXHJcbiAgICAgIGlmICghbmVpZ2hib3IuaW5MaXN0KG9wZW5TZXQpIHx8IHRlbnRhdGl2ZUdDb3N0IDwgbmVpZ2hib3IuZ0Nvc3QpIHtcclxuICAgICAgICBuZWlnaGJvci5wYXJlbnQgPSBjdXJyZW50XHJcbiAgICAgICAgbmVpZ2hib3IuZ0Nvc3QgPSB0ZW50YXRpdmVHQ29zdFxyXG4gICAgICAgIG5laWdoYm9yLmhDb3N0ID0gaGV1cmlzdGljKG5laWdoYm9yLCBlbmQpXHJcbiAgICAgICAgbmVpZ2hib3IuZkNvc3QgPSBuZWlnaGJvci5nQ29zdCArIG5laWdoYm9yLmhDb3N0XHJcblxyXG4gICAgICAgIC8vIEFkZCBuZWlnaGJvciB0byB0aGUgb3BlbiBzZXRcclxuICAgICAgICBvcGVuU2V0LnB1c2gobmVpZ2hib3IpXHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8vIE5vIHBhdGggZm91bmRcclxuICByZXR1cm4gbnVsbFxyXG59IiwgImltcG9ydCB7IFBvc2l0aW9uIH0gZnJvbSBcInNyYy9AdHlwZXMvQ2FudmFzXCJcclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBwYXRoQXJyYXlUb1N2Z1BhdGgocG9zaXRpb25zOiBQb3NpdGlvbltdLCByb3VuZGVkID0gZmFsc2UpOiBzdHJpbmcge1xyXG4gIGNvbnN0IHRlbnNpb24gPSAwLjJcclxuICBsZXQgbmV3UG9zaXRpb25zID0gWy4uLnBvc2l0aW9uc11cclxuXHJcbiAgaWYgKHJvdW5kZWQgJiYgcG9zaXRpb25zLmxlbmd0aCA+IDIpIHtcclxuICAgIG5ld1Bvc2l0aW9ucyA9IFtwb3NpdGlvbnNbMF1dXHJcblxyXG4gICAgZm9yIChsZXQgaSA9IDE7IGkgPCBwb3NpdGlvbnMubGVuZ3RoIC0gMjsgaSsrKSB7XHJcbiAgICAgIGNvbnN0IHAxID0gcG9zaXRpb25zW2ldXHJcbiAgICAgIGNvbnN0IHAyID0gcG9zaXRpb25zW2kgKyAxXVxyXG4gICAgICBjb25zdCBwMyA9IHBvc2l0aW9uc1tpICsgMl1cclxuXHJcbiAgICAgIGNvbnN0IHQxID0gKDEgLSB0ZW5zaW9uKSAvIDJcclxuICAgICAgY29uc3QgdDIgPSAxIC0gdDFcclxuXHJcbiAgICAgIGNvbnN0IHggPVxyXG4gICAgICAgIHQyICogdDIgKiB0MiAqIHAxLnggK1xyXG4gICAgICAgIDMgKiB0MiAqIHQyICogdDEgKiBwMi54ICtcclxuICAgICAgICAzICogdDIgKiB0MSAqIHQxICogcDMueCArXHJcbiAgICAgICAgdDEgKiB0MSAqIHQxICogcDIueFxyXG5cclxuICAgICAgY29uc3QgeSA9XHJcbiAgICAgICAgdDIgKiB0MiAqIHQyICogcDEueSArXHJcbiAgICAgICAgMyAqIHQyICogdDIgKiB0MSAqIHAyLnkgK1xyXG4gICAgICAgIDMgKiB0MiAqIHQxICogdDEgKiBwMy55ICtcclxuICAgICAgICB0MSAqIHQxICogdDEgKiBwMi55XHJcblxyXG4gICAgICBuZXdQb3NpdGlvbnMucHVzaCh7IHg6IHgsIHk6IHkgfSlcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCBsYXN0UG9pbnQgPSBwb3NpdGlvbnNbcG9zaXRpb25zLmxlbmd0aCAtIDFdXHJcbiAgICBuZXdQb3NpdGlvbnMucHVzaChsYXN0UG9pbnQpXHJcbiAgfVxyXG4gICAgXHJcbiAgZm9yIChsZXQgaSA9IDA7IGkgPCBuZXdQb3NpdGlvbnMubGVuZ3RoIC0gMjsgaSsrKSB7XHJcbiAgICBjb25zdCBwMSA9IG5ld1Bvc2l0aW9uc1tpXVxyXG4gICAgY29uc3QgcDIgPSBuZXdQb3NpdGlvbnNbaSArIDFdXHJcbiAgICBjb25zdCBwMyA9IG5ld1Bvc2l0aW9uc1tpICsgMl1cclxuXHJcbiAgICBjb25zdCBjdXJyZW50RGlyZWN0aW9uID0ge1xyXG4gICAgICB4OiBwMi54IC0gcDEueCxcclxuICAgICAgeTogcDIueSAtIHAxLnlcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCBuZXh0RGlyZWN0aW9uID0ge1xyXG4gICAgICB4OiBwMy54IC0gcDIueCxcclxuICAgICAgeTogcDMueSAtIHAyLnlcclxuICAgIH1cclxuXHJcbiAgICBpZiAoY3VycmVudERpcmVjdGlvbi54ICE9PSBuZXh0RGlyZWN0aW9uLnggJiYgY3VycmVudERpcmVjdGlvbi55ICE9PSBuZXh0RGlyZWN0aW9uLnkpIGNvbnRpbnVlXHJcblxyXG4gICAgbmV3UG9zaXRpb25zLnNwbGljZShpICsgMSwgMSlcclxuICAgIGktLVxyXG4gIH1cclxuXHJcbiAgcmV0dXJuIG5ld1Bvc2l0aW9ucy5tYXAoKHBvc2l0aW9uLCBpbmRleCkgPT4gXHJcbiAgICBgJHtpbmRleCA9PT0gMCA/ICdNJyA6ICdMJ30gJHtwb3NpdGlvbi54fSAke3Bvc2l0aW9uLnl9YFxyXG4gICkuam9pbignICcpXHJcbn0iLCAiaW1wb3J0IHsgQ2FudmFzLCBDYW52YXNFZGdlLCBDYW52YXNOb2RlLCBQb3NpdGlvbiB9IGZyb20gXCJzcmMvQHR5cGVzL0NhbnZhc1wiXHJcbmltcG9ydCBBZHZhbmNlZENhbnZhc1BsdWdpbiBmcm9tIFwic3JjL21haW5cIlxyXG5pbXBvcnQgKiBhcyBDYW52YXNIZWxwZXIgZnJvbSBcInNyYy91dGlscy9jYW52YXMtaGVscGVyXCJcclxuaW1wb3J0ICogYXMgQVN0YXJIZWxwZXIgZnJvbSBcInNyYy91dGlscy9hLXN0YXItaGVscGVyXCJcclxuaW1wb3J0ICogYXMgU3ZnUGF0aEhlbHBlciBmcm9tIFwic3JjL3V0aWxzL3N2Zy1wYXRoLWhlbHBlclwiXHJcbmltcG9ydCB7IENhbnZhc0V2ZW50IH0gZnJvbSBcInNyYy9jb3JlL2V2ZW50c1wiXHJcbmltcG9ydCAqIGFzIEJCb3hIZWxwZXIgZnJvbSBcInNyYy91dGlscy9iYm94LWhlbHBlclwiXHJcblxyXG5jb25zdCBTVFlMRVNfTUVOVV9PUFRJT05TOiBDYW52YXNIZWxwZXIuTWVudU9wdGlvbltdID0gW1xyXG4gIHtcclxuICAgIGlkOiB1bmRlZmluZWQsXHJcbiAgICBsYWJlbDogJ0RlZmF1bHQnLFxyXG4gICAgaWNvbjogJ21pbnVzJ1xyXG4gIH0sXHJcbiAge1xyXG4gICAgaWQ6ICdsb25nLWRhc2hlZCcsXHJcbiAgICBsYWJlbDogJ0Rhc2hlZCAobG9uZyknLFxyXG4gICAgaWNvbjogJ2xvbmctZGFzaGVkLWxpbmUnXHJcbiAgfSxcclxuICB7XHJcbiAgICBpZDogJ3Nob3J0LWRhc2hlZCcsXHJcbiAgICBsYWJlbDogJ0Rhc2hlZCcsXHJcbiAgICBpY29uOiAnc2hvcnQtZGFzaGVkLWxpbmUnXHJcbiAgfSxcclxuICB7XHJcbiAgICBpZDogJ2RvdHRlZCcsXHJcbiAgICBsYWJlbDogJ0RvdHRlZCcsXHJcbiAgICBpY29uOiAnZG90dGVkLWxpbmUnXHJcbiAgfVxyXG5dXHJcblxyXG5jb25zdCBST1VURVNfTUVOVV9PUFRJT05TOiBDYW52YXNIZWxwZXIuTWVudU9wdGlvbltdID0gW1xyXG4gIHtcclxuICAgIGlkOiB1bmRlZmluZWQsXHJcbiAgICBsYWJlbDogJ0RlZmF1bHQnLFxyXG4gICAgaWNvbjogJ3JvdXRlJ1xyXG4gIH0sXHJcbiAge1xyXG4gICAgaWQ6ICdkaXJlY3QnLFxyXG4gICAgbGFiZWw6ICdEaXJlY3QnLFxyXG4gICAgaWNvbjogJ21pbnVzJ1xyXG4gIH0sXHJcbiAge1xyXG4gICAgaWQ6ICdzcXVhcmUnLFxyXG4gICAgbGFiZWw6ICdTcXVhcmUnLFxyXG4gICAgaWNvbjogJ2Nvcm5lci1kb3duLXJpZ2h0J1xyXG4gIH0sXHJcbiAge1xyXG4gICAgaWQ6ICdhLXN0YXInLFxyXG4gICAgbGFiZWw6ICdBKicsXHJcbiAgICBpY29uOiAnbmF2aWdhdGlvbidcclxuICB9XHJcbl1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEVkZ2VzU3R5bGVDYW52YXNFeHRlbnNpb24ge1xyXG4gIHBsdWdpbjogQWR2YW5jZWRDYW52YXNQbHVnaW5cclxuXHJcbiAgY29uc3RydWN0b3IocGx1Z2luOiBBZHZhbmNlZENhbnZhc1BsdWdpbikge1xyXG4gICAgdGhpcy5wbHVnaW4gPSBwbHVnaW5cclxuXHJcbiAgICBpZiAoIXRoaXMucGx1Z2luLnNldHRpbmdzLmdldFNldHRpbmcoJ2VkZ2VzU3R5bGluZ0ZlYXR1cmVFbmFibGVkJykpIHJldHVyblxyXG5cclxuICAgIHRoaXMucGx1Z2luLnJlZ2lzdGVyRXZlbnQodGhpcy5wbHVnaW4uYXBwLndvcmtzcGFjZS5vbihcclxuICAgICAgQ2FudmFzRXZlbnQuUG9wdXBNZW51Q3JlYXRlZCxcclxuICAgICAgKGNhbnZhczogQ2FudmFzKSA9PiB0aGlzLm9uUG9wdXBNZW51Q3JlYXRlZChjYW52YXMpXHJcbiAgICApKVxyXG5cclxuICAgIHRoaXMucGx1Z2luLnJlZ2lzdGVyRXZlbnQodGhpcy5wbHVnaW4uYXBwLndvcmtzcGFjZS5vbihcclxuICAgICAgQ2FudmFzRXZlbnQuRWRnZUNoYW5nZWQsXHJcbiAgICAgIChjYW52YXM6IENhbnZhcywgZWRnZTogQ2FudmFzRWRnZSkgPT4gdGhpcy5vbkVkZ2VDaGFuZ2VkKGNhbnZhcywgZWRnZSlcclxuICAgICkpXHJcblxyXG4gICAgdGhpcy5wbHVnaW4ucmVnaXN0ZXJFdmVudCh0aGlzLnBsdWdpbi5hcHAud29ya3NwYWNlLm9uKFxyXG4gICAgICBDYW52YXNFdmVudC5FZGdlQ2VudGVyUmVxdWVzdGVkLFxyXG4gICAgICAoY2FudmFzOiBDYW52YXMsIGVkZ2U6IENhbnZhc0VkZ2UsIGNlbnRlcjogUG9zaXRpb24pID0+IHRoaXMub25FZGdlQ2VudGVyUmVxdWVzdGVkKGNhbnZhcywgZWRnZSwgY2VudGVyKVxyXG4gICAgKSlcclxuXHJcbiAgICB0aGlzLnBsdWdpbi5yZWdpc3RlckV2ZW50KHRoaXMucGx1Z2luLmFwcC53b3Jrc3BhY2Uub24oXHJcbiAgICAgIENhbnZhc0V2ZW50Lk5vZGVBZGRlZCxcclxuICAgICAgKGNhbnZhczogQ2FudmFzLCBfbm9kZTogQ2FudmFzTm9kZSkgPT4gdGhpcy51cGRhdGVBbGxFZGdlcyhjYW52YXMpXHJcbiAgICApKVxyXG5cclxuICAgIHRoaXMucGx1Z2luLnJlZ2lzdGVyRXZlbnQodGhpcy5wbHVnaW4uYXBwLndvcmtzcGFjZS5vbihcclxuICAgICAgQ2FudmFzRXZlbnQuTm9kZVJlbW92ZWQsXHJcbiAgICAgIChjYW52YXM6IENhbnZhcywgX25vZGU6IENhbnZhc05vZGUpID0+IHRoaXMudXBkYXRlQWxsRWRnZXMoY2FudmFzKVxyXG4gICAgKSlcclxuXHJcbiAgICB0aGlzLnBsdWdpbi5yZWdpc3RlckV2ZW50KHRoaXMucGx1Z2luLmFwcC53b3Jrc3BhY2Uub24oXHJcbiAgICAgIENhbnZhc0V2ZW50LkRyYWdnaW5nU3RhdGVDaGFuZ2VkLFxyXG4gICAgICAoY2FudmFzOiBDYW52YXMsIGlzRHJhZ2dpbmc6IGJvb2xlYW4pID0+IHtcclxuICAgICAgICBpZiAoIWlzRHJhZ2dpbmcpIHRoaXMudXBkYXRlQWxsRWRnZXMoY2FudmFzKVxyXG4gICAgICB9XHJcbiAgICApKVxyXG4gIH1cclxuXHJcbiAgb25Qb3B1cE1lbnVDcmVhdGVkKGNhbnZhczogQ2FudmFzKTogdm9pZCB7XHJcbiAgICAvLyBJZiB0aGUgY2FudmFzIGlzIHJlYWRvbmx5IG9yIHRoZXJlIGlzIG5vIGVkZ2UgaW4gdGhlIHNlbGVjdGlvbiwgcmV0dXJuXHJcbiAgICBjb25zdCBzZWxlY3RlZEVkZ2VzID0gWy4uLmNhbnZhcy5zZWxlY3Rpb25dLmZpbHRlcigoaXRlbTogYW55KSA9PiBpdGVtLnBhdGggIT09IHVuZGVmaW5lZCkgYXMgQ2FudmFzRWRnZVtdXHJcbiAgICBpZiAoY2FudmFzLnJlYWRvbmx5IHx8IHNlbGVjdGVkRWRnZXMubGVuZ3RoID09PSAwKVxyXG4gICAgICByZXR1cm5cclxuXHJcbiAgICAvLyBQYXRoIHN0eWxlc1xyXG4gICAgY29uc3QgcGF0aFN0eWxlTmVzdGVkT3B0aW9ucyA9IFNUWUxFU19NRU5VX09QVElPTlMubWFwKChzdHlsZSkgPT4gKHtcclxuICAgICAgLi4uc3R5bGUsXHJcbiAgICAgIGlkOiB1bmRlZmluZWQsXHJcbiAgICAgIGNhbGxiYWNrOiAoKSA9PiB0aGlzLnNldFN0eWxlRm9yU2VsZWN0aW9uKGNhbnZhcywgc2VsZWN0ZWRFZGdlcywgc3R5bGUuaWQpXHJcbiAgICB9KSlcclxuXHJcbiAgICBjb25zdCBwYXRoU3R5bGVNZW51T3B0aW9uID0gQ2FudmFzSGVscGVyLmNyZWF0ZUV4cGFuZGFibGVQb3B1cE1lbnVPcHRpb24oe1xyXG4gICAgICBpZDogJ2VkZ2Utc3R5bGUtb3B0aW9uJyxcclxuICAgICAgbGFiZWw6ICdFZGdlIHN0eWxlJyxcclxuICAgICAgaWNvbjogJ21pbnVzJyxcclxuICAgIH0sIHBhdGhTdHlsZU5lc3RlZE9wdGlvbnMpXHJcblxyXG4gICAgLy8gQWRkIG1lbnUgb3B0aW9uIHRvIG1lbnUgYmFyXHJcbiAgICBDYW52YXNIZWxwZXIuYWRkUG9wdXBNZW51T3B0aW9uKGNhbnZhcywgcGF0aFN0eWxlTWVudU9wdGlvbiwgLTIpXHJcblxyXG4gICAgY29uc3QgcGF0aFJvdXRlTmVzdGVkT3B0aW9ucyA9IFJPVVRFU19NRU5VX09QVElPTlMubWFwKChyb3V0ZSkgPT4gKHtcclxuICAgICAgLi4ucm91dGUsXHJcbiAgICAgIGlkOiB1bmRlZmluZWQsXHJcbiAgICAgIGNhbGxiYWNrOiAoKSA9PiB0aGlzLnNldFBhdGhSb3V0ZUZvclNlbGVjdGlvbihjYW52YXMsIHNlbGVjdGVkRWRnZXMsIHJvdXRlLmlkKVxyXG4gICAgfSkpXHJcblxyXG4gICAgY29uc3QgcGF0aFJvdXRlTWVudU9wdGlvbiA9IENhbnZhc0hlbHBlci5jcmVhdGVFeHBhbmRhYmxlUG9wdXBNZW51T3B0aW9uKHtcclxuICAgICAgaWQ6ICdlZGdlLXBhdGgtcm91dGUtb3B0aW9uJyxcclxuICAgICAgbGFiZWw6ICdFZGdlIHBhdGggcm91dGUnLFxyXG4gICAgICBpY29uOiAncm91dGUnLFxyXG4gICAgfSwgcGF0aFJvdXRlTmVzdGVkT3B0aW9ucylcclxuXHJcbiAgICAvLyBBZGQgbWVudSBvcHRpb24gdG8gbWVudSBiYXJcclxuICAgIENhbnZhc0hlbHBlci5hZGRQb3B1cE1lbnVPcHRpb24oY2FudmFzLCBwYXRoUm91dGVNZW51T3B0aW9uLCAtMilcclxuICB9XHJcblxyXG4gIHByaXZhdGUgc2V0U3R5bGVGb3JTZWxlY3Rpb24oX2NhbnZhczogQ2FudmFzLCBzZWxlY3RlZEVkZ2VzOiBDYW52YXNFZGdlW10sIHN0eWxlSWQ6IHN0cmluZ3x1bmRlZmluZWQpIHtcclxuICAgIGZvciAoY29uc3QgZWRnZSBvZiBzZWxlY3RlZEVkZ2VzKSB7XHJcbiAgICAgIGVkZ2Uuc2V0RGF0YSh7IC4uLmVkZ2UuZ2V0RGF0YSgpLCBlZGdlU3R5bGU6IHN0eWxlSWQgYXMgYW55IH0pXHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIHNldFBhdGhSb3V0ZUZvclNlbGVjdGlvbihfY2FudmFzOiBDYW52YXMsIHNlbGVjdGVkRWRnZXM6IENhbnZhc0VkZ2VbXSwgcGF0aFJvdXRlVHlwZUlkOiBzdHJpbmd8dW5kZWZpbmVkKSB7XHJcbiAgICBmb3IgKGNvbnN0IGVkZ2Ugb2Ygc2VsZWN0ZWRFZGdlcykge1xyXG4gICAgICBlZGdlLnNldERhdGEoeyAuLi5lZGdlLmdldERhdGEoKSwgZWRnZVBhdGhSb3V0ZTogcGF0aFJvdXRlVHlwZUlkIGFzIGFueSB9KVxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSB1cGRhdGVBbGxFZGdlcyhjYW52YXM6IENhbnZhcykge1xyXG4gICAgZm9yIChjb25zdCBlZGdlIG9mIGNhbnZhcy5lZGdlcy52YWx1ZXMoKSkge1xyXG4gICAgICB0aGlzLm9uRWRnZUNoYW5nZWQoY2FudmFzLCBlZGdlKVxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBvbkVkZ2VDaGFuZ2VkKGNhbnZhczogQ2FudmFzLCBlZGdlOiBDYW52YXNFZGdlKSB7XHJcbiAgICBpZiAoIWVkZ2UuYmV6aWVyKSByZXR1cm5cclxuICAgIFxyXG4gICAgLy8gUmVzZXQgcGF0aCB0byBkZWZhdWx0XHJcbiAgICBlZGdlLnVwZGF0ZVBhdGgoKVxyXG4gICAgZWRnZS5jZW50ZXIgPSB1bmRlZmluZWRcclxuXHJcbiAgICBjb25zdCBwYXRoUm91dGVUeXBlID0gZWRnZS5nZXREYXRhKCkuZWRnZVBhdGhSb3V0ZSA/PyAnZGVmYXVsdCdcclxuICAgIGlmIChwYXRoUm91dGVUeXBlID09PSAnZGVmYXVsdCcpIHtcclxuICAgICAgLy8gVXBkYXRlIGxhYmVsIHBvc2l0aW9uXHJcbiAgICAgIGVkZ2UubGFiZWxFbGVtZW50Py5yZW5kZXIoKSBcclxuXHJcbiAgICAgIHJldHVyblxyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IGZyb21Qb3MgPSBlZGdlLmZyb20uZW5kID09PSAnbm9uZScgPyBcclxuICAgICAgQkJveEhlbHBlci5nZXRDZW50ZXJPZkJCb3hTaWRlKGVkZ2UuZnJvbS5ub2RlLmdldEJCb3goKSwgZWRnZS5mcm9tLnNpZGUpIDpcclxuICAgICAgZWRnZS5iZXppZXIuZnJvbVxyXG5cclxuICAgIGNvbnN0IHRvUG9zID0gZWRnZS50by5lbmQgPT09ICdub25lJyA/IFxyXG4gICAgICBCQm94SGVscGVyLmdldENlbnRlck9mQkJveFNpZGUoZWRnZS50by5ub2RlLmdldEJCb3goKSwgZWRnZS50by5zaWRlKSA6XHJcbiAgICAgIGVkZ2UuYmV6aWVyLnRvXHJcblxyXG4gICAgbGV0IG5ld1BhdGggPSBlZGdlLnBhdGguZGlzcGxheS5nZXRBdHRyaWJ1dGUoXCJkXCIpXHJcbiAgXHJcbiAgICBpZiAocGF0aFJvdXRlVHlwZSA9PT0gJ2RpcmVjdCcpIHtcclxuICAgICAgbmV3UGF0aCA9IFN2Z1BhdGhIZWxwZXIucGF0aEFycmF5VG9TdmdQYXRoKFtmcm9tUG9zLCB0b1Bvc10sIGZhbHNlKVxyXG4gICAgICBlZGdlLmNlbnRlciA9IHsgXHJcbiAgICAgICAgeDogKGZyb21Qb3MueCArIHRvUG9zLngpIC8gMiwgXHJcbiAgICAgICAgeTogKGZyb21Qb3MueSArIHRvUG9zLnkpIC8gMiBcclxuICAgICAgfVxyXG4gICAgfSBlbHNlIGlmIChwYXRoUm91dGVUeXBlID09PSAnc3F1YXJlJykge1xyXG4gICAgICBsZXQgcGF0aEFycmF5OiBQb3NpdGlvbltdID0gW11cclxuICAgICAgaWYgKGVkZ2UuZnJvbS5zaWRlID09PSAnYm90dG9tJyB8fCBlZGdlLmZyb20uc2lkZSA9PT0gJ3RvcCcpIHtcclxuICAgICAgICBwYXRoQXJyYXkgPSBbXHJcbiAgICAgICAgICBmcm9tUG9zLCBcclxuICAgICAgICAgIHsgeDogZnJvbVBvcy54LCB5OiBmcm9tUG9zLnkgKyAodG9Qb3MueSAtIGZyb21Qb3MueSkgLyAyIH0sXHJcbiAgICAgICAgICB7IHg6IHRvUG9zLngsIHk6IGZyb21Qb3MueSArICh0b1Bvcy55IC0gZnJvbVBvcy55KSAvIDIgfSxcclxuICAgICAgICAgIHRvUG9zXHJcbiAgICAgICAgXVxyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIHBhdGhBcnJheSA9IFtcclxuICAgICAgICAgIGZyb21Qb3MsIFxyXG4gICAgICAgICAgeyB4OiBmcm9tUG9zLnggKyAodG9Qb3MueCAtIGZyb21Qb3MueCkgLyAyLCB5OiBmcm9tUG9zLnkgfSxcclxuICAgICAgICAgIHsgeDogZnJvbVBvcy54ICsgKHRvUG9zLnggLSBmcm9tUG9zLngpIC8gMiwgeTogdG9Qb3MueSB9LFxyXG4gICAgICAgICAgdG9Qb3NcclxuICAgICAgICBdXHJcbiAgICAgIH1cclxuXHJcbiAgICAgIG5ld1BhdGggPSBTdmdQYXRoSGVscGVyLnBhdGhBcnJheVRvU3ZnUGF0aChwYXRoQXJyYXksIGZhbHNlKVxyXG4gICAgICBlZGdlLmNlbnRlciA9IHsgXHJcbiAgICAgICAgeDogKGZyb21Qb3MueCArIHRvUG9zLngpIC8gMiwgXHJcbiAgICAgICAgeTogKGZyb21Qb3MueSArIHRvUG9zLnkpIC8gMiBcclxuICAgICAgfVxyXG4gICAgfSBlbHNlIGlmIChwYXRoUm91dGVUeXBlID09PSAnYS1zdGFyJykge1xyXG4gICAgICBpZiAoY2FudmFzLmlzRHJhZ2dpbmcgJiYgIXRoaXMucGx1Z2luLnNldHRpbmdzLmdldFNldHRpbmcoJ2VkZ2VTdHlsZVBhdGhmaW5kZXJQYXRoTGl2ZVVwZGF0ZScpKSByZXR1cm5cclxuICAgICAgXHJcbiAgICAgIGNvbnN0IG5vZGVCQm94ZXMgPSBbLi4uY2FudmFzLm5vZGVzLnZhbHVlcygpXVxyXG4gICAgICAgIC5maWx0ZXIobm9kZSA9PiB7XHJcbiAgICAgICAgICBjb25zdCBub2RlRGF0YSA9IG5vZGUuZ2V0RGF0YSgpXHJcbiAgICAgICAgICBcclxuICAgICAgICAgIGNvbnN0IGlzR3JvdXAgPSBub2RlRGF0YS50eXBlID09PSAnZ3JvdXAnIC8vIEV4Y2x1ZGUgZ3JvdXAgbm9kZXNcclxuICAgICAgICAgIGNvbnN0IGlzT3BlblBvcnRhbCA9IG5vZGVEYXRhLnBvcnRhbFRvRmlsZSAhPT0gdW5kZWZpbmVkIC8vIEV4Y2x1ZGUgb3BlbiBwb3J0YWxzXHJcbiAgICAgICAgICBcclxuICAgICAgICAgIHJldHVybiAhaXNHcm91cCAmJiAhaXNPcGVuUG9ydGFsXHJcbiAgICAgICAgfSkubWFwKG5vZGUgPT4gbm9kZS5nZXRCQm94KCkpXHJcblxyXG4gICAgICBjb25zdCBncmlkUmVzb2x1dGlvbiA9IHRoaXMucGx1Z2luLnNldHRpbmdzLmdldFNldHRpbmcoJ2VkZ2VTdHlsZVBhdGhmaW5kZXJHcmlkUmVzb2x1dGlvbicpXHJcbiAgICAgIGNvbnN0IHBhdGhBcnJheSA9IEFTdGFySGVscGVyLmFTdGFyKGZyb21Qb3MsIGVkZ2UuZnJvbS5zaWRlLCB0b1BvcywgZWRnZS50by5zaWRlLCBub2RlQkJveGVzLCBncmlkUmVzb2x1dGlvbilcclxuICAgICAgaWYgKCFwYXRoQXJyYXkpIHJldHVybiAvLyBObyBwYXRoIGZvdW5kIC0gdXNlIGRlZmF1bHQgcGF0aFxyXG5cclxuICAgICAgY29uc3Qgcm91bmRlZFBhdGggPSB0aGlzLnBsdWdpbi5zZXR0aW5ncy5nZXRTZXR0aW5nKCdlZGdlU3R5bGVQYXRoZmluZGVyUGF0aFJvdW5kZWQnKVxyXG4gICAgICBjb25zdCBzdmdQYXRoID0gU3ZnUGF0aEhlbHBlci5wYXRoQXJyYXlUb1N2Z1BhdGgocGF0aEFycmF5LCByb3VuZGVkUGF0aClcclxuXHJcbiAgICAgIG5ld1BhdGggPSBzdmdQYXRoXHJcbiAgICAgIGVkZ2UuY2VudGVyID0gcGF0aEFycmF5W01hdGguZmxvb3IocGF0aEFycmF5Lmxlbmd0aCAvIDIpXVxyXG4gICAgfVxyXG4gICAgXHJcbiAgICBlZGdlLnBhdGguaW50ZXJhY3Rpb24uc2V0QXR0cihcImRcIiwgbmV3UGF0aClcclxuICAgIGVkZ2UucGF0aC5kaXNwbGF5LnNldEF0dHIoXCJkXCIsIG5ld1BhdGgpXHJcbiAgICBlZGdlLmxhYmVsRWxlbWVudD8ucmVuZGVyKClcclxuICB9XHJcblxyXG4gIHByaXZhdGUgb25FZGdlQ2VudGVyUmVxdWVzdGVkKF9jYW52YXM6IENhbnZhcywgZWRnZTogQ2FudmFzRWRnZSwgY2VudGVyOiBQb3NpdGlvbikge1xyXG4gICAgY2VudGVyLnggPSBlZGdlLmNlbnRlcj8ueCA/PyBjZW50ZXIueFxyXG4gICAgY2VudGVyLnkgPSBlZGdlLmNlbnRlcj8ueSA/PyBjZW50ZXIueVxyXG4gIH1cclxufSIsICJpbXBvcnQgeyBDYW52YXMsIENhbnZhc0VkZ2UsIENhbnZhc0VkZ2VEYXRhIH0gZnJvbSBcInNyYy9AdHlwZXMvQ2FudmFzXCJcclxuaW1wb3J0IHsgQ2FudmFzRXZlbnQgfSBmcm9tIFwic3JjL2NvcmUvZXZlbnRzXCJcclxuaW1wb3J0IEFkdmFuY2VkQ2FudmFzUGx1Z2luIGZyb20gXCJzcmMvbWFpblwiXHJcbmltcG9ydCBTZXR0aW5nc01hbmFnZXIgZnJvbSBcInNyYy9zZXR0aW5nc1wiXHJcblxyXG5leHBvcnQgZnVuY3Rpb24gZ2V0RXhwb3NlZEVkZ2VEYXRhKHNldHRpbmdzOiBTZXR0aW5nc01hbmFnZXIpOiAoa2V5b2YgQ2FudmFzRWRnZURhdGEpW10ge1xyXG4gIGNvbnN0IGV4cG9zZWREYXRhOiAoa2V5b2YgQ2FudmFzRWRnZURhdGEpW10gPSBbXVxyXG5cclxuICBpZiAoc2V0dGluZ3MuZ2V0U2V0dGluZygnZWRnZXNTdHlsaW5nRmVhdHVyZUVuYWJsZWQnKSkgZXhwb3NlZERhdGEucHVzaCgnZWRnZVN0eWxlJylcclxuICBpZiAoc2V0dGluZ3MuZ2V0U2V0dGluZygncG9ydGFsc0ZlYXR1cmVFbmFibGVkJykpIGV4cG9zZWREYXRhLnB1c2goJ2lzVW5zYXZlZCcpXHJcblxyXG4gIHJldHVybiBleHBvc2VkRGF0YVxyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBFZGdlRGF0YVRhZ2dlckNhbnZhc0V4dGVuc2lvbiB7XHJcbiAgcGx1Z2luOiBBZHZhbmNlZENhbnZhc1BsdWdpblxyXG5cclxuICBjb25zdHJ1Y3RvcihwbHVnaW46IEFkdmFuY2VkQ2FudmFzUGx1Z2luKSB7XHJcbiAgICB0aGlzLnBsdWdpbiA9IHBsdWdpblxyXG5cclxuICAgIHRoaXMucGx1Z2luLnJlZ2lzdGVyRXZlbnQodGhpcy5wbHVnaW4uYXBwLndvcmtzcGFjZS5vbihcclxuICAgICAgQ2FudmFzRXZlbnQuRWRnZUNoYW5nZWQsXHJcbiAgICAgIChfY2FudmFzOiBDYW52YXMsIGVkZ2U6IENhbnZhc0VkZ2UpID0+IHtcclxuICAgICAgICBjb25zdCBlZGdlRGF0YSA9IGVkZ2U/LmdldERhdGEoKVxyXG4gICAgICAgIGlmICghZWRnZURhdGEpIHJldHVyblxyXG5cclxuICAgICAgICBmb3IgKGNvbnN0IGRhdGFLZXkgb2YgZ2V0RXhwb3NlZEVkZ2VEYXRhKHRoaXMucGx1Z2luLnNldHRpbmdzKSkge1xyXG4gICAgICAgICAgY29uc3QgZGF0YVZhbHVlID0gZWRnZURhdGFbZGF0YUtleV1cclxuICAgICAgICAgIFxyXG4gICAgICAgICAgaWYgKCFkYXRhVmFsdWUpIGRlbGV0ZSBlZGdlLnBhdGguZGlzcGxheS5kYXRhc2V0W2RhdGFLZXldXHJcbiAgICAgICAgICBlbHNlIGVkZ2UucGF0aC5kaXNwbGF5LmRhdGFzZXRbZGF0YUtleV0gPSBkYXRhVmFsdWUgYXMgc3RyaW5nXHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICApKVxyXG4gIH1cclxufSIsICJpbXBvcnQgQWR2YW5jZWRDYW52YXNQbHVnaW4gZnJvbSBcInNyYy9tYWluXCJcclxuaW1wb3J0IHsgQ2FudmFzRXZlbnQgfSBmcm9tIFwiLi4vY29yZS9ldmVudHNcIlxyXG5pbXBvcnQgeyBDYW52YXMsIENhbnZhc05vZGUgfSBmcm9tIFwic3JjL0B0eXBlcy9DYW52YXNcIlxyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgRGVidWdIZWxwZXIge1xyXG4gIHBsdWdpbjogQWR2YW5jZWRDYW52YXNQbHVnaW5cclxuXHJcbiAgY29uc3RydWN0b3IocGx1Z2luOiBBZHZhbmNlZENhbnZhc1BsdWdpbikge1xyXG4gICAgdGhpcy5wbHVnaW4gPSBwbHVnaW5cclxuXHJcbiAgICB0aGlzLnBsdWdpbi5yZWdpc3RlckV2ZW50KHRoaXMucGx1Z2luLmFwcC53b3Jrc3BhY2Uub24oXHJcbiAgICAgIENhbnZhc0V2ZW50Lk5vZGVBZGRlZCxcclxuICAgICAgKF9jYW52YXM6IENhbnZhcywgX25vZGU6IENhbnZhc05vZGUpID0+IGNvbnNvbGUuY291bnQoJ1x1RDgzRFx1REZFMiBOb2RlQWRkZWQnKVxyXG4gICAgKSlcclxuXHJcbiAgICB0aGlzLnBsdWdpbi5yZWdpc3RlckV2ZW50KHRoaXMucGx1Z2luLmFwcC53b3Jrc3BhY2Uub24oXHJcbiAgICAgIENhbnZhc0V2ZW50Lk5vZGVDaGFuZ2VkLFxyXG4gICAgICAoX2NhbnZhczogQ2FudmFzLCBfbm9kZTogQ2FudmFzTm9kZSkgPT4gY29uc29sZS5jb3VudCgnXHVEODNEXHVERkUxIE5vZGVDaGFuZ2VkJylcclxuICAgICkpXHJcblxyXG4gICAgdGhpcy5wbHVnaW4ucmVnaXN0ZXJFdmVudCh0aGlzLnBsdWdpbi5hcHAud29ya3NwYWNlLm9uKFxyXG4gICAgICBDYW52YXNFdmVudC5FZGdlQWRkZWQsXHJcbiAgICAgIChfY2FudmFzOiBDYW52YXMsIF9lZGdlOiBDYW52YXNOb2RlKSA9PiBjb25zb2xlLmNvdW50KCdcdUQ4M0RcdURGRTIgRWRnZUFkZGVkJylcclxuICAgICkpXHJcblxyXG4gICAgdGhpcy5wbHVnaW4ucmVnaXN0ZXJFdmVudCh0aGlzLnBsdWdpbi5hcHAud29ya3NwYWNlLm9uKFxyXG4gICAgICBDYW52YXNFdmVudC5FZGdlQ2hhbmdlZCxcclxuICAgICAgKF9jYW52YXM6IENhbnZhcywgX2VkZ2U6IENhbnZhc05vZGUpID0+IGNvbnNvbGUuY291bnQoJ1x1RDgzRFx1REZFMSBFZGdlQ2hhbmdlZCcpXHJcbiAgICApKVxyXG4gIH1cclxufSIsICJpbXBvcnQgeyBDYW52YXMgfSBmcm9tIFwic3JjL0B0eXBlcy9DYW52YXNcIlxyXG5pbXBvcnQgeyBDYW52YXNFdmVudCB9IGZyb20gXCJzcmMvY29yZS9ldmVudHNcIlxyXG5pbXBvcnQgQWR2YW5jZWRDYW52YXNQbHVnaW4gZnJvbSBcInNyYy9tYWluXCJcclxuaW1wb3J0IFNldHRpbmdzTWFuYWdlciBmcm9tIFwic3JjL3NldHRpbmdzXCJcclxuaW1wb3J0IHsgRmlsZVNlbGVjdE1vZGFsIH0gZnJvbSBcInNyYy91dGlscy9tb2RhbC1oZWxwZXJcIlxyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgQmV0dGVyRGVmYXVsdFNldHRpbmdzQ2FudmFzRXh0ZW5zaW9uIHtcclxuICBwbHVnaW46IEFkdmFuY2VkQ2FudmFzUGx1Z2luXHJcblxyXG4gIGNvbnN0cnVjdG9yKHBsdWdpbjogQWR2YW5jZWRDYW52YXNQbHVnaW4pIHtcclxuICAgIHRoaXMucGx1Z2luID0gcGx1Z2luXHJcblxyXG4gICAgdGhpcy5wbHVnaW4ucmVnaXN0ZXJFdmVudCh0aGlzLnBsdWdpbi5hcHAud29ya3NwYWNlLm9uKFxyXG4gICAgICBTZXR0aW5nc01hbmFnZXIuU0VUVElOR1NfQ0hBTkdFRF9FVkVOVCxcclxuICAgICAgKCkgPT4gdGhpcy5hcHBseVNldHRpbmdzKHRoaXMucGx1Z2luLmdldEN1cnJlbnRDYW52YXMoKSlcclxuICAgICkpXHJcblxyXG4gICAgdGhpcy5wbHVnaW4ucmVnaXN0ZXJFdmVudCh0aGlzLnBsdWdpbi5hcHAud29ya3NwYWNlLm9uKFxyXG4gICAgICBDYW52YXNFdmVudC5DYW52YXNDaGFuZ2VkLFxyXG4gICAgICAoY2FudmFzOiBDYW52YXMpID0+IHRoaXMuYXBwbHlTZXR0aW5ncyhjYW52YXMpXHJcbiAgICApKVxyXG5cclxuICAgIHRoaXMucGx1Z2luLnJlZ2lzdGVyRXZlbnQodGhpcy5wbHVnaW4uYXBwLndvcmtzcGFjZS5vbihcclxuICAgICAgQ2FudmFzRXZlbnQuRG91YmxlQ2xpY2ssXHJcbiAgICAgIChjYW52YXM6IENhbnZhcywgZXZlbnQ6IE1vdXNlRXZlbnQsIHByZXZlbnREZWZhdWx0OiB7IHZhbHVlOiBib29sZWFuIH0pID0+IHRoaXMub25Eb3VibGVDbGljayhjYW52YXMsIGV2ZW50LCBwcmV2ZW50RGVmYXVsdClcclxuICAgICkpXHJcblxyXG4gICAgdGhpcy5hcHBseVNldHRpbmdzKHRoaXMucGx1Z2luLmdldEN1cnJlbnRDYW52YXMoKSlcclxuICB9XHJcblxyXG4gIHByaXZhdGUgYXBwbHlTZXR0aW5ncyhjYW52YXM6IENhbnZhcyB8IG51bGwpIHtcclxuICAgIGlmICghY2FudmFzKSByZXR1cm5cclxuXHJcbiAgICBjYW52YXMuY29uZmlnLmRlZmF1bHRUZXh0Tm9kZURpbWVuc2lvbnMgPSB7XHJcbiAgICAgIHdpZHRoOiB0aGlzLnBsdWdpbi5zZXR0aW5ncy5nZXRTZXR0aW5nKCdkZWZhdWx0VGV4dE5vZGVXaWR0aCcpLFxyXG4gICAgICBoZWlnaHQ6IHRoaXMucGx1Z2luLnNldHRpbmdzLmdldFNldHRpbmcoJ2RlZmF1bHRUZXh0Tm9kZUhlaWdodCcpXHJcbiAgICB9XHJcblxyXG4gICAgY2FudmFzLmNvbmZpZy5kZWZhdWx0RmlsZU5vZGVEaW1lbnNpb25zID0ge1xyXG4gICAgICB3aWR0aDogdGhpcy5wbHVnaW4uc2V0dGluZ3MuZ2V0U2V0dGluZygnZGVmYXVsdEZpbGVOb2RlV2lkdGgnKSxcclxuICAgICAgaGVpZ2h0OiB0aGlzLnBsdWdpbi5zZXR0aW5ncy5nZXRTZXR0aW5nKCdkZWZhdWx0RmlsZU5vZGVIZWlnaHQnKVxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBhc3luYyBvbkRvdWJsZUNsaWNrKGNhbnZhczogQ2FudmFzLCBldmVudDogTW91c2VFdmVudCwgcHJldmVudERlZmF1bHQ6IHsgdmFsdWU6IGJvb2xlYW4gfSkge1xyXG4gICAgaWYgKGV2ZW50LmRlZmF1bHRQcmV2ZW50ZWQgfHwgZXZlbnQudGFyZ2V0ICE9PSBjYW52YXMud3JhcHBlckVsIHx8IGNhbnZhcy5pc0RyYWdnaW5nIHx8IGNhbnZhcy5yZWFkb25seSkgcmV0dXJuXHJcbiAgICBwcmV2ZW50RGVmYXVsdC52YWx1ZSA9IHRydWVcclxuXHJcbiAgICB2YXIgcG9zID0gY2FudmFzLnBvc0Zyb21FdnQoZXZlbnQpXHJcblxyXG4gICAgc3dpdGNoICh0aGlzLnBsdWdpbi5zZXR0aW5ncy5nZXRTZXR0aW5nKCdub2RlVHlwZU9uRG91YmxlQ2xpY2snKSkge1xyXG4gICAgICBjYXNlICdmaWxlJzpcclxuICAgICAgICBjb25zdCBmaWxlID0gYXdhaXQgbmV3IEZpbGVTZWxlY3RNb2RhbCh0aGlzLnBsdWdpbi5hcHAsIHVuZGVmaW5lZCwgdHJ1ZSkuYXdhaXRJbnB1dCgpXHJcblxyXG4gICAgICAgIGNhbnZhcy5jcmVhdGVGaWxlTm9kZSh7XHJcbiAgICAgICAgICBwb3M6IHBvcyxcclxuICAgICAgICAgIHBvc2l0aW9uOiAnY2VudGVyJyxcclxuICAgICAgICAgIGZpbGU6IGZpbGVcclxuICAgICAgICB9KVxyXG5cclxuICAgICAgICBicmVha1xyXG4gICAgICBkZWZhdWx0OlxyXG4gICAgICAgIGNhbnZhcy5jcmVhdGVUZXh0Tm9kZSh7XHJcbiAgICAgICAgICBwb3M6IHBvcyxcclxuICAgICAgICAgIHBvc2l0aW9uOiAnY2VudGVyJ1xyXG4gICAgICAgIH0pXHJcblxyXG4gICAgICAgIGJyZWFrXHJcbiAgICB9XHJcbiAgfVxyXG59IiwgImltcG9ydCB7IFdvcmtzcGFjZVdpbmRvdyB9IGZyb20gXCJvYnNpZGlhblwiXHJcbmltcG9ydCB7IENhbnZhcyB9IGZyb20gXCJzcmMvQHR5cGVzL0NhbnZhc1wiXHJcbmltcG9ydCB7IENhbnZhc0V2ZW50IH0gZnJvbSBcInNyYy9jb3JlL2V2ZW50c1wiXHJcbmltcG9ydCBBZHZhbmNlZENhbnZhc1BsdWdpbiBmcm9tIFwic3JjL21haW5cIlxyXG5cclxuY29uc3QgREVGQVVMVF9DT0xPUlNfQ09VTlQgPSA2XHJcbmNvbnN0IENVU1RPTV9DT0xPUlNfTU9EX1NUWUxFU19JRCA9ICdtb2QtY3VzdG9tLWNvbG9ycydcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIENvbG9yUGFsZXR0ZUNhbnZhc0V4dGVuc2lvbiB7XHJcbiAgcGx1Z2luOiBBZHZhbmNlZENhbnZhc1BsdWdpblxyXG4gIG9ic2VydmVyOiBNdXRhdGlvbk9ic2VydmVyfG51bGwgPSBudWxsXHJcblxyXG4gIGNvbnN0cnVjdG9yKHBsdWdpbjogQWR2YW5jZWRDYW52YXNQbHVnaW4pIHtcclxuICAgIHRoaXMucGx1Z2luID0gcGx1Z2luXHJcblxyXG4gICAgdGhpcy5wbHVnaW4ucmVnaXN0ZXJFdmVudCh0aGlzLnBsdWdpbi5hcHAud29ya3NwYWNlLm9uKFxyXG4gICAgICAnd2luZG93LW9wZW4nLFxyXG4gICAgICAoX3dpbjogV29ya3NwYWNlV2luZG93LCBfd2luZG93OiBXaW5kb3cpID0+IHRoaXMudXBkYXRlQ3VzdG9tQ29sb3JNb2RTdHlsZUNsYXNzZXMoKVxyXG4gICAgKSlcclxuXHJcbiAgICB0aGlzLnBsdWdpbi5yZWdpc3RlckV2ZW50KHRoaXMucGx1Z2luLmFwcC53b3Jrc3BhY2Uub24oXHJcbiAgICAgICdjc3MtY2hhbmdlJyxcclxuICAgICAgKCkgPT4gdGhpcy51cGRhdGVDdXN0b21Db2xvck1vZFN0eWxlQ2xhc3NlcygpXHJcbiAgICApKVxyXG5cclxuICAgIHRoaXMudXBkYXRlQ3VzdG9tQ29sb3JNb2RTdHlsZUNsYXNzZXMoKVxyXG5cclxuICAgIHRoaXMucGx1Z2luLnJlZ2lzdGVyRXZlbnQodGhpcy5wbHVnaW4uYXBwLndvcmtzcGFjZS5vbihcclxuICAgICAgQ2FudmFzRXZlbnQuUG9wdXBNZW51Q3JlYXRlZCxcclxuICAgICAgKGNhbnZhczogQ2FudmFzKSA9PiB0aGlzLnBhdGNoQ29sb3JTZWxlY3Rpb24oY2FudmFzKVxyXG4gICAgKSlcclxuXHJcbiAgICB0aGlzLnBsdWdpbi5yZWdpc3RlcigoKSA9PiB0aGlzLm9ic2VydmVyPy5kaXNjb25uZWN0KCkpXHJcbiAgfVxyXG5cclxuICBwcml2YXRlIHVwZGF0ZUN1c3RvbUNvbG9yTW9kU3R5bGVDbGFzc2VzKCkge1xyXG4gICAgY29uc3QgY3VzdG9tQ3NzID0gdGhpcy5nZXRDdXN0b21Db2xvcnMoKS5tYXAoKGNvbG9ySWQpID0+IGBcclxuICAgICAgLm1vZC1jYW52YXMtY29sb3ItJHtjb2xvcklkfSB7XHJcbiAgICAgICAgLS1jYW52YXMtY29sb3I6IHZhcigtLWNhbnZhcy1jb2xvci0ke2NvbG9ySWR9KTtcclxuICAgICAgfVxyXG4gICAgYCkuam9pbignJylcclxuXHJcbiAgICBmb3IgKGNvbnN0IHdpbiBvZiB0aGlzLnBsdWdpbi53aW5kb3dzTWFuYWdlci53aW5kb3dzKSB7XHJcbiAgICAgIGNvbnN0IGRvYyA9IHdpbi5kb2N1bWVudFxyXG4gICAgICBcclxuICAgICAgZG9jLmdldEVsZW1lbnRCeUlkKENVU1RPTV9DT0xPUlNfTU9EX1NUWUxFU19JRCk/LnJlbW92ZSgpXHJcblxyXG4gICAgICBjb25zdCBjdXN0b21Db2xvck1vZFN0eWxlID0gZG9jLmNyZWF0ZUVsZW1lbnQoJ3N0eWxlJylcclxuICAgICAgY3VzdG9tQ29sb3JNb2RTdHlsZS5pZCA9IENVU1RPTV9DT0xPUlNfTU9EX1NUWUxFU19JRFxyXG4gICAgICBkb2MuaGVhZC5hcHBlbmRDaGlsZChjdXN0b21Db2xvck1vZFN0eWxlKVxyXG5cclxuICAgICAgY3VzdG9tQ29sb3JNb2RTdHlsZS50ZXh0Q29udGVudCA9IGN1c3RvbUNzc1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBwYXRjaENvbG9yU2VsZWN0aW9uKGNhbnZhczogQ2FudmFzKSB7XHJcbiAgICBpZiAodGhpcy5vYnNlcnZlcikgdGhpcy5vYnNlcnZlci5kaXNjb25uZWN0KClcclxuXHJcbiAgICB0aGlzLm9ic2VydmVyID0gbmV3IE11dGF0aW9uT2JzZXJ2ZXIobXV0YXRpb25zID0+IHtcclxuICAgICAgY29uc3QgY29sb3JNZW51T3BlbmVkID0gbXV0YXRpb25zLnNvbWUobXV0YXRpb24gPT4gXHJcbiAgICAgICAgT2JqZWN0LnZhbHVlcyhtdXRhdGlvbi5hZGRlZE5vZGVzKS5zb21lKChub2RlOiBOb2RlKSA9PiBcclxuICAgICAgICAgIG5vZGUgaW5zdGFuY2VvZiBIVE1MRWxlbWVudCAmJiBub2RlLmNsYXNzTGlzdC5jb250YWlucygnY2FudmFzLXN1Ym1lbnUnKSAmJiBPYmplY3QudmFsdWVzKG5vZGUuY2hpbGROb2Rlcykuc29tZSgobm9kZTogTm9kZSkgPT5cclxuICAgICAgICAgICAgbm9kZSBpbnN0YW5jZW9mIEhUTUxFbGVtZW50ICYmIG5vZGUuY2xhc3NMaXN0LmNvbnRhaW5zKCdjYW52YXMtY29sb3ItcGlja2VyLWl0ZW0nKVxyXG4gICAgICAgICAgKVxyXG4gICAgICAgIClcclxuICAgICAgKVxyXG4gICAgICBpZiAoIWNvbG9yTWVudU9wZW5lZCkgcmV0dXJuXHJcblxyXG4gICAgICBjb25zdCBzdWJtZW51ID0gY2FudmFzLm1lbnUubWVudUVsLnF1ZXJ5U2VsZWN0b3IoJy5jYW52YXMtc3VibWVudScpXHJcbiAgICAgIGlmICghc3VibWVudSkgcmV0dXJuXHJcblxyXG4gICAgICBjb25zdCBjdXJyZW50Tm9kZUNvbG9yID0gY2FudmFzLmdldFNlbGVjdGlvbkRhdGEoKS5ub2Rlcy5tYXAobm9kZSA9PiBub2RlLmNvbG9yKS5sYXN0KClcclxuICAgICAgZm9yIChjb25zdCBjb2xvcklkIG9mIHRoaXMuZ2V0Q3VzdG9tQ29sb3JzKCkpIHtcclxuICAgICAgICBjb25zdCBjdXN0b21Db2xvck1lbnVJdGVtID0gdGhpcy5jcmVhdGVDb2xvck1lbnVJdGVtKGNhbnZhcywgY29sb3JJZClcclxuICAgICAgICBpZiAoY3VycmVudE5vZGVDb2xvciA9PT0gY29sb3JJZCkgY3VzdG9tQ29sb3JNZW51SXRlbS5jbGFzc0xpc3QuYWRkKCdpcy1hY3RpdmUnKVxyXG4gICAgICAgIFxyXG4gICAgICAgIHN1Ym1lbnUuaW5zZXJ0QmVmb3JlKGN1c3RvbUNvbG9yTWVudUl0ZW0sIHN1Ym1lbnUubGFzdENoaWxkKVxyXG4gICAgICB9XHJcbiAgICB9KVxyXG5cclxuICAgIHRoaXMub2JzZXJ2ZXIub2JzZXJ2ZShjYW52YXMubWVudS5tZW51RWwsIHsgY2hpbGRMaXN0OiB0cnVlIH0pXHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGNyZWF0ZUNvbG9yTWVudUl0ZW0oY2FudmFzOiBDYW52YXMsIGNvbG9ySWQ6IHN0cmluZykge1xyXG4gICAgY29uc3QgbWVudUl0ZW0gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKVxyXG4gICAgbWVudUl0ZW0uY2xhc3NMaXN0LmFkZCgnY2FudmFzLWNvbG9yLXBpY2tlci1pdGVtJylcclxuICAgIG1lbnVJdGVtLmNsYXNzTGlzdC5hZGQoYG1vZC1jYW52YXMtY29sb3ItJHtjb2xvcklkfWApXHJcblxyXG4gICAgbWVudUl0ZW0uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XHJcbiAgICAgIG1lbnVJdGVtLmNsYXNzTGlzdC5hZGQoJ2lzLWFjdGl2ZScpXHJcblxyXG4gICAgICBmb3IgKGNvbnN0IGl0ZW0gb2YgY2FudmFzLnNlbGVjdGlvbikge1xyXG4gICAgICAgIGl0ZW0uc2V0Q29sb3IoY29sb3JJZClcclxuICAgICAgfVxyXG5cclxuICAgICAgY2FudmFzLnJlcXVlc3RTYXZlKClcclxuICAgIH0pXHJcblxyXG4gICAgcmV0dXJuIG1lbnVJdGVtXHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGdldEN1c3RvbUNvbG9ycygpOiBzdHJpbmdbXSB7XHJcbiAgICBjb25zdCBjb2xvcnM6IHN0cmluZ1tdID0gW11cclxuXHJcbiAgICB3aGlsZSAodHJ1ZSkge1xyXG4gICAgICBjb25zdCBjb2xvcklkID0gKERFRkFVTFRfQ09MT1JTX0NPVU5UICsgY29sb3JzLmxlbmd0aCArIDEpLnRvU3RyaW5nKClcclxuICAgICAgaWYgKCFnZXRDb21wdXRlZFN0eWxlKGRvY3VtZW50LmJvZHkpLmdldFByb3BlcnR5VmFsdWUoYC0tY2FudmFzLWNvbG9yLSR7Y29sb3JJZH1gKSkgYnJlYWtcclxuXHJcbiAgICAgIGNvbG9ycy5wdXNoKGNvbG9ySWQpXHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIGNvbG9yc1xyXG4gIH1cclxufSIsICJpbXBvcnQgeyBzZXRJY29uIH0gZnJvbSBcIm9ic2lkaWFuXCJcclxuaW1wb3J0IHsgQkJveCwgQ2FudmFzLCBDYW52YXNEYXRhLCBDYW52YXNOb2RlIH0gZnJvbSBcInNyYy9AdHlwZXMvQ2FudmFzXCJcclxuaW1wb3J0IHsgQ2FudmFzRXZlbnQgfSBmcm9tIFwic3JjL2NvcmUvZXZlbnRzXCJcclxuaW1wb3J0IEFkdmFuY2VkQ2FudmFzUGx1Z2luIGZyb20gXCJzcmMvbWFpblwiXHJcbmltcG9ydCAqIGFzIEJCb3hIZWxwZXIgZnJvbSBcInNyYy91dGlscy9iYm94LWhlbHBlclwiXHJcblxyXG5jb25zdCBDT0xMQVBTRV9CVVRUT05fSUQgPSAnZ3JvdXAtY29sbGFwc2UtYnV0dG9uJ1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgQ29sbGFwc2libGVHcm91cHNDYW52YXNFeHRlbnNpb24ge1xyXG4gIHBsdWdpbjogQWR2YW5jZWRDYW52YXNQbHVnaW5cclxuXHJcbiAgY29uc3RydWN0b3IocGx1Z2luOiBBZHZhbmNlZENhbnZhc1BsdWdpbikge1xyXG4gICAgdGhpcy5wbHVnaW4gPSBwbHVnaW5cclxuXHJcbiAgICBpZiAoIXRoaXMucGx1Z2luLnNldHRpbmdzLmdldFNldHRpbmcoJ2NvbGxhcHNpYmxlR3JvdXBzRmVhdHVyZUVuYWJsZWQnKSkgcmV0dXJuXHJcblxyXG4gICAgdGhpcy5wbHVnaW4ucmVnaXN0ZXJFdmVudCh0aGlzLnBsdWdpbi5hcHAud29ya3NwYWNlLm9uKFxyXG4gICAgICBDYW52YXNFdmVudC5Ob2RlQ2hhbmdlZCxcclxuICAgICAgKGNhbnZhczogQ2FudmFzLCBub2RlOiBDYW52YXNOb2RlKSA9PiB0aGlzLm9uTm9kZUNoYW5nZWQoY2FudmFzLCBub2RlKVxyXG4gICAgKSlcclxuXHJcbiAgICB0aGlzLnBsdWdpbi5yZWdpc3RlckV2ZW50KHRoaXMucGx1Z2luLmFwcC53b3Jrc3BhY2Uub24oXHJcbiAgICAgIENhbnZhc0V2ZW50Lk5vZGVCQm94UmVxdWVzdGVkLFxyXG4gICAgICAoY2FudmFzOiBDYW52YXMsIG5vZGU6IENhbnZhc05vZGUsIGJib3g6IEJCb3gpID0+IHRoaXMub25Ob2RlQkJveFJlcXVlc3RlZChjYW52YXMsIG5vZGUsIGJib3gpXHJcbiAgICApKVxyXG5cclxuICAgIHRoaXMucGx1Z2luLnJlZ2lzdGVyRXZlbnQodGhpcy5wbHVnaW4uYXBwLndvcmtzcGFjZS5vbihcclxuICAgICAgQ2FudmFzRXZlbnQuRGF0YVJlcXVlc3RlZCxcclxuICAgICAgKF9jYW52YXM6IENhbnZhcywgZGF0YTogQ2FudmFzRGF0YSkgPT4gdGhpcy5leHBhbmRDb2xsYXBzZWROb2RlcyhkYXRhKVxyXG4gICAgKSlcclxuXHJcbiAgICB0aGlzLnBsdWdpbi5yZWdpc3RlckV2ZW50KHRoaXMucGx1Z2luLmFwcC53b3Jrc3BhY2Uub24oXHJcbiAgICAgIENhbnZhc0V2ZW50LkxvYWREYXRhLFxyXG4gICAgICAoX2NhbnZhczogQ2FudmFzLCBkYXRhOiBDYW52YXNEYXRhLCBfc2V0RGF0YTogKGRhdGE6IENhbnZhc0RhdGEpID0+IHZvaWQpID0+IHRoaXMuY29sbGFwc2VOb2RlcyhkYXRhKVxyXG4gICAgKSlcclxuICB9XHJcblxyXG4gIHByaXZhdGUgb25Ob2RlQ2hhbmdlZChjYW52YXM6IENhbnZhcywgZ3JvdXBOb2RlOiBDYW52YXNOb2RlKSB7XHJcbiAgICBjb25zdCBncm91cE5vZGVEYXRhID0gZ3JvdXBOb2RlLmdldERhdGEoKVxyXG4gICAgaWYgKGdyb3VwTm9kZURhdGEudHlwZSAhPT0gJ2dyb3VwJykgcmV0dXJuXHJcblxyXG4gICAgLy8gUmVtb3ZlIHRoZSBjb2xsYXBzZS9leHBhbmQgYnV0dG9uXHJcbiAgICBncm91cE5vZGUubm9kZUVsPy5xdWVyeVNlbGVjdG9yQWxsKGAjJHtDT0xMQVBTRV9CVVRUT05fSUR9YCkuZm9yRWFjaCgoZWwpID0+IGVsLnJlbW92ZSgpKVxyXG5cclxuICAgIC8vIEFkZCBjb2xsYXBzZS9leHBhbmQgYnV0dG9uIG5leHQgdG8gdGhlIGxhYmVsXHJcbiAgICBjb25zdCBjb2xsYXBzZUJ1dHRvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nKVxyXG4gICAgY29sbGFwc2VCdXR0b24uaWQgPSBDT0xMQVBTRV9CVVRUT05fSURcclxuICAgIHNldEljb24oY29sbGFwc2VCdXR0b24sIGdyb3VwTm9kZURhdGEuaXNDb2xsYXBzZWQgPyAncGx1cy1jaXJjbGUnIDogJ21pbnVzLWNpcmNsZScpXHJcblxyXG4gICAgY29sbGFwc2VCdXR0b24ub25jbGljayA9ICgpID0+IHsgdGhpcy5zZXRDb2xsYXBzZWQoY2FudmFzLCBncm91cE5vZGUsIGdyb3VwTm9kZS5nZXREYXRhKCkuaXNDb2xsYXBzZWQgPyB1bmRlZmluZWQgOiB0cnVlKSB9XHJcblxyXG4gICAgZ3JvdXBOb2RlLmxhYmVsRWw/Lmluc2VydEFkamFjZW50RWxlbWVudCgnYWZ0ZXJlbmQnLCBjb2xsYXBzZUJ1dHRvbilcclxuICB9XHJcblxyXG4gIHByaXZhdGUgc2V0Q29sbGFwc2VkKGNhbnZhczogQ2FudmFzLCBncm91cE5vZGU6IENhbnZhc05vZGUsIGNvbGxhcHNlZDogYm9vbGVhbiB8IHVuZGVmaW5lZCkge1xyXG4gICAgZ3JvdXBOb2RlLnNldERhdGEoeyAuLi5ncm91cE5vZGUuZ2V0RGF0YSgpLCBpc0NvbGxhcHNlZDogY29sbGFwc2VkIH0pXHJcbiAgICBjYW52YXMuc2V0RGF0YShjYW52YXMuZ2V0RGF0YSgpKVxyXG4gIH1cclxuXHJcbiAgb25Ob2RlQkJveFJlcXVlc3RlZChfY2FudmFzOiBDYW52YXMsIG5vZGU6IENhbnZhc05vZGUsIGJib3g6IEJCb3gpIHtcclxuICAgIGNvbnN0IG5vZGVEYXRhID0gbm9kZS5nZXREYXRhKClcclxuICAgIGlmIChub2RlRGF0YS50eXBlICE9PSAnZ3JvdXAnIHx8ICFub2RlRGF0YS5pc0NvbGxhcHNlZCkgcmV0dXJuXHJcblxyXG4gICAgLy8gU2V0IHdpZHRoIHRvIGxhYmVsIHdpZHRoXHJcbiAgICBiYm94Lm1heFggPSBiYm94Lm1pblggKyAobm9kZS5ub2RlRWw/LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLndpZHRoID8/IDApXHJcbiAgICBcclxuICAgIC8vIFNldCBoZWlnaHQgb2YgdG8gMCAoRG9uJ3QgZHJhZyBhbnkgbm9kZXMgd2l0aCBpdClcclxuICAgIGJib3gubWF4WSA9IGJib3gubWluWVxyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBleHBhbmRDb2xsYXBzZWROb2RlcyhkYXRhOiBDYW52YXNEYXRhKSB7XHJcbiAgICBkYXRhLm5vZGVzID0gZGF0YS5ub2Rlcy5mbGF0TWFwKChncm91cE5vZGVEYXRhKSA9PiB7XHJcbiAgICAgIGNvbnN0IGNvbGxhcHNlZERhdGEgPSBncm91cE5vZGVEYXRhLmNvbGxhcHNlZERhdGFcclxuICAgICAgaWYgKGNvbGxhcHNlZERhdGEgPT09IHVuZGVmaW5lZCkgcmV0dXJuIFtncm91cE5vZGVEYXRhXVxyXG5cclxuICAgICAgZ3JvdXBOb2RlRGF0YS5jb2xsYXBzZWREYXRhID0gdW5kZWZpbmVkXHJcblxyXG4gICAgICBkYXRhLmVkZ2VzLnB1c2goLi4uY29sbGFwc2VkRGF0YS5lZGdlcylcclxuICAgICAgcmV0dXJuIFtncm91cE5vZGVEYXRhLCAuLi5jb2xsYXBzZWREYXRhLm5vZGVzLm1hcCgobm9kZURhdGEpID0+IChcclxuICAgICAgICB7XHJcbiAgICAgICAgICAuLi5ub2RlRGF0YSxcclxuICAgICAgICAgIC8vIFJlc3RvcmUgdGhlIHJlbGF0aXZlIHBvc2l0aW9uIG9mIHRoZSBub2RlIHRvIHRoZSBncm91cFxyXG4gICAgICAgICAgeDogbm9kZURhdGEueCArIGdyb3VwTm9kZURhdGEueCxcclxuICAgICAgICAgIHk6IG5vZGVEYXRhLnkgKyBncm91cE5vZGVEYXRhLnlcclxuICAgICAgICB9XHJcbiAgICAgICkpXVxyXG4gICAgfSlcclxuICB9XHJcblxyXG4gIHByaXZhdGUgY29sbGFwc2VOb2RlcyhkYXRhOiBDYW52YXNEYXRhKSB7XHJcbiAgICBkYXRhLm5vZGVzLmZvckVhY2goKGdyb3VwTm9kZURhdGEpID0+IHtcclxuICAgICAgaWYgKCFncm91cE5vZGVEYXRhLmlzQ29sbGFwc2VkKSByZXR1cm5cclxuXHJcbiAgICAgIGNvbnN0IGdyb3VwTm9kZUJCb3ggPSBCQm94SGVscGVyLmJib3hGcm9tTm9kZURhdGEoZ3JvdXBOb2RlRGF0YSlcclxuICAgICAgY29uc3QgY29udGFpbmVkTm9kZXNEYXRhID0gZGF0YS5ub2Rlcy5maWx0ZXIoKG5vZGVEYXRhKSA9PlxyXG4gICAgICAgIG5vZGVEYXRhLmlkICE9PSBncm91cE5vZGVEYXRhLmlkICYmIEJCb3hIZWxwZXIuaW5zaWRlQkJveChCQm94SGVscGVyLmJib3hGcm9tTm9kZURhdGEobm9kZURhdGEpLCBncm91cE5vZGVCQm94LCBmYWxzZSlcclxuICAgICAgKVxyXG4gICAgICBjb25zdCBjb250YWluZWRFZGdlc0RhdGEgPSBkYXRhLmVkZ2VzLmZpbHRlcigoZWRnZURhdGEpID0+IHtcclxuICAgICAgICByZXR1cm4gY29udGFpbmVkTm9kZXNEYXRhLnNvbWUoKG5vZGVEYXRhKSA9PiBub2RlRGF0YS5pZCA9PT0gZWRnZURhdGEuZnJvbU5vZGUpIHx8IFxyXG4gICAgICAgICAgY29udGFpbmVkTm9kZXNEYXRhLnNvbWUoKG5vZGVEYXRhKSA9PiBub2RlRGF0YS5pZCA9PT0gZWRnZURhdGEudG9Ob2RlKVxyXG4gICAgICB9KVxyXG5cclxuICAgICAgZGF0YS5ub2RlcyA9IGRhdGEubm9kZXMuZmlsdGVyKChub2RlRGF0YSkgPT4gIWNvbnRhaW5lZE5vZGVzRGF0YS5pbmNsdWRlcyhub2RlRGF0YSkpXHJcbiAgICAgIGRhdGEuZWRnZXMgPSBkYXRhLmVkZ2VzLmZpbHRlcigoZWRnZURhdGEpID0+ICFjb250YWluZWRFZGdlc0RhdGEuaW5jbHVkZXMoZWRnZURhdGEpKVxyXG5cclxuICAgICAgZ3JvdXBOb2RlRGF0YS5jb2xsYXBzZWREYXRhID0ge1xyXG4gICAgICAgIG5vZGVzOiBjb250YWluZWROb2Rlc0RhdGEubWFwKChub2RlRGF0YSkgPT4gKFxyXG4gICAgICAgICAge1xyXG4gICAgICAgICAgICAuLi5ub2RlRGF0YSxcclxuICAgICAgICAgICAgLy8gU3RvcmUgdGhlIHJlbGF0aXZlIHBvc2l0aW9uIG9mIHRoZSBub2RlIHRvIHRoZSBncm91cFxyXG4gICAgICAgICAgICB4OiBub2RlRGF0YS54IC0gZ3JvdXBOb2RlRGF0YS54LFxyXG4gICAgICAgICAgICB5OiBub2RlRGF0YS55IC0gZ3JvdXBOb2RlRGF0YS55XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgKSksXHJcbiAgICAgICAgZWRnZXM6IGNvbnRhaW5lZEVkZ2VzRGF0YVxyXG4gICAgICB9XHJcbiAgICB9KVxyXG4gIH1cclxufSIsICJpbXBvcnQgeyBXb3Jrc3BhY2VXaW5kb3cgfSBmcm9tIFwib2JzaWRpYW5cIlxyXG5pbXBvcnQgQWR2YW5jZWRDYW52YXNQbHVnaW4gZnJvbSBcIi4vbWFpblwiXHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBXaW5kb3dzTWFuYWdlciB7XHJcbiAgcGx1Z2luOiBBZHZhbmNlZENhbnZhc1BsdWdpblxyXG4gIHdpbmRvd3M6IFdpbmRvd1tdID0gW3dpbmRvd11cclxuXHJcbiAgY29uc3RydWN0b3IocGx1Z2luOiBBZHZhbmNlZENhbnZhc1BsdWdpbikge1xyXG4gICAgdGhpcy5wbHVnaW4gPSBwbHVnaW5cclxuXHJcbiAgICB0aGlzLnBsdWdpbi5yZWdpc3RlckV2ZW50KHRoaXMucGx1Z2luLmFwcC53b3Jrc3BhY2Uub24oJ3dpbmRvdy1vcGVuJywgXHJcbiAgICAgIChfd2luOiBXb3Jrc3BhY2VXaW5kb3csIHdpbmRvdzogV2luZG93KSA9PiB0aGlzLndpbmRvd3MucHVzaCh3aW5kb3cpXHJcbiAgICApKVxyXG5cclxuICAgIHRoaXMucGx1Z2luLnJlZ2lzdGVyRXZlbnQodGhpcy5wbHVnaW4uYXBwLndvcmtzcGFjZS5vbignd2luZG93LWNsb3NlJywgXHJcbiAgICAgIChfd2luOiBXb3Jrc3BhY2VXaW5kb3csIHdpbmRvdzogV2luZG93KSA9PiB0aGlzLndpbmRvd3MgPSB0aGlzLndpbmRvd3MuZmlsdGVyKCh3KSA9PiB3ICE9PSB3aW5kb3cpXHJcbiAgICApKVxyXG4gIH1cclxufSIsICJpbXBvcnQgeyBDYW52YXMgfSBmcm9tIFwic3JjL0B0eXBlcy9DYW52YXNcIlxyXG5pbXBvcnQgeyBDYW52YXNFdmVudCB9IGZyb20gXCJzcmMvY29yZS9ldmVudHNcIlxyXG5pbXBvcnQgQWR2YW5jZWRDYW52YXNQbHVnaW4gZnJvbSBcInNyYy9tYWluXCJcclxuaW1wb3J0IFNldHRpbmdzTWFuYWdlciwgeyBBZHZhbmNlZENhbnZhc1BsdWdpblNldHRpbmdzIH0gZnJvbSBcInNyYy9zZXR0aW5nc1wiXHJcblxyXG5jb25zdCBFWFBPU0VEX1NFVFRJTkdTOiAoa2V5b2YgQWR2YW5jZWRDYW52YXNQbHVnaW5TZXR0aW5ncylbXSA9IFtcclxuICAnY29sbGFwc2libGVHcm91cHNGZWF0dXJlRW5hYmxlZCcsXHJcbiAgJ2NvbGxhcHNlZEdyb3VwUHJldmlld09uRHJhZydcclxuXVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgQ2FudmFzV3JhcHBlckRhdGFUYWdnZXJDYW52YXNFeHRlbnNpb24ge1xyXG4gIHBsdWdpbjogQWR2YW5jZWRDYW52YXNQbHVnaW5cclxuXHJcbiAgY29uc3RydWN0b3IocGx1Z2luOiBBZHZhbmNlZENhbnZhc1BsdWdpbikge1xyXG4gICAgdGhpcy5wbHVnaW4gPSBwbHVnaW5cclxuXHJcbiAgICB0aGlzLnBsdWdpbi5yZWdpc3RlckV2ZW50KHRoaXMucGx1Z2luLmFwcC53b3Jrc3BhY2Uub24oXHJcbiAgICAgIFNldHRpbmdzTWFuYWdlci5TRVRUSU5HU19DSEFOR0VEX0VWRU5ULFxyXG4gICAgICAoKSA9PiB0aGlzLnVwZGF0ZUV4cG9zZWRTZXR0aW5ncyh0aGlzLnBsdWdpbi5nZXRDdXJyZW50Q2FudmFzKCkpXHJcbiAgICApKVxyXG5cclxuICAgIHRoaXMucGx1Z2luLnJlZ2lzdGVyRXZlbnQodGhpcy5wbHVnaW4uYXBwLndvcmtzcGFjZS5vbihcclxuICAgICAgQ2FudmFzRXZlbnQuQ2FudmFzQ2hhbmdlZCxcclxuICAgICAgKGNhbnZhczogQ2FudmFzKSA9PiB0aGlzLnVwZGF0ZUV4cG9zZWRTZXR0aW5ncyhjYW52YXMpXHJcbiAgICApKVxyXG5cclxuICAgIHRoaXMucGx1Z2luLnJlZ2lzdGVyRXZlbnQodGhpcy5wbHVnaW4uYXBwLndvcmtzcGFjZS5vbihcclxuICAgICAgQ2FudmFzRXZlbnQuRHJhZ2dpbmdTdGF0ZUNoYW5nZWQsXHJcbiAgICAgIChjYW52YXM6IENhbnZhcywgZHJhZ2dpbmc6IGJvb2xlYW4pID0+IHtcclxuICAgICAgICBpZiAoZHJhZ2dpbmcpIGNhbnZhcy53cmFwcGVyRWwuZGF0YXNldC5pc0RyYWdnaW5nID0gJ3RydWUnXHJcbiAgICAgICAgZWxzZSBkZWxldGUgY2FudmFzLndyYXBwZXJFbC5kYXRhc2V0LmlzRHJhZ2dpbmdcclxuICAgICAgfVxyXG4gICAgKSlcclxuICB9XHJcblxyXG4gIHByaXZhdGUgdXBkYXRlRXhwb3NlZFNldHRpbmdzKGNhbnZhczogQ2FudmFzIHwgbnVsbCkge1xyXG4gICAgaWYgKCFjYW52YXMpIHJldHVyblxyXG5cclxuICAgIGZvciAoY29uc3Qgc2V0dGluZyBvZiBFWFBPU0VEX1NFVFRJTkdTKSB7XHJcbiAgICAgIGNhbnZhcy53cmFwcGVyRWwuZGF0YXNldFtzZXR0aW5nXSA9IHRoaXMucGx1Z2luLnNldHRpbmdzLmdldFNldHRpbmcoc2V0dGluZykudG9TdHJpbmcoKVxyXG4gICAgfVxyXG4gIH1cclxufSIsICJpbXBvcnQgQXBwLCB7IE1vZGFsLCBTZXR0aW5nIH0gZnJvbSBcIm9ic2lkaWFuXCJcclxuaW1wb3J0IHsgQ2FudmFzIH0gZnJvbSBcInNyYy9AdHlwZXMvQ2FudmFzXCJcclxuaW1wb3J0IHsgQ2FudmFzRXZlbnQgfSBmcm9tIFwic3JjL2NvcmUvZXZlbnRzXCJcclxuaW1wb3J0IEFkdmFuY2VkQ2FudmFzUGx1Z2luIGZyb20gXCJzcmMvbWFpblwiXHJcbmltcG9ydCAqIGFzIENhbnZhc0hlbHBlciBmcm9tIFwic3JjL3V0aWxzL2NhbnZhcy1oZWxwZXJcIlxyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUHJvcGVydGllc0NhbnZhc0V4dGVuc2lvbiB7XHJcbiAgcGx1Z2luOiBBZHZhbmNlZENhbnZhc1BsdWdpblxyXG5cclxuICBjb25zdHJ1Y3RvcihwbHVnaW46IEFkdmFuY2VkQ2FudmFzUGx1Z2luKSB7XHJcbiAgICB0aGlzLnBsdWdpbiA9IHBsdWdpblxyXG5cclxuICAgIHBsdWdpbi5yZWdpc3RlckV2ZW50KHBsdWdpbi5hcHAud29ya3NwYWNlLm9uKFxyXG4gICAgICBDYW52YXNFdmVudC5DYW52YXNDaGFuZ2VkLFxyXG4gICAgICAoY2FudmFzOiBDYW52YXMpID0+IHRoaXMub25DYW52YXNDaGFuZ2VkKGNhbnZhcylcclxuICAgICkpXHJcbiAgfVxyXG5cclxuICBwcml2YXRlIG9uQ2FudmFzQ2hhbmdlZChjYW52YXM6IENhbnZhcykge1xyXG4gICAgdGhpcy51cGRhdGVDc3NDbGFzc2VzKGNhbnZhcylcclxuXHJcbiAgICBjb25zdCBzZXR0aW5nc0NvbnRhaW5lciA9IGNhbnZhcy5xdWlja1NldHRpbmdzQnV0dG9uPy5wYXJlbnRFbGVtZW50XHJcbiAgICBpZiAoIXNldHRpbmdzQ29udGFpbmVyKSByZXR1cm5cclxuXHJcbiAgICBDYW52YXNIZWxwZXIuYWRkUXVpY2tTZXR0aW5nc0J1dHRvbihcclxuICAgICAgc2V0dGluZ3NDb250YWluZXIsXHJcbiAgICAgIENhbnZhc0hlbHBlci5jcmVhdGVRdWlja1NldHRpbmdzQnV0dG9uKHtcclxuICAgICAgICBpZDogJ3Byb3BlcnRpZXMnLFxyXG4gICAgICAgIGxhYmVsOiAnUHJvcGVydGllcycsXHJcbiAgICAgICAgaWNvbjogJ3NldHRpbmdzLTInLFxyXG4gICAgICAgIGNhbGxiYWNrOiAoKSA9PiB0aGlzLm9wZW5Qcm9wZXJ0aWVzRGlhbG9nKGNhbnZhcylcclxuICAgICAgfSlcclxuICAgIClcclxuICB9XHJcblxyXG4gIHByaXZhdGUgcHJldmlvdXNDc3NjbGFzc2VzOiBzdHJpbmdbXSA9IFtdXHJcbiAgcHJpdmF0ZSB1cGRhdGVDc3NDbGFzc2VzKGNhbnZhczogQ2FudmFzKSB7XHJcbiAgICB0aGlzLnByZXZpb3VzQ3NzY2xhc3Nlcy5mb3JFYWNoKChjc3NjbGFzcykgPT4ge1xyXG4gICAgICBjYW52YXMud3JhcHBlckVsLmNsYXNzTGlzdC5yZW1vdmUoY3NzY2xhc3MpXHJcbiAgICB9KVxyXG5cclxuICAgIHRoaXMucHJldmlvdXNDc3NjbGFzc2VzID0gY2FudmFzLm1ldGFkYXRhLnByb3BlcnRpZXM/LmNzc2NsYXNzZXMgfHwgW11cclxuICAgIHRoaXMucHJldmlvdXNDc3NjbGFzc2VzLmZvckVhY2goKGNzc2NsYXNzKSA9PiB7XHJcbiAgICAgIGNhbnZhcy53cmFwcGVyRWwuY2xhc3NMaXN0LmFkZChjc3NjbGFzcylcclxuICAgIH0pXHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGFzeW5jIG9wZW5Qcm9wZXJ0aWVzRGlhbG9nKGNhbnZhczogQ2FudmFzKSB7XHJcbiAgICBhd2FpdCBuZXcgUHJvcGVydGllc01vZGFsKHRoaXMucGx1Z2luLmFwcCwgY2FudmFzKS5hd2FpdERpYWxvZygpXHJcbiAgICB0aGlzLnVwZGF0ZUNzc0NsYXNzZXMoY2FudmFzKVxyXG4gIH1cclxufVxyXG5cclxuY2xhc3MgUHJvcGVydGllc01vZGFsIGV4dGVuZHMgTW9kYWwge1xyXG4gIGNhbnZhczogQ2FudmFzXHJcblxyXG4gIGNvbnN0cnVjdG9yKGFwcDogQXBwLCBjYW52YXM6IENhbnZhcykge1xyXG4gICAgc3VwZXIoYXBwKVxyXG4gICAgdGhpcy5jYW52YXMgPSBjYW52YXNcclxuICB9XHJcblxyXG4gIG9uT3BlbigpIHtcclxuICAgIG5ldyBTZXR0aW5nKHRoaXMuY29udGVudEVsKVxyXG4gICAgLnNldEhlYWRpbmcoKVxyXG4gICAgLnNldE5hbWUoXCJQcm9wZXJ0aWVzXCIpXHJcblxyXG4gICAgbmV3IFNldHRpbmcodGhpcy5jb250ZW50RWwpXHJcbiAgICAgIC5zZXROYW1lKFwiY3NzY2xhc3Nlc1wiKVxyXG4gICAgICAuc2V0VG9vbHRpcChcIkFkZCBjbGFzc2VzIHRvIHRoZSBjYW52YXMgd3JhcHBlciBlbGVtZW50LiBTZXBhcmF0ZSBtdWx0aXBsZSBjbGFzc2VzIHdpdGggc3BhY2VzLlwiKVxyXG4gICAgICAuYWRkVGV4dCgodGV4dCkgPT5cclxuICAgICAgICB0ZXh0XHJcbiAgICAgICAgICAuc2V0VmFsdWUodGhpcy5jYW52YXMubWV0YWRhdGEucHJvcGVydGllcz8uY3NzY2xhc3Nlcz8uam9pbignICcpKVxyXG4gICAgICAgICAgLm9uQ2hhbmdlKCh2YWx1ZSkgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLmNhbnZhcy5tZXRhZGF0YS5wcm9wZXJ0aWVzID0gdGhpcy5jYW52YXMubWV0YWRhdGEucHJvcGVydGllcyB8fCB7fVxyXG4gICAgICAgICAgICB0aGlzLmNhbnZhcy5tZXRhZGF0YS5wcm9wZXJ0aWVzLmNzc2NsYXNzZXMgPSB2YWx1ZS5zcGxpdCgnICcpXHJcbiAgICAgICAgICB9KVxyXG4gICAgICApLnNldHRpbmdFbC5jbGFzc0xpc3QuYWRkKCdwcm9wZXJ0aWVzLWZpZWxkJylcclxuICB9XHJcblxyXG4gIG9uQ2xvc2UoKSB7fVxyXG5cclxuICBhd2FpdERpYWxvZygpOiBQcm9taXNlPHZvaWQ+IHtcclxuICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSkgPT4ge1xyXG4gICAgICB0aGlzLm9uQ2xvc2UgPSAoKSA9PiB7XHJcbiAgICAgICAgdGhpcy5jb250ZW50RWwuZW1wdHkoKVxyXG4gICAgICAgIHJlc29sdmUoKVxyXG4gICAgICB9XHJcblxyXG4gICAgICB0aGlzLm9wZW4oKVxyXG4gICAgfSlcclxuICB9XHJcbn0iXSwKICAibWFwcGluZ3MiOiAiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUEsSUFBQUEsbUJBQWlDOzs7QUNBakMsc0JBQWtEO0FBR2xELElBQU0sNkJBQTZCO0FBQUEsRUFDakMsUUFBUTtBQUFBLEVBQ1IsUUFBUTtBQUNWO0FBOENPLElBQU0sbUJBQTBEO0FBQUEsRUFDckUsdUJBQXVCLE9BQU8sS0FBSywwQkFBMEIsRUFBRSxNQUFNO0FBQUEsRUFDckUsc0JBQXNCO0FBQUEsRUFDdEIsdUJBQXVCO0FBQUEsRUFDdkIsc0JBQXNCO0FBQUEsRUFDdEIsdUJBQXVCO0FBQUEsRUFFdkIsc0JBQXNCO0FBQUEsRUFFdEIsNEJBQTRCO0FBQUEsRUFDNUIs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QWE7QUFDakMsU0FBSyxTQUFTLGVBQWU7QUFFN0IsU0FBSyxpQkFBaUIsSUFBSSxlQUFlLElBQUk7QUFFN0MsU0FBSyxxQkFBcUIsSUFBSSxjQUFjLElBQUk7QUFDaEQsU0FBSyxtQkFBbUIsa0JBQWtCLElBQUksQ0FBQyxjQUFjLElBQUksVUFBVSxJQUFJLENBQUM7QUFBQSxFQUNuRjtBQUFBLEVBRUMsV0FBVztBQUFBLEVBQUM7QUFBQSxFQUVaLHVCQUF3QztBQUN0QyxVQUFNLGFBQWEsS0FBSyxJQUFJLFVBQVUsb0JBQW9CLHlCQUFRO0FBQ2xFLFNBQUkseUNBQVksbUJBQWtCO0FBQVUsYUFBTztBQUNuRCxXQUFPO0FBQUEsRUFDVDtBQUFBLEVBRUEsbUJBQWdDO0FBMUVsQztBQTJFSSxhQUFPLFVBQUsscUJBQXFCLE1BQTFCLG1CQUE2QixXQUFVO0FBQUEsRUFDaEQ7QUFBQTtBQUFBLEVBR0Esa0JBQWtCO0FBQ2hCLFFBQUksS0FBSztBQUFhO0FBQ3RCLFNBQUssY0FBYyxJQUFJLFlBQVksSUFBSTtBQUFBLEVBQ3pDO0FBQ0Y7IiwKICAibmFtZXMiOiBbImltcG9ydF9vYnNpZGlhbiIsICJpbXBvcnRfb2JzaWRpYW4iLCAiX2EiLCAidXBkYXRlIiwgImRhdGEiLCAiY2FudmFzVmlldyIsICJjYW52YXMiLCAiaW1wb3J0X29ic2lkaWFuIiwgImNhbnZhcyIsICJpbXBvcnRfb2JzaWRpYW4iLCAiaW1wb3J0X29ic2lkaWFuIiwgIm5vZGUiLCAiX2EiLCAiX2IiLCAiaW1wb3J0X29ic2lkaWFuIiwgIkRJUkVDVElPTlMiLCAibm9kZSIsICJpbXBvcnRfb2JzaWRpYW4iLCAid2luZG93IiwgImltcG9ydF9vYnNpZGlhbiJdCn0K
